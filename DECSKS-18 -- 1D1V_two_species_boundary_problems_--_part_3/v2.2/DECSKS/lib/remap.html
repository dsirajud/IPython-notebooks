<!DOCTYPE html>
<!-- Generated by Cython 0.22.1 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: remap.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.22.1</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="remap.c">remap.c</a></p>
<div class="cython"><pre class='cython line score-19' onclick='toggleDiv(this)'>+001: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-19'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;002: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython line score-0'>&#xA0;003: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class='cython line score-0'>&#xA0;004: </pre>
<pre class='cython line score-11' onclick='toggleDiv(this)'>+005: <span class="n">DTYPE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span></pre>
<pre class='cython code score-11'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+006: <span class="n">DTYPEINT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span></pre>
<pre class='cython code score-11'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPEINT, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;007: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+008: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">float64_t</span> <span class="n">DTYPE_t</span></pre>
<pre class='cython code score-0'>typedef __pyx_t_5numpy_float64_t __pyx_t_6DECSKS_3lib_5remap_DTYPE_t;
</pre><pre class='cython line score-0'>&#xA0;009: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">int64_t</span> <span class="n">DTYPEINT_t</span></pre>
<pre class='cython line score-0'>&#xA0;010: </pre>
<pre class='cython line score-0'>&#xA0;011: </pre>
<pre class='cython line score-113' onclick='toggleDiv(this)'>+012: <span class="k">def</span> <span class="nf">assignment</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f_old</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">map1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">map2</span><span class="p">,</span> <span class="nb">int</span> <span class="n">dim1</span><span class="p">,</span> <span class="nb">int</span> <span class="n">dim2</span><span class="p">):</span></pre>
<pre class='cython code score-113'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_1assignment(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6DECSKS_3lib_5remap_1assignment = {"assignment", (PyCFunction)__pyx_pw_6DECSKS_3lib_5remap_1assignment, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_1assignment(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_f_old = 0;
  PyArrayObject *__pyx_v_map1 = 0;
  PyArrayObject *__pyx_v_map2 = 0;
  int __pyx_v_dim1;
  int __pyx_v_dim2;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assignment (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_f_old,&amp;__pyx_n_s_map1,&amp;__pyx_n_s_map2,&amp;__pyx_n_s_dim1,&amp;__pyx_n_s_dim2,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_old)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_map1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assignment", 1, 5, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_map2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assignment", 1, 5, 5, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_dim1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assignment", 1, 5, 5, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_dim2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assignment", 1, 5, 5, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "assignment") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_f_old = ((PyArrayObject *)values[0]);
    __pyx_v_map1 = ((PyArrayObject *)values[1]);
    __pyx_v_map2 = ((PyArrayObject *)values[2]);
    __pyx_v_dim1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_dim1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_dim2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_dim2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assignment", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.assignment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_f_old), __pyx_ptype_5numpy_ndarray, 1, "f_old", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_map1), __pyx_ptype_5numpy_ndarray, 1, "map1", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_map2), __pyx_ptype_5numpy_ndarray, 1, "map2", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_5remap_assignment(__pyx_self, __pyx_v_f_old, __pyx_v_map1, __pyx_v_map2, __pyx_v_dim1, __pyx_v_dim2);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_5remap_assignment(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_f_old, PyArrayObject *__pyx_v_map1, PyArrayObject *__pyx_v_map2, int __pyx_v_dim1, int __pyx_v_dim2) {
  PyArrayObject *__pyx_v_f_new = 0;
  int __pyx_v_i;
  int __pyx_v_j;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f_new;
  __Pyx_Buffer __pyx_pybuffer_f_new;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f_old;
  __Pyx_Buffer __pyx_pybuffer_f_old;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_map1;
  __Pyx_Buffer __pyx_pybuffer_map1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_map2;
  __Pyx_Buffer __pyx_pybuffer_map2;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assignment", 0);
  __pyx_pybuffer_f_new.pybuffer.buf = NULL;
  __pyx_pybuffer_f_new.refcount = 0;
  __pyx_pybuffernd_f_new.data = NULL;
  __pyx_pybuffernd_f_new.rcbuffer = &amp;__pyx_pybuffer_f_new;
  __pyx_pybuffer_f_old.pybuffer.buf = NULL;
  __pyx_pybuffer_f_old.refcount = 0;
  __pyx_pybuffernd_f_old.data = NULL;
  __pyx_pybuffernd_f_old.rcbuffer = &amp;__pyx_pybuffer_f_old;
  __pyx_pybuffer_map1.pybuffer.buf = NULL;
  __pyx_pybuffer_map1.refcount = 0;
  __pyx_pybuffernd_map1.data = NULL;
  __pyx_pybuffernd_map1.rcbuffer = &amp;__pyx_pybuffer_map1;
  __pyx_pybuffer_map2.pybuffer.buf = NULL;
  __pyx_pybuffer_map2.refcount = 0;
  __pyx_pybuffernd_map2.data = NULL;
  __pyx_pybuffernd_map2.rcbuffer = &amp;__pyx_pybuffer_map2;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_f_old, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_f_old.diminfo[0].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f_old.diminfo[0].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f_old.diminfo[1].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f_old.diminfo[1].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_map1, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_map1.diminfo[0].strides = __pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_map1.diminfo[0].shape = __pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_map1.diminfo[1].strides = __pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_map1.diminfo[1].shape = __pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_map2, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_map2.diminfo[0].strides = __pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_map2.diminfo[0].shape = __pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_map2.diminfo[1].strides = __pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_map2.diminfo[1].shape = __pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.assignment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_f_new);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_f_old, __pyx_n_s_map1, __pyx_n_s_map2, __pyx_n_s_dim1, __pyx_n_s_dim2, __pyx_n_s_f_new, __pyx_n_s_i, __pyx_n_s_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_5remap_1assignment, NULL, __pyx_n_s_DECSKS_lib_remap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_assignment, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__8 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__7, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_assignment, 12, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;013: </pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+014:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-45'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_5, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_f_new = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_f_new.diminfo[0].strides = __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f_new.diminfo[0].shape = __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f_new.diminfo[1].strides = __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f_new.diminfo[1].shape = __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_5 = 0;
  __pyx_v_f_new = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;015:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class='cython line score-0'>&#xA0;016:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">j</span></pre>
<pre class='cython line score-0'>&#xA0;017: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+018:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_dim1;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+019:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_dim2;
    for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_j = __pyx_t_9;
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+020:             <span class="n">f_new</span><span class="p">[</span><span class="n">map1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span> <span class="n">map2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="n">f_new</span><span class="p">[</span><span class="n">map1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span> <span class="n">map2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]]</span> <span class="o">+</span>  <span class="n">f_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14'>      __pyx_t_10 = __pyx_v_i;
      __pyx_t_11 = __pyx_v_j;
      __pyx_t_12 = -1;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_pybuffernd_map1.diminfo[0].shape;
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_12 = 0;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_pybuffernd_map1.diminfo[0].shape)) __pyx_t_12 = 0;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_pybuffernd_map1.diminfo[1].shape;
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_12 = 1;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_pybuffernd_map1.diminfo[1].shape)) __pyx_t_12 = 1;
      if (unlikely(__pyx_t_12 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_pybuffernd_map2.diminfo[0].shape;
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_pybuffernd_map2.diminfo[0].shape)) __pyx_t_14 = 0;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_pybuffernd_map2.diminfo[1].shape;
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_pybuffernd_map2.diminfo[1].shape)) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_15 = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPEINT_t *, __pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_map1.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_map1.diminfo[1].strides));
      __pyx_t_16 = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPEINT_t *, __pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_map2.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_map2.diminfo[1].strides));
      __pyx_t_14 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_pybuffernd_f_new.diminfo[0].shape;
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_pybuffernd_f_new.diminfo[0].shape)) __pyx_t_14 = 0;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_pybuffernd_f_new.diminfo[1].shape;
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_pybuffernd_f_new.diminfo[1].shape)) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_14 = __pyx_v_i;
      __pyx_t_17 = __pyx_v_j;
      __pyx_t_18 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_pybuffernd_f_old.diminfo[0].shape;
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_18 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_pybuffernd_f_old.diminfo[0].shape)) __pyx_t_18 = 0;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_pybuffernd_f_old.diminfo[1].shape;
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_18 = 1;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_f_old.diminfo[1].shape)) __pyx_t_18 = 1;
      if (unlikely(__pyx_t_18 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_18);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_18 = __pyx_v_i;
      __pyx_t_19 = __pyx_v_j;
      __pyx_t_20 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_pybuffernd_map1.diminfo[0].shape;
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_20 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_map1.diminfo[0].shape)) __pyx_t_20 = 0;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_pybuffernd_map1.diminfo[1].shape;
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_20 = 1;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_map1.diminfo[1].shape)) __pyx_t_20 = 1;
      if (unlikely(__pyx_t_20 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_20 = __pyx_v_i;
      __pyx_t_21 = __pyx_v_j;
      __pyx_t_22 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_pybuffernd_map2.diminfo[0].shape;
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_22 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_pybuffernd_map2.diminfo[0].shape)) __pyx_t_22 = 0;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_pybuffernd_map2.diminfo[1].shape;
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_22 = 1;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_pybuffernd_map2.diminfo[1].shape)) __pyx_t_22 = 1;
      if (unlikely(__pyx_t_22 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_22);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_23 = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPEINT_t *, __pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_map1.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_map1.diminfo[1].strides));
      __pyx_t_24 = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPEINT_t *, __pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_map2.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_map2.diminfo[1].strides));
      __pyx_t_22 = -1;
      if (__pyx_t_23 &lt; 0) {
        __pyx_t_23 += __pyx_pybuffernd_f_new.diminfo[0].shape;
        if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_22 = 0;
      } else if (unlikely(__pyx_t_23 &gt;= __pyx_pybuffernd_f_new.diminfo[0].shape)) __pyx_t_22 = 0;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_pybuffernd_f_new.diminfo[1].shape;
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_22 = 1;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_pybuffernd_f_new.diminfo[1].shape)) __pyx_t_22 = 1;
      if (unlikely(__pyx_t_22 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_22);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_f_new.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_f_new.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_f_new.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_f_new.diminfo[1].strides)) + (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_f_old.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_f_old.diminfo[1].strides)));
    }
  }
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+021:     <span class="k">return</span> <span class="n">f_new</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_f_new));
  __pyx_r = ((PyObject *)__pyx_v_f_new);
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;022: </pre>
<pre class='cython line score-42' onclick='toggleDiv(this)'>+023: <span class="k">def</span> <span class="nf">sift_by_column</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf</span><span class="p">):</span></pre>
<pre class='cython code score-42'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_3sift_by_column(PyObject *__pyx_self, PyObject *__pyx_v_Uf); /*proto*/
static char __pyx_doc_6DECSKS_3lib_5remap_2sift_by_column[] = "\n    sift BY COLUMN means this routine reduces the number of sign checks by only\n    checking the first row entry of each column and assumes ALL rows have the\n    same sign of affiliated CFL number. This is true for most boundary conditions\n    and will only not be true for a symmetry boundary where it is possible that\n    we replace certain entries [i,j] in the density/flux objects with their\n    oppositely directed entering partners which breaks the constancy of affiliated\n    CFL number (advection direction) for every row in a given column.\n\n    NOTE: for modest mesh sizes, e.g. 240 x 400, the cost of using\n    this sift method vs. the general method below is not seen to actually be very\n    different in processor time per time step.\n\n    inputs:\n    f -- (ndarray, ndim=2, dtype = float64) density like object\n    vz -- (ndarray, ndim=2, dtype = float64) generalized velocity grid\n\n    output:\n    f_nonneg, f_neg -- (ndarrays, ndim=2, dtype = float64) containers holding\n                    density like entires from f according to\n\n                    pos -- for each f[i,j] such that its vz[i,j] &gt;= 0\n                    neg -- for each f[i,j] such that its vz[i,j] &lt; 0\n\n    we acknowledge we could check the object Uf sign itself, the only case\n    where this will not agree is when either U (CFL.frac high order correction) or f\n    are very small (i.e. np.sign(CFL.number[i,j] != np.sign(Uf[i,j]), which is inconsequential\n    given that the product Uf ~ 0 will contribute negligible amount to the remapped gridpoints,\n    hence it does not matter if, for example that np.sign(CFL.number[i,j]) = -1 but\n    np.sign(Uf[i,j]) = 0, since no matter the remap rule, the contribution from Uf must be\n    negligibly small. We happen to check the CFL number here just out of arbitrary choice.\n\n    ";
static PyMethodDef __pyx_mdef_6DECSKS_3lib_5remap_3sift_by_column = {"sift_by_column", (PyCFunction)__pyx_pw_6DECSKS_3lib_5remap_3sift_by_column, METH_O, __pyx_doc_6DECSKS_3lib_5remap_2sift_by_column};
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_3sift_by_column(PyObject *__pyx_self, PyObject *__pyx_v_Uf) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift_by_column (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Uf), __pyx_ptype_5numpy_ndarray, 1, "Uf", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_5remap_2sift_by_column(__pyx_self, ((PyArrayObject *)__pyx_v_Uf));
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_5remap_2sift_by_column(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_Uf) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_dim1;
  int __pyx_v_dim2;
  PyArrayObject *__pyx_v_Uf_nonneg = 0;
  PyArrayObject *__pyx_v_Uf_neg = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf;
  __Pyx_Buffer __pyx_pybuffer_Uf;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_neg;
  __Pyx_Buffer __pyx_pybuffer_Uf_neg;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_nonneg;
  __Pyx_Buffer __pyx_pybuffer_Uf_nonneg;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift_by_column", 0);
  __pyx_pybuffer_Uf_nonneg.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_nonneg.refcount = 0;
  __pyx_pybuffernd_Uf_nonneg.data = NULL;
  __pyx_pybuffernd_Uf_nonneg.rcbuffer = &amp;__pyx_pybuffer_Uf_nonneg;
  __pyx_pybuffer_Uf_neg.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_neg.refcount = 0;
  __pyx_pybuffernd_Uf_neg.data = NULL;
  __pyx_pybuffernd_Uf_neg.rcbuffer = &amp;__pyx_pybuffer_Uf_neg;
  __pyx_pybuffer_Uf.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf.refcount = 0;
  __pyx_pybuffernd_Uf.data = NULL;
  __pyx_pybuffernd_Uf.rcbuffer = &amp;__pyx_pybuffer_Uf;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Uf, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Uf.diminfo[0].strides = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf.diminfo[0].shape = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf.diminfo[1].strides = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf.diminfo[1].shape = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.sift_by_column", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Uf_nonneg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Uf_neg);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_Uf, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_dim1, __pyx_n_s_dim2, __pyx_n_s_Uf_nonneg, __pyx_n_s_Uf_neg);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_5remap_3sift_by_column, NULL, __pyx_n_s_DECSKS_lib_remap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sift_by_column, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__10 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__9, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_sift_by_column, 23, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;024:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;025: <span class="sd">    sift BY COLUMN means this routine reduces the number of sign checks by only</span></pre>
<pre class='cython line score-0'>&#xA0;026: <span class="sd">    checking the first row entry of each column and assumes ALL rows have the</span></pre>
<pre class='cython line score-0'>&#xA0;027: <span class="sd">    same sign of affiliated CFL number. This is true for most boundary conditions</span></pre>
<pre class='cython line score-0'>&#xA0;028: <span class="sd">    and will only not be true for a symmetry boundary where it is possible that</span></pre>
<pre class='cython line score-0'>&#xA0;029: <span class="sd">    we replace certain entries [i,j] in the density/flux objects with their</span></pre>
<pre class='cython line score-0'>&#xA0;030: <span class="sd">    oppositely directed entering partners which breaks the constancy of affiliated</span></pre>
<pre class='cython line score-0'>&#xA0;031: <span class="sd">    CFL number (advection direction) for every row in a given column.</span></pre>
<pre class='cython line score-0'>&#xA0;032: </pre>
<pre class='cython line score-0'>&#xA0;033: <span class="sd">    NOTE: for modest mesh sizes, e.g. 240 x 400, the cost of using</span></pre>
<pre class='cython line score-0'>&#xA0;034: <span class="sd">    this sift method vs. the general method below is not seen to actually be very</span></pre>
<pre class='cython line score-0'>&#xA0;035: <span class="sd">    different in processor time per time step.</span></pre>
<pre class='cython line score-0'>&#xA0;036: </pre>
<pre class='cython line score-0'>&#xA0;037: <span class="sd">    inputs:</span></pre>
<pre class='cython line score-0'>&#xA0;038: <span class="sd">    f -- (ndarray, ndim=2, dtype = float64) density like object</span></pre>
<pre class='cython line score-0'>&#xA0;039: <span class="sd">    vz -- (ndarray, ndim=2, dtype = float64) generalized velocity grid</span></pre>
<pre class='cython line score-0'>&#xA0;040: </pre>
<pre class='cython line score-0'>&#xA0;041: <span class="sd">    output:</span></pre>
<pre class='cython line score-0'>&#xA0;042: <span class="sd">    f_nonneg, f_neg -- (ndarrays, ndim=2, dtype = float64) containers holding</span></pre>
<pre class='cython line score-0'>&#xA0;043: <span class="sd">                    density like entires from f according to</span></pre>
<pre class='cython line score-0'>&#xA0;044: </pre>
<pre class='cython line score-0'>&#xA0;045: <span class="sd">                    pos -- for each f[i,j] such that its vz[i,j] &gt;= 0</span></pre>
<pre class='cython line score-0'>&#xA0;046: <span class="sd">                    neg -- for each f[i,j] such that its vz[i,j] &lt; 0</span></pre>
<pre class='cython line score-0'>&#xA0;047: </pre>
<pre class='cython line score-0'>&#xA0;048: <span class="sd">    we acknowledge we could check the object Uf sign itself, the only case</span></pre>
<pre class='cython line score-0'>&#xA0;049: <span class="sd">    where this will not agree is when either U (CFL.frac high order correction) or f</span></pre>
<pre class='cython line score-0'>&#xA0;050: <span class="sd">    are very small (i.e. np.sign(CFL.number[i,j] != np.sign(Uf[i,j]), which is inconsequential</span></pre>
<pre class='cython line score-0'>&#xA0;051: <span class="sd">    given that the product Uf ~ 0 will contribute negligible amount to the remapped gridpoints,</span></pre>
<pre class='cython line score-0'>&#xA0;052: <span class="sd">    hence it does not matter if, for example that np.sign(CFL.number[i,j]) = -1 but</span></pre>
<pre class='cython line score-0'>&#xA0;053: <span class="sd">    np.sign(Uf[i,j]) = 0, since no matter the remap rule, the contribution from Uf must be</span></pre>
<pre class='cython line score-0'>&#xA0;054: <span class="sd">    negligibly small. We happen to check the CFL number here just out of arbitrary choice.</span></pre>
<pre class='cython line score-0'>&#xA0;055: </pre>
<pre class='cython line score-0'>&#xA0;056: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;057:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+058:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim1</span> <span class="o">=</span> <span class="n">Uf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim1 = (__pyx_v_Uf-&gt;dimensions[0]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+059:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim2</span> <span class="o">=</span> <span class="n">Uf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim2 = (__pyx_v_Uf-&gt;dimensions[1]);
</pre><pre class='cython line score-0'>&#xA0;060: </pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+061:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_nonneg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Uf_nonneg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Uf_nonneg.diminfo[0].strides = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_nonneg.diminfo[1].strides = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_Uf_nonneg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-45' onclick='toggleDiv(this)'>+062:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Uf_neg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Uf_neg.diminfo[0].strides = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_neg.diminfo[0].shape = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_neg.diminfo[1].strides = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_neg.diminfo[1].shape = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_Uf_neg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;063: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+064:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_8 = __pyx_v_dim2;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_j = __pyx_t_9;
</pre><pre class='cython line score-0'>&#xA0;065:         <span class="c"># we assume this is a case where it will always bge that CFL[0,j] = CFL[1,j] = ... = CFL[-1,j]</span></pre>
<pre class='cython line score-0'>&#xA0;066:         <span class="c"># only checking the sign of the first entry is needed for each column</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+067:         <span class="k">if</span> <span class="n">Uf</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-2'>    __pyx_t_10 = 0;
    __pyx_t_11 = __pyx_v_j;
    __pyx_t_12 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_pybuffernd_Uf.diminfo[0].shape;
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_12 = 0;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_pybuffernd_Uf.diminfo[1].shape;
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_12 = 1;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_13 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Uf.diminfo[1].strides)) &gt;= 0.0) != 0);
    if (__pyx_t_13) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+068:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = __pyx_v_dim1;
      for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_12; __pyx_t_14+=1) {
        __pyx_v_i = __pyx_t_14;
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+069:                 <span class="n">Uf_nonneg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_15 = __pyx_v_i;
        __pyx_t_16 = __pyx_v_j;
        __pyx_t_17 = -1;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_pybuffernd_Uf.diminfo[0].shape;
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_17 = 0;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_17 = 0;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_pybuffernd_Uf.diminfo[1].shape;
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_17 = 1;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_17 = 1;
        if (unlikely(__pyx_t_17 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_17 = __pyx_v_i;
        __pyx_t_18 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape;
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape)) __pyx_t_19 = 0;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape;
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape)) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Uf_nonneg.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Uf_nonneg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Uf.diminfo[1].strides));
      }
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;070:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+071:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = __pyx_v_dim1;
      for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_12; __pyx_t_14+=1) {
        __pyx_v_i = __pyx_t_14;
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+072:                 <span class="n">Uf_neg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_19 = __pyx_v_i;
        __pyx_t_20 = __pyx_v_j;
        __pyx_t_21 = -1;
        if (__pyx_t_19 &lt; 0) {
          __pyx_t_19 += __pyx_pybuffernd_Uf.diminfo[0].shape;
          if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_21 = 0;
        } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_21 = 0;
        if (__pyx_t_20 &lt; 0) {
          __pyx_t_20 += __pyx_pybuffernd_Uf.diminfo[1].shape;
          if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_21 = 1;
        } else if (unlikely(__pyx_t_20 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_21 = 1;
        if (unlikely(__pyx_t_21 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_23 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_pybuffernd_Uf_neg.diminfo[0].shape;
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_23 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_pybuffernd_Uf_neg.diminfo[0].shape)) __pyx_t_23 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_pybuffernd_Uf_neg.diminfo[1].shape;
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_23 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_pybuffernd_Uf_neg.diminfo[1].shape)) __pyx_t_23 = 1;
        if (unlikely(__pyx_t_23 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_Uf_neg.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_Uf_neg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_Uf.diminfo[1].strides));
      }
    }
    __pyx_L5:;
  }
</pre><pre class='cython line score-0'>&#xA0;073: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+074:     <span class="k">return</span> <span class="n">Uf_nonneg</span><span class="p">,</span> <span class="n">Uf_neg</span></pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_nonneg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_nonneg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_Uf_nonneg));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_neg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_neg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_Uf_neg));
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;075: </pre>
<pre class='cython line score-42' onclick='toggleDiv(this)'>+076: <span class="k">def</span> <span class="nf">sift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf</span><span class="p">):</span></pre>
<pre class='cython code score-42'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_5sift(PyObject *__pyx_self, PyObject *__pyx_v_Uf); /*proto*/
static char __pyx_doc_6DECSKS_3lib_5remap_4sift[] = "\n    We sift by checking the sign on every CFL number associated\n    with each [i,j] of the flux-like object Uf. This is the most\n    general method and allows sifting of Uf into its negative\n    and nonnegative advecting directions into separate containers\n    Uf_neg and Uf_nonneg even if the associated CFL number for a given\n    row in a given column is different than the rest, i.e. can\n    handle the setup created by a symmetric boundary condition.\n\n    we acknowledge we could check the object Uf sign itself, the only case\n    where this will not agree is when either U (CFL.frac high order correction) or f\n    are very small (i.e. np.sign(CFL.number[i,j] != np.sign(Uf[i,j]), which is inconsequential\n    given that the product Uf ~ 0 will contribute negligible amount to the remapped gridpoints,\n    hence it does not matter if, for example that np.sign(CFL.number[i,j]) = -1 but\n    np.sign(Uf[i,j]) = 0, since no matter the remap rule, the contribution from Uf must be\n    negligibly small. We happen to check the CFL number here just out of arbitrary choice.\n\n    The argument for the equivalency of checking the sign of Uf is as follows:\n\n    Recall that,\n\n        Uf = CFL.frac * f + (Higher order corrections)\n\n    since f is strictly nonnegative everywhere in phase space, the\n    flux Uf already factors in CFL.frac as the zeroeth order term,\n    and the numerical limiter on the high order corrections ensure that Uf\n    shares the same sign as the zeroeth order term, hence Uf has the same\n    sign as CFL.frac which itself is defined in such a way to have\n    the same direction of travel (sign) as CFL.numbers; however, we have\n    noted that when the fraction is significantly small the two signs\n    may technically not calculate the same sign (CFL.frac sign may be\n    calculated as 0 if sufficiently small, whereas CFL.numbers would\n    be +1 or -1. Note that this does not matter as Uf ~ 0 so whichever\n    remapping rule is used in the s""ubsequent remapping procedure, it\n    contributes negligibly to the remappings)\n\n    This routine differs from remap.sift_by_column in two ways:\n\n        (1) it checks the sign on the input paramter Uf, hence\n            checking the sign on CFL.frac is not needed as discussed\n            above.\n        (2) it checks the sign of every (i,j), not just the first row\n            entry in a column (i.e. does not assume every row of\n            a given column are described by the same direction of\n            advection [given by the sign of the CFL number or\n            equivalently the product Uf, as discussed above])\n\n    ";
static PyMethodDef __pyx_mdef_6DECSKS_3lib_5remap_5sift = {"sift", (PyCFunction)__pyx_pw_6DECSKS_3lib_5remap_5sift, METH_O, __pyx_doc_6DECSKS_3lib_5remap_4sift};
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_5sift(PyObject *__pyx_self, PyObject *__pyx_v_Uf) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Uf), __pyx_ptype_5numpy_ndarray, 1, "Uf", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_5remap_4sift(__pyx_self, ((PyArrayObject *)__pyx_v_Uf));
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_5remap_4sift(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_Uf) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_dim1;
  int __pyx_v_dim2;
  PyArrayObject *__pyx_v_Uf_nonneg = 0;
  PyArrayObject *__pyx_v_Uf_neg = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf;
  __Pyx_Buffer __pyx_pybuffer_Uf;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_neg;
  __Pyx_Buffer __pyx_pybuffer_Uf_neg;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_nonneg;
  __Pyx_Buffer __pyx_pybuffer_Uf_nonneg;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift", 0);
  __pyx_pybuffer_Uf_nonneg.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_nonneg.refcount = 0;
  __pyx_pybuffernd_Uf_nonneg.data = NULL;
  __pyx_pybuffernd_Uf_nonneg.rcbuffer = &amp;__pyx_pybuffer_Uf_nonneg;
  __pyx_pybuffer_Uf_neg.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_neg.refcount = 0;
  __pyx_pybuffernd_Uf_neg.data = NULL;
  __pyx_pybuffernd_Uf_neg.rcbuffer = &amp;__pyx_pybuffer_Uf_neg;
  __pyx_pybuffer_Uf.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf.refcount = 0;
  __pyx_pybuffernd_Uf.data = NULL;
  __pyx_pybuffernd_Uf.rcbuffer = &amp;__pyx_pybuffer_Uf;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Uf, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Uf.diminfo[0].strides = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf.diminfo[0].shape = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf.diminfo[1].strides = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf.diminfo[1].shape = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.sift", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Uf_nonneg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Uf_neg);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_Uf, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_dim1, __pyx_n_s_dim2, __pyx_n_s_Uf_nonneg, __pyx_n_s_Uf_neg);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_5remap_5sift, NULL, __pyx_n_s_DECSKS_lib_remap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sift, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__12 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__11, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_sift, 76, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;077:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;078: <span class="sd">    We sift by checking the sign on every CFL number associated</span></pre>
<pre class='cython line score-0'>&#xA0;079: <span class="sd">    with each [i,j] of the flux-like object Uf. This is the most</span></pre>
<pre class='cython line score-0'>&#xA0;080: <span class="sd">    general method and allows sifting of Uf into its negative</span></pre>
<pre class='cython line score-0'>&#xA0;081: <span class="sd">    and nonnegative advecting directions into separate containers</span></pre>
<pre class='cython line score-0'>&#xA0;082: <span class="sd">    Uf_neg and Uf_nonneg even if the associated CFL number for a given</span></pre>
<pre class='cython line score-0'>&#xA0;083: <span class="sd">    row in a given column is different than the rest, i.e. can</span></pre>
<pre class='cython line score-0'>&#xA0;084: <span class="sd">    handle the setup created by a symmetric boundary condition.</span></pre>
<pre class='cython line score-0'>&#xA0;085: </pre>
<pre class='cython line score-0'>&#xA0;086: <span class="sd">    we acknowledge we could check the object Uf sign itself, the only case</span></pre>
<pre class='cython line score-0'>&#xA0;087: <span class="sd">    where this will not agree is when either U (CFL.frac high order correction) or f</span></pre>
<pre class='cython line score-0'>&#xA0;088: <span class="sd">    are very small (i.e. np.sign(CFL.number[i,j] != np.sign(Uf[i,j]), which is inconsequential</span></pre>
<pre class='cython line score-0'>&#xA0;089: <span class="sd">    given that the product Uf ~ 0 will contribute negligible amount to the remapped gridpoints,</span></pre>
<pre class='cython line score-0'>&#xA0;090: <span class="sd">    hence it does not matter if, for example that np.sign(CFL.number[i,j]) = -1 but</span></pre>
<pre class='cython line score-0'>&#xA0;091: <span class="sd">    np.sign(Uf[i,j]) = 0, since no matter the remap rule, the contribution from Uf must be</span></pre>
<pre class='cython line score-0'>&#xA0;092: <span class="sd">    negligibly small. We happen to check the CFL number here just out of arbitrary choice.</span></pre>
<pre class='cython line score-0'>&#xA0;093: </pre>
<pre class='cython line score-0'>&#xA0;094: <span class="sd">    The argument for the equivalency of checking the sign of Uf is as follows:</span></pre>
<pre class='cython line score-0'>&#xA0;095: </pre>
<pre class='cython line score-0'>&#xA0;096: <span class="sd">    Recall that,</span></pre>
<pre class='cython line score-0'>&#xA0;097: </pre>
<pre class='cython line score-0'>&#xA0;098: <span class="sd">        Uf = CFL.frac * f + (Higher order corrections)</span></pre>
<pre class='cython line score-0'>&#xA0;099: </pre>
<pre class='cython line score-0'>&#xA0;100: <span class="sd">    since f is strictly nonnegative everywhere in phase space, the</span></pre>
<pre class='cython line score-0'>&#xA0;101: <span class="sd">    flux Uf already factors in CFL.frac as the zeroeth order term,</span></pre>
<pre class='cython line score-0'>&#xA0;102: <span class="sd">    and the numerical limiter on the high order corrections ensure that Uf</span></pre>
<pre class='cython line score-0'>&#xA0;103: <span class="sd">    shares the same sign as the zeroeth order term, hence Uf has the same</span></pre>
<pre class='cython line score-0'>&#xA0;104: <span class="sd">    sign as CFL.frac which itself is defined in such a way to have</span></pre>
<pre class='cython line score-0'>&#xA0;105: <span class="sd">    the same direction of travel (sign) as CFL.numbers; however, we have</span></pre>
<pre class='cython line score-0'>&#xA0;106: <span class="sd">    noted that when the fraction is significantly small the two signs</span></pre>
<pre class='cython line score-0'>&#xA0;107: <span class="sd">    may technically not calculate the same sign (CFL.frac sign may be</span></pre>
<pre class='cython line score-0'>&#xA0;108: <span class="sd">    calculated as 0 if sufficiently small, whereas CFL.numbers would</span></pre>
<pre class='cython line score-0'>&#xA0;109: <span class="sd">    be +1 or -1. Note that this does not matter as Uf ~ 0 so whichever</span></pre>
<pre class='cython line score-0'>&#xA0;110: <span class="sd">    remapping rule is used in the subsequent remapping procedure, it</span></pre>
<pre class='cython line score-0'>&#xA0;111: <span class="sd">    contributes negligibly to the remappings)</span></pre>
<pre class='cython line score-0'>&#xA0;112: </pre>
<pre class='cython line score-0'>&#xA0;113: <span class="sd">    This routine differs from remap.sift_by_column in two ways:</span></pre>
<pre class='cython line score-0'>&#xA0;114: </pre>
<pre class='cython line score-0'>&#xA0;115: <span class="sd">        (1) it checks the sign on the input paramter Uf, hence</span></pre>
<pre class='cython line score-0'>&#xA0;116: <span class="sd">            checking the sign on CFL.frac is not needed as discussed</span></pre>
<pre class='cython line score-0'>&#xA0;117: <span class="sd">            above.</span></pre>
<pre class='cython line score-0'>&#xA0;118: <span class="sd">        (2) it checks the sign of every (i,j), not just the first row</span></pre>
<pre class='cython line score-0'>&#xA0;119: <span class="sd">            entry in a column (i.e. does not assume every row of</span></pre>
<pre class='cython line score-0'>&#xA0;120: <span class="sd">            a given column are described by the same direction of</span></pre>
<pre class='cython line score-0'>&#xA0;121: <span class="sd">            advection [given by the sign of the CFL number or</span></pre>
<pre class='cython line score-0'>&#xA0;122: <span class="sd">            equivalently the product Uf, as discussed above])</span></pre>
<pre class='cython line score-0'>&#xA0;123: </pre>
<pre class='cython line score-0'>&#xA0;124: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;125:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+126:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim1</span> <span class="o">=</span> <span class="n">Uf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim1 = (__pyx_v_Uf-&gt;dimensions[0]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+127:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim2</span> <span class="o">=</span> <span class="n">Uf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim2 = (__pyx_v_Uf-&gt;dimensions[1]);
</pre><pre class='cython line score-0'>&#xA0;128: </pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+129:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_nonneg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Uf_nonneg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Uf_nonneg.diminfo[0].strides = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_nonneg.diminfo[1].strides = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_Uf_nonneg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-45' onclick='toggleDiv(this)'>+130:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Uf_neg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Uf_neg.diminfo[0].strides = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_neg.diminfo[0].shape = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_neg.diminfo[1].strides = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_neg.diminfo[1].shape = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_Uf_neg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;131: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+132:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_8 = __pyx_v_dim2;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_j = __pyx_t_9;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+133:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_dim1;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+134:             <span class="k">if</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-2'>      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_pybuffernd_Uf.diminfo[0].shape;
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_14 = 0;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_pybuffernd_Uf.diminfo[1].shape;
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_15 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Uf.diminfo[1].strides)) &gt;= 0.0) != 0);
      if (__pyx_t_15) {
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+135:                 <span class="n">Uf_nonneg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_14 = __pyx_v_i;
        __pyx_t_16 = __pyx_v_j;
        __pyx_t_17 = -1;
        if (__pyx_t_14 &lt; 0) {
          __pyx_t_14 += __pyx_pybuffernd_Uf.diminfo[0].shape;
          if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_17 = 0;
        } else if (unlikely(__pyx_t_14 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_17 = 0;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_pybuffernd_Uf.diminfo[1].shape;
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_17 = 1;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_17 = 1;
        if (unlikely(__pyx_t_17 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_17 = __pyx_v_i;
        __pyx_t_18 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape;
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape)) __pyx_t_19 = 0;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape;
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape)) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Uf_nonneg.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Uf_nonneg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Uf.diminfo[1].strides));
        goto __pyx_L7;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;136:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+137:                 <span class="n">Uf_neg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_19 = __pyx_v_i;
        __pyx_t_20 = __pyx_v_j;
        __pyx_t_21 = -1;
        if (__pyx_t_19 &lt; 0) {
          __pyx_t_19 += __pyx_pybuffernd_Uf.diminfo[0].shape;
          if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_21 = 0;
        } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_21 = 0;
        if (__pyx_t_20 &lt; 0) {
          __pyx_t_20 += __pyx_pybuffernd_Uf.diminfo[1].shape;
          if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_21 = 1;
        } else if (unlikely(__pyx_t_20 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_21 = 1;
        if (unlikely(__pyx_t_21 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_23 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_pybuffernd_Uf_neg.diminfo[0].shape;
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_23 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_pybuffernd_Uf_neg.diminfo[0].shape)) __pyx_t_23 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_pybuffernd_Uf_neg.diminfo[1].shape;
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_23 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_pybuffernd_Uf_neg.diminfo[1].shape)) __pyx_t_23 = 1;
        if (unlikely(__pyx_t_23 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_Uf_neg.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_Uf_neg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_Uf.diminfo[1].strides));
      }
      __pyx_L7:;
    }
  }
</pre><pre class='cython line score-0'>&#xA0;138: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+139:     <span class="k">return</span> <span class="n">Uf_nonneg</span><span class="p">,</span> <span class="n">Uf_neg</span></pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_nonneg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_nonneg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_Uf_nonneg));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_neg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_neg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_Uf_neg));
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;140: </pre>
<pre class='cython line score-91' onclick='toggleDiv(this)'>+141: <span class="k">def</span> <span class="nf">sift_by_velocity</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">vzpostpointmesh</span><span class="p">,</span> <span class="nb">int</span> <span class="n">Nvz</span><span class="p">):</span></pre>
<pre class='cython code score-91'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_7sift_by_velocity(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6DECSKS_3lib_5remap_6sift_by_velocity[] = "\n    We sift by checking the sign on every CFL number associated\n    with each [i,j] of the flux-like object Uf. This is the most\n    general method and allows sifting of Uf into its negative\n    and nonnegative advecting directions into separate containers\n    Uf_neg and Uf_nonneg even if the associated CFL number for a given\n    row in a given column is different than the rest, i.e. can\n    handle the setup created by a symmetric boundary condition.\n\n    we acknowledge we could check the object Uf sign itself, the only case\n    where this will not agree is when either U (CFL.frac high order correction) or f\n    are very small (i.e. np.sign(CFL.number[i,j] != np.sign(Uf[i,j]), which is inconsequential\n    given that the product Uf ~ 0 will contribute negligible amount to the remapped gridpoints,\n    hence it does not matter if, for example that np.sign(CFL.number[i,j]) = -1 but\n    np.sign(Uf[i,j]) = 0, since no matter the remap rule, the contribution from Uf must be\n    negligibly small. We happen to check the CFL number here just out of arbitrary choice.\n\n    The argument for the equivalency of checking the sign of Uf is as follows:\n\n    Recall that,\n\n        Uf = CFL.frac * f + (Higher order corrections)\nn\n    since f is strictly nonnegative everywhere in phase space, the\n    flux Uf already factors in CFL.frac as the zeroeth order term,\n    and the numerical limiter on the high order corrections ensure that Uf\n    shares the same sign as the zeroeth order term, hence Uf has the same\n    sign as CFL.frac which itself is defined in such a way to have\n    the same direction of travel (sign) as CFL.numbers; however, we have\n    noted that when the fraction is significantly small the two signs\n    may technically not calculate the same sign (CFL.frac sign may be\n    calculated as 0 if sufficiently small, whereas CFL.numbers would\n    be +1 or -1. Note that this does not matter as Uf ~ 0 so whichever\n    remapping rule is used in the ""subsequent remapping procedure, it\n    contributes negligibly to the remappings)\n\n    This routine differs from remap.sift_by_column in two ways:\n\n        (1) it checks the sign on the input paramter Uf, hence\n            checking the sign on CFL.frac is not needed as discussed\n            above.\n        (2) it checks the sign of every (i,j), not just the first row\n            entry in a column (i.e. does not assume every row of\n            a given column are described by the same direction of\n            advection [given by the sign of the CFL number or\n            equivalently the product Uf, as discussed above])\n\n    ";
static PyMethodDef __pyx_mdef_6DECSKS_3lib_5remap_7sift_by_velocity = {"sift_by_velocity", (PyCFunction)__pyx_pw_6DECSKS_3lib_5remap_7sift_by_velocity, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6DECSKS_3lib_5remap_6sift_by_velocity};
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_7sift_by_velocity(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_Uf = 0;
  PyArrayObject *__pyx_v_vzpostpointmesh = 0;
  int __pyx_v_Nvz;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift_by_velocity (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_Uf,&amp;__pyx_n_s_vzpostpointmesh,&amp;__pyx_n_s_Nvz,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Uf)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vzpostpointmesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sift_by_velocity", 1, 3, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Nvz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sift_by_velocity", 1, 3, 3, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sift_by_velocity") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_Uf = ((PyArrayObject *)values[0]);
    __pyx_v_vzpostpointmesh = ((PyArrayObject *)values[1]);
    __pyx_v_Nvz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_Nvz == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sift_by_velocity", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.sift_by_velocity", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Uf), __pyx_ptype_5numpy_ndarray, 1, "Uf", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vzpostpointmesh), __pyx_ptype_5numpy_ndarray, 1, "vzpostpointmesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_5remap_6sift_by_velocity(__pyx_self, __pyx_v_Uf, __pyx_v_vzpostpointmesh, __pyx_v_Nvz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_5remap_6sift_by_velocity(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_Uf, PyArrayObject *__pyx_v_vzpostpointmesh, int __pyx_v_Nvz) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_dim1;
  int __pyx_v_dim2;
  PyArrayObject *__pyx_v_Uf_nonneg = 0;
  PyArrayObject *__pyx_v_Uf_neg = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf;
  __Pyx_Buffer __pyx_pybuffer_Uf;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_neg;
  __Pyx_Buffer __pyx_pybuffer_Uf_neg;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_nonneg;
  __Pyx_Buffer __pyx_pybuffer_Uf_nonneg;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vzpostpointmesh;
  __Pyx_Buffer __pyx_pybuffer_vzpostpointmesh;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift_by_velocity", 0);
  __pyx_pybuffer_Uf_nonneg.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_nonneg.refcount = 0;
  __pyx_pybuffernd_Uf_nonneg.data = NULL;
  __pyx_pybuffernd_Uf_nonneg.rcbuffer = &amp;__pyx_pybuffer_Uf_nonneg;
  __pyx_pybuffer_Uf_neg.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_neg.refcount = 0;
  __pyx_pybuffernd_Uf_neg.data = NULL;
  __pyx_pybuffernd_Uf_neg.rcbuffer = &amp;__pyx_pybuffer_Uf_neg;
  __pyx_pybuffer_Uf.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf.refcount = 0;
  __pyx_pybuffernd_Uf.data = NULL;
  __pyx_pybuffernd_Uf.rcbuffer = &amp;__pyx_pybuffer_Uf;
  __pyx_pybuffer_vzpostpointmesh.pybuffer.buf = NULL;
  __pyx_pybuffer_vzpostpointmesh.refcount = 0;
  __pyx_pybuffernd_vzpostpointmesh.data = NULL;
  __pyx_pybuffernd_vzpostpointmesh.rcbuffer = &amp;__pyx_pybuffer_vzpostpointmesh;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Uf, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Uf.diminfo[0].strides = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf.diminfo[0].shape = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf.diminfo[1].strides = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf.diminfo[1].shape = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzpostpointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vzpostpointmesh.diminfo[0].strides = __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzpostpointmesh.diminfo[0].shape = __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzpostpointmesh.diminfo[1].strides = __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzpostpointmesh.diminfo[1].shape = __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.sift_by_velocity", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Uf_nonneg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Uf_neg);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_Uf, __pyx_n_s_vzpostpointmesh, __pyx_n_s_Nvz, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_dim1, __pyx_n_s_dim2, __pyx_n_s_Uf_nonneg, __pyx_n_s_Uf_neg);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_5remap_7sift_by_velocity, NULL, __pyx_n_s_DECSKS_lib_remap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sift_by_velocity, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__14 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__13, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_sift_by_velocity, 141, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;142:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;143: <span class="sd">    We sift by checking the sign on every CFL number associated</span></pre>
<pre class='cython line score-0'>&#xA0;144: <span class="sd">    with each [i,j] of the flux-like object Uf. This is the most</span></pre>
<pre class='cython line score-0'>&#xA0;145: <span class="sd">    general method and allows sifting of Uf into its negative</span></pre>
<pre class='cython line score-0'>&#xA0;146: <span class="sd">    and nonnegative advecting directions into separate containers</span></pre>
<pre class='cython line score-0'>&#xA0;147: <span class="sd">    Uf_neg and Uf_nonneg even if the associated CFL number for a given</span></pre>
<pre class='cython line score-0'>&#xA0;148: <span class="sd">    row in a given column is different than the rest, i.e. can</span></pre>
<pre class='cython line score-0'>&#xA0;149: <span class="sd">    handle the setup created by a symmetric boundary condition.</span></pre>
<pre class='cython line score-0'>&#xA0;150: </pre>
<pre class='cython line score-0'>&#xA0;151: <span class="sd">    we acknowledge we could check the object Uf sign itself, the only case</span></pre>
<pre class='cython line score-0'>&#xA0;152: <span class="sd">    where this will not agree is when either U (CFL.frac high order correction) or f</span></pre>
<pre class='cython line score-0'>&#xA0;153: <span class="sd">    are very small (i.e. np.sign(CFL.number[i,j] != np.sign(Uf[i,j]), which is inconsequential</span></pre>
<pre class='cython line score-0'>&#xA0;154: <span class="sd">    given that the product Uf ~ 0 will contribute negligible amount to the remapped gridpoints,</span></pre>
<pre class='cython line score-0'>&#xA0;155: <span class="sd">    hence it does not matter if, for example that np.sign(CFL.number[i,j]) = -1 but</span></pre>
<pre class='cython line score-0'>&#xA0;156: <span class="sd">    np.sign(Uf[i,j]) = 0, since no matter the remap rule, the contribution from Uf must be</span></pre>
<pre class='cython line score-0'>&#xA0;157: <span class="sd">    negligibly small. We happen to check the CFL number here just out of arbitrary choice.</span></pre>
<pre class='cython line score-0'>&#xA0;158: </pre>
<pre class='cython line score-0'>&#xA0;159: <span class="sd">    The argument for the equivalency of checking the sign of Uf is as follows:</span></pre>
<pre class='cython line score-0'>&#xA0;160: </pre>
<pre class='cython line score-0'>&#xA0;161: <span class="sd">    Recall that,</span></pre>
<pre class='cython line score-0'>&#xA0;162: </pre>
<pre class='cython line score-0'>&#xA0;163: <span class="sd">        Uf = CFL.frac * f + (Higher order corrections)</span></pre>
<pre class='cython line score-0'>&#xA0;164: <span class="sd">n</span></pre>
<pre class='cython line score-0'>&#xA0;165: <span class="sd">    since f is strictly nonnegative everywhere in phase space, the</span></pre>
<pre class='cython line score-0'>&#xA0;166: <span class="sd">    flux Uf already factors in CFL.frac as the zeroeth order term,</span></pre>
<pre class='cython line score-0'>&#xA0;167: <span class="sd">    and the numerical limiter on the high order corrections ensure that Uf</span></pre>
<pre class='cython line score-0'>&#xA0;168: <span class="sd">    shares the same sign as the zeroeth order term, hence Uf has the same</span></pre>
<pre class='cython line score-0'>&#xA0;169: <span class="sd">    sign as CFL.frac which itself is defined in such a way to have</span></pre>
<pre class='cython line score-0'>&#xA0;170: <span class="sd">    the same direction of travel (sign) as CFL.numbers; however, we have</span></pre>
<pre class='cython line score-0'>&#xA0;171: <span class="sd">    noted that when the fraction is significantly small the two signs</span></pre>
<pre class='cython line score-0'>&#xA0;172: <span class="sd">    may technically not calculate the same sign (CFL.frac sign may be</span></pre>
<pre class='cython line score-0'>&#xA0;173: <span class="sd">    calculated as 0 if sufficiently small, whereas CFL.numbers would</span></pre>
<pre class='cython line score-0'>&#xA0;174: <span class="sd">    be +1 or -1. Note that this does not matter as Uf ~ 0 so whichever</span></pre>
<pre class='cython line score-0'>&#xA0;175: <span class="sd">    remapping rule is used in the subsequent remapping procedure, it</span></pre>
<pre class='cython line score-0'>&#xA0;176: <span class="sd">    contributes negligibly to the remappings)</span></pre>
<pre class='cython line score-0'>&#xA0;177: </pre>
<pre class='cython line score-0'>&#xA0;178: <span class="sd">    This routine differs from remap.sift_by_column in two ways:</span></pre>
<pre class='cython line score-0'>&#xA0;179: </pre>
<pre class='cython line score-0'>&#xA0;180: <span class="sd">        (1) it checks the sign on the input paramter Uf, hence</span></pre>
<pre class='cython line score-0'>&#xA0;181: <span class="sd">            checking the sign on CFL.frac is not needed as discussed</span></pre>
<pre class='cython line score-0'>&#xA0;182: <span class="sd">            above.</span></pre>
<pre class='cython line score-0'>&#xA0;183: <span class="sd">        (2) it checks the sign of every (i,j), not just the first row</span></pre>
<pre class='cython line score-0'>&#xA0;184: <span class="sd">            entry in a column (i.e. does not assume every row of</span></pre>
<pre class='cython line score-0'>&#xA0;185: <span class="sd">            a given column are described by the same direction of</span></pre>
<pre class='cython line score-0'>&#xA0;186: <span class="sd">            advection [given by the sign of the CFL number or</span></pre>
<pre class='cython line score-0'>&#xA0;187: <span class="sd">            equivalently the product Uf, as discussed above])</span></pre>
<pre class='cython line score-0'>&#xA0;188: </pre>
<pre class='cython line score-0'>&#xA0;189: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;190:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+191:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim1</span> <span class="o">=</span> <span class="n">Uf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim1 = (__pyx_v_Uf-&gt;dimensions[0]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+192:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim2</span> <span class="o">=</span> <span class="n">Uf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim2 = (__pyx_v_Uf-&gt;dimensions[1]);
</pre><pre class='cython line score-0'>&#xA0;193: </pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+194:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_nonneg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Uf_nonneg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Uf_nonneg.diminfo[0].strides = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_nonneg.diminfo[1].strides = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_Uf_nonneg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-45' onclick='toggleDiv(this)'>+195:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Uf_neg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Uf_neg.diminfo[0].strides = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_neg.diminfo[0].shape = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_neg.diminfo[1].strides = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_neg.diminfo[1].shape = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_Uf_neg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;196: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+197:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_8 = __pyx_v_dim2;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_j = __pyx_t_9;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+198:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_dim1;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+199:             <span class="k">if</span> <span class="n">vzpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Nvz</span> <span class="o">/</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-2'>      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_pybuffernd_vzpostpointmesh.diminfo[0].shape;
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_pybuffernd_vzpostpointmesh.diminfo[0].shape)) __pyx_t_14 = 0;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_pybuffernd_vzpostpointmesh.diminfo[1].shape;
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_pybuffernd_vzpostpointmesh.diminfo[1].shape)) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_15 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPEINT_t *, __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_vzpostpointmesh.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_vzpostpointmesh.diminfo[1].strides)) &gt;= __Pyx_div_long(__pyx_v_Nvz, 2)) != 0);
      if (__pyx_t_15) {
</pre><pre class='cython line score-0'>&#xA0;200:                 <span class="c">#                print &quot;vzpostpointmesh[i,j] = %d &gt;= %d should be a nonnegative postpoint&quot; % (vzpostpointmesh[i,j], Nvz/2)</span></pre>
<pre class='cython line score-0'>&#xA0;201:                 <span class="c">#                print &quot;Uf[i,j] = %g&quot; % Uf[i,j]</span></pre>
<pre class='cython line score-0'>&#xA0;202: </pre>
<pre class='cython line score-0'>&#xA0;203: </pre>
<pre class='cython line score-0'>&#xA0;204:                 <span class="c"># if the &quot;postpoint&quot; velocities are at indices Nvz/2 which is vx.gridvalues &gt;= 0 store in Uf_nonneg</span></pre>
<pre class='cython line score-0'>&#xA0;205: </pre>
<pre class='cython line score-0'>&#xA0;206:                 <span class="c"># note that in this context this is kind of a misnomer, it&#39;s a very fitting name in other contexts (e.g. remapping)</span></pre>
<pre class='cython line score-0'>&#xA0;207:                 <span class="c"># what we actually mean here is a collection of all *prepoint* velocities coresponding to particles that remain on-grid</span></pre>
<pre class='cython line score-0'>&#xA0;208:                 <span class="c"># in this time step and also where any exiting particles have been replaced with entering partner particles which have</span></pre>
<pre class='cython line score-0'>&#xA0;209:                 <span class="c"># oppositely oriented velocity. Thus, truly in this context this is a &quot;prepoint mesh for all particles that map on-grid&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;210:                 <span class="c"># however it is so-named postpointmesh becuase in the remap routine we map each [i,j] to their postpoint locations</span></pre>
<pre class='cython line score-0'>&#xA0;211:                 <span class="c"># (zpostpointmesh[i,j], vzpostpointmesh[i,j]), where this 2D array of indices give the duples naturally thought of as</span></pre>
<pre class='cython line score-0'>&#xA0;212:                 <span class="c"># &quot;postpoint&quot; duples.</span></pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+213:                 <span class="n">Uf_nonneg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_14 = __pyx_v_i;
        __pyx_t_16 = __pyx_v_j;
        __pyx_t_17 = -1;
        if (__pyx_t_14 &lt; 0) {
          __pyx_t_14 += __pyx_pybuffernd_Uf.diminfo[0].shape;
          if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_17 = 0;
        } else if (unlikely(__pyx_t_14 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_17 = 0;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_pybuffernd_Uf.diminfo[1].shape;
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_17 = 1;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_17 = 1;
        if (unlikely(__pyx_t_17 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_17 = __pyx_v_i;
        __pyx_t_18 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape;
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape)) __pyx_t_19 = 0;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape;
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape)) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Uf_nonneg.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Uf_nonneg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Uf.diminfo[1].strides));
        goto __pyx_L7;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;214:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;215:                 <span class="c">#                print &quot;vzpostpointmesh[i,j] = %d &lt; %d should be a negative postpoint&quot; % (vzpostpointmesh[i,j], Nvz/2)</span></pre>
<pre class='cython line score-0'>&#xA0;216:                 <span class="c">#                print &quot;Uf[i,j] = %g&quot; % Uf[i,j]</span></pre>
<pre class='cython line score-0'>&#xA0;217: </pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+218:                 <span class="n">Uf_neg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_19 = __pyx_v_i;
        __pyx_t_20 = __pyx_v_j;
        __pyx_t_21 = -1;
        if (__pyx_t_19 &lt; 0) {
          __pyx_t_19 += __pyx_pybuffernd_Uf.diminfo[0].shape;
          if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_21 = 0;
        } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_21 = 0;
        if (__pyx_t_20 &lt; 0) {
          __pyx_t_20 += __pyx_pybuffernd_Uf.diminfo[1].shape;
          if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_21 = 1;
        } else if (unlikely(__pyx_t_20 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_21 = 1;
        if (unlikely(__pyx_t_21 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_23 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_pybuffernd_Uf_neg.diminfo[0].shape;
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_23 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_pybuffernd_Uf_neg.diminfo[0].shape)) __pyx_t_23 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_pybuffernd_Uf_neg.diminfo[1].shape;
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_23 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_pybuffernd_Uf_neg.diminfo[1].shape)) __pyx_t_23 = 1;
        if (unlikely(__pyx_t_23 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_Uf_neg.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_Uf_neg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_Uf.diminfo[1].strides));
      }
      __pyx_L7:;
    }
  }
</pre><pre class='cython line score-0'>&#xA0;219: </pre>
<pre class='cython line score-0'>&#xA0;220:                 <span class="c">#    nonzero_indices = np.where(Uf_nonneg != 0)</span></pre>
<pre class='cython line score-0'>&#xA0;221:     <span class="c">#    print &quot;Uf_nonneg = &quot;</span></pre>
<pre class='cython line score-0'>&#xA0;222:     <span class="c">#    print Uf_nonneg[nonzero_indices[0], nonzero_indices[1]]</span></pre>
<pre class='cython line score-0'>&#xA0;223: </pre>
<pre class='cython line score-0'>&#xA0;224: </pre>
<pre class='cython line score-0'>&#xA0;225:     <span class="c">#    nonzero_indices = np.where(Uf_neg != 0)</span></pre>
<pre class='cython line score-0'>&#xA0;226:     <span class="c">#    print &quot;Uf_neg = &quot;</span></pre>
<pre class='cython line score-0'>&#xA0;227:     <span class="c">#    print Uf_neg[nonzero_indices[0], nonzero_indices[1]]</span></pre>
<pre class='cython line score-0'>&#xA0;228: </pre>
<pre class='cython line score-0'>&#xA0;229: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+230:     <span class="k">return</span> <span class="n">Uf_nonneg</span><span class="p">,</span> <span class="n">Uf_neg</span></pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_nonneg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_nonneg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_Uf_nonneg));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_neg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_neg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_Uf_neg));
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;231: </pre>
<pre class='cython line score-80' onclick='toggleDiv(this)'>+232: <span class="k">def</span> <span class="nf">sift_by_CFL_column</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">CFL</span><span class="p">):</span></pre>
<pre class='cython code score-80'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_9sift_by_CFL_column(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6DECSKS_3lib_5remap_8sift_by_CFL_column[] = "\n    sift BY COLUMN means this routine reduces the number of sign checks by only\n    checking the first row entry of each column and assumes ALL rows have the\n    same sign of affiliated CFL number (same sign as Uf). This is true for most boundary conditions\n    and will only not be true for a symmetry boundary where it is possible that\n    we replace certain entries [i,j] in the density/flux objects with their\n    oppositely directed entering partners which breaks the constancy of affiliated\n    CFL number (advection direction) for every row in a given column.\n\n    NOTE: for modest mesh sizes, e.g. 240 x 400, the cost of using\n    this sift method vs. the general method below is not seen to actually be very\n    different in processor time per time step.\n\n    inputs:\n    f -- (ndarray, ndim=2, dtype = float64) density like object\n    vz -- (ndarray, ndim=2, dtype = float64) generalized velocity grid\n\n    output:\n    f_nonneg, f_neg -- (ndarrays, ndim=2, dtype = float64) containers holding\n                    density like entires from f according to\n\n                    pos -- for each f[i,j] such that its vz[i,j] &gt;= 0\n                    neg -- for each f[i,j] such that its vz[i,j] &lt; 0\n\n    we acknowledge we could check the object Uf sign itself, the only case\n    where this will not agree is when either U (CFL.frac high order correction) or f\n    are very small (i.e. np.sign(CFL.number[i,j] != np.sign(Uf[i,j]), which is inconsequential\n    given that the product Uf ~ 0 will contribute negligible amount to the remapped gridpoints,\n    hence it does not matter if, for example that np.sign(CFL.number[i,j]) = -1 but\n    np.sign(Uf[i,j]) = 0, since no matter the remap rule, the contribution from Uf must be\n    negligibly small. We happen to check the CFL number here just out of arbitrary choice.\n\n    ";
static PyMethodDef __pyx_mdef_6DECSKS_3lib_5remap_9sift_by_CFL_column = {"sift_by_CFL_column", (PyCFunction)__pyx_pw_6DECSKS_3lib_5remap_9sift_by_CFL_column, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6DECSKS_3lib_5remap_8sift_by_CFL_column};
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_9sift_by_CFL_column(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_Uf = 0;
  PyArrayObject *__pyx_v_CFL = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift_by_CFL_column (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_Uf,&amp;__pyx_n_s_CFL,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Uf)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_CFL)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sift_by_CFL_column", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sift_by_CFL_column") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_Uf = ((PyArrayObject *)values[0]);
    __pyx_v_CFL = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sift_by_CFL_column", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.sift_by_CFL_column", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Uf), __pyx_ptype_5numpy_ndarray, 1, "Uf", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_CFL), __pyx_ptype_5numpy_ndarray, 1, "CFL", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_5remap_8sift_by_CFL_column(__pyx_self, __pyx_v_Uf, __pyx_v_CFL);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_5remap_8sift_by_CFL_column(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_Uf, PyArrayObject *__pyx_v_CFL) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_dim1;
  int __pyx_v_dim2;
  PyArrayObject *__pyx_v_Uf_nonneg = 0;
  PyArrayObject *__pyx_v_Uf_neg = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_CFL;
  __Pyx_Buffer __pyx_pybuffer_CFL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf;
  __Pyx_Buffer __pyx_pybuffer_Uf;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_neg;
  __Pyx_Buffer __pyx_pybuffer_Uf_neg;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_nonneg;
  __Pyx_Buffer __pyx_pybuffer_Uf_nonneg;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift_by_CFL_column", 0);
  __pyx_pybuffer_Uf_nonneg.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_nonneg.refcount = 0;
  __pyx_pybuffernd_Uf_nonneg.data = NULL;
  __pyx_pybuffernd_Uf_nonneg.rcbuffer = &amp;__pyx_pybuffer_Uf_nonneg;
  __pyx_pybuffer_Uf_neg.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_neg.refcount = 0;
  __pyx_pybuffernd_Uf_neg.data = NULL;
  __pyx_pybuffernd_Uf_neg.rcbuffer = &amp;__pyx_pybuffer_Uf_neg;
  __pyx_pybuffer_Uf.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf.refcount = 0;
  __pyx_pybuffernd_Uf.data = NULL;
  __pyx_pybuffernd_Uf.rcbuffer = &amp;__pyx_pybuffer_Uf;
  __pyx_pybuffer_CFL.pybuffer.buf = NULL;
  __pyx_pybuffer_CFL.refcount = 0;
  __pyx_pybuffernd_CFL.data = NULL;
  __pyx_pybuffernd_CFL.rcbuffer = &amp;__pyx_pybuffer_CFL;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Uf, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Uf.diminfo[0].strides = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf.diminfo[0].shape = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf.diminfo[1].strides = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf.diminfo[1].shape = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_CFL, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_CFL.diminfo[0].strides = __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_CFL.diminfo[0].shape = __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_CFL.diminfo[1].strides = __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_CFL.diminfo[1].shape = __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.sift_by_CFL_column", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Uf_nonneg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Uf_neg);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_Uf, __pyx_n_s_CFL, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_dim1, __pyx_n_s_dim2, __pyx_n_s_Uf_nonneg, __pyx_n_s_Uf_neg);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_5remap_9sift_by_CFL_column, NULL, __pyx_n_s_DECSKS_lib_remap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sift_by_CFL_column, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__16 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__15, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_sift_by_CFL_column, 232, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;233:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;234: <span class="sd">    sift BY COLUMN means this routine reduces the number of sign checks by only</span></pre>
<pre class='cython line score-0'>&#xA0;235: <span class="sd">    checking the first row entry of each column and assumes ALL rows have the</span></pre>
<pre class='cython line score-0'>&#xA0;236: <span class="sd">    same sign of affiliated CFL number (same sign as Uf). This is true for most boundary conditions</span></pre>
<pre class='cython line score-0'>&#xA0;237: <span class="sd">    and will only not be true for a symmetry boundary where it is possible that</span></pre>
<pre class='cython line score-0'>&#xA0;238: <span class="sd">    we replace certain entries [i,j] in the density/flux objects with their</span></pre>
<pre class='cython line score-0'>&#xA0;239: <span class="sd">    oppositely directed entering partners which breaks the constancy of affiliated</span></pre>
<pre class='cython line score-0'>&#xA0;240: <span class="sd">    CFL number (advection direction) for every row in a given column.</span></pre>
<pre class='cython line score-0'>&#xA0;241: </pre>
<pre class='cython line score-0'>&#xA0;242: <span class="sd">    NOTE: for modest mesh sizes, e.g. 240 x 400, the cost of using</span></pre>
<pre class='cython line score-0'>&#xA0;243: <span class="sd">    this sift method vs. the general method below is not seen to actually be very</span></pre>
<pre class='cython line score-0'>&#xA0;244: <span class="sd">    different in processor time per time step.</span></pre>
<pre class='cython line score-0'>&#xA0;245: </pre>
<pre class='cython line score-0'>&#xA0;246: <span class="sd">    inputs:</span></pre>
<pre class='cython line score-0'>&#xA0;247: <span class="sd">    f -- (ndarray, ndim=2, dtype = float64) density like object</span></pre>
<pre class='cython line score-0'>&#xA0;248: <span class="sd">    vz -- (ndarray, ndim=2, dtype = float64) generalized velocity grid</span></pre>
<pre class='cython line score-0'>&#xA0;249: </pre>
<pre class='cython line score-0'>&#xA0;250: <span class="sd">    output:</span></pre>
<pre class='cython line score-0'>&#xA0;251: <span class="sd">    f_nonneg, f_neg -- (ndarrays, ndim=2, dtype = float64) containers holding</span></pre>
<pre class='cython line score-0'>&#xA0;252: <span class="sd">                    density like entires from f according to</span></pre>
<pre class='cython line score-0'>&#xA0;253: </pre>
<pre class='cython line score-0'>&#xA0;254: <span class="sd">                    pos -- for each f[i,j] such that its vz[i,j] &gt;= 0</span></pre>
<pre class='cython line score-0'>&#xA0;255: <span class="sd">                    neg -- for each f[i,j] such that its vz[i,j] &lt; 0</span></pre>
<pre class='cython line score-0'>&#xA0;256: </pre>
<pre class='cython line score-0'>&#xA0;257: <span class="sd">    we acknowledge we could check the object Uf sign itself, the only case</span></pre>
<pre class='cython line score-0'>&#xA0;258: <span class="sd">    where this will not agree is when either U (CFL.frac high order correction) or f</span></pre>
<pre class='cython line score-0'>&#xA0;259: <span class="sd">    are very small (i.e. np.sign(CFL.number[i,j] != np.sign(Uf[i,j]), which is inconsequential</span></pre>
<pre class='cython line score-0'>&#xA0;260: <span class="sd">    given that the product Uf ~ 0 will contribute negligible amount to the remapped gridpoints,</span></pre>
<pre class='cython line score-0'>&#xA0;261: <span class="sd">    hence it does not matter if, for example that np.sign(CFL.number[i,j]) = -1 but</span></pre>
<pre class='cython line score-0'>&#xA0;262: <span class="sd">    np.sign(Uf[i,j]) = 0, since no matter the remap rule, the contribution from Uf must be</span></pre>
<pre class='cython line score-0'>&#xA0;263: <span class="sd">    negligibly small. We happen to check the CFL number here just out of arbitrary choice.</span></pre>
<pre class='cython line score-0'>&#xA0;264: </pre>
<pre class='cython line score-0'>&#xA0;265: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;266:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+267:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim1</span> <span class="o">=</span> <span class="n">Uf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim1 = (__pyx_v_Uf-&gt;dimensions[0]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+268:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim2</span> <span class="o">=</span> <span class="n">Uf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim2 = (__pyx_v_Uf-&gt;dimensions[1]);
</pre><pre class='cython line score-0'>&#xA0;269: </pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+270:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_nonneg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Uf_nonneg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Uf_nonneg.diminfo[0].strides = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_nonneg.diminfo[1].strides = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_Uf_nonneg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-45' onclick='toggleDiv(this)'>+271:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Uf_neg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Uf_neg.diminfo[0].strides = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_neg.diminfo[0].shape = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_neg.diminfo[1].strides = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_neg.diminfo[1].shape = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_Uf_neg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;272: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+273:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_8 = __pyx_v_dim2;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_j = __pyx_t_9;
</pre><pre class='cython line score-0'>&#xA0;274:         <span class="c"># we assume this is a case where it will always bge that CFL[0,j] = CFL[1,j] = ... = CFL[-1,j]</span></pre>
<pre class='cython line score-0'>&#xA0;275:         <span class="c"># only checking the sign of the first entry is needed for each column</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+276:         <span class="k">if</span> <span class="n">CFL</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-2'>    __pyx_t_10 = 0;
    __pyx_t_11 = __pyx_v_j;
    __pyx_t_12 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_pybuffernd_CFL.diminfo[0].shape;
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_pybuffernd_CFL.diminfo[0].shape)) __pyx_t_12 = 0;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_pybuffernd_CFL.diminfo[1].shape;
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_pybuffernd_CFL.diminfo[1].shape)) __pyx_t_12 = 1;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_13 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_CFL.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_CFL.diminfo[1].strides)) &gt;= 0.0) != 0);
    if (__pyx_t_13) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+277:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = __pyx_v_dim1;
      for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_12; __pyx_t_14+=1) {
        __pyx_v_i = __pyx_t_14;
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+278:                 <span class="n">Uf_nonneg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_15 = __pyx_v_i;
        __pyx_t_16 = __pyx_v_j;
        __pyx_t_17 = -1;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_pybuffernd_Uf.diminfo[0].shape;
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_17 = 0;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_17 = 0;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_pybuffernd_Uf.diminfo[1].shape;
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_17 = 1;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_17 = 1;
        if (unlikely(__pyx_t_17 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_17 = __pyx_v_i;
        __pyx_t_18 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape;
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape)) __pyx_t_19 = 0;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape;
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape)) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Uf_nonneg.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Uf_nonneg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Uf.diminfo[1].strides));
      }
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;279:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+280:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = __pyx_v_dim1;
      for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_12; __pyx_t_14+=1) {
        __pyx_v_i = __pyx_t_14;
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+281:                 <span class="n">Uf_neg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_19 = __pyx_v_i;
        __pyx_t_20 = __pyx_v_j;
        __pyx_t_21 = -1;
        if (__pyx_t_19 &lt; 0) {
          __pyx_t_19 += __pyx_pybuffernd_Uf.diminfo[0].shape;
          if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_21 = 0;
        } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_21 = 0;
        if (__pyx_t_20 &lt; 0) {
          __pyx_t_20 += __pyx_pybuffernd_Uf.diminfo[1].shape;
          if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_21 = 1;
        } else if (unlikely(__pyx_t_20 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_21 = 1;
        if (unlikely(__pyx_t_21 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_23 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_pybuffernd_Uf_neg.diminfo[0].shape;
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_23 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_pybuffernd_Uf_neg.diminfo[0].shape)) __pyx_t_23 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_pybuffernd_Uf_neg.diminfo[1].shape;
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_23 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_pybuffernd_Uf_neg.diminfo[1].shape)) __pyx_t_23 = 1;
        if (unlikely(__pyx_t_23 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_Uf_neg.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_Uf_neg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_Uf.diminfo[1].strides));
      }
    }
    __pyx_L5:;
  }
</pre><pre class='cython line score-0'>&#xA0;282: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+283:     <span class="k">return</span> <span class="n">Uf_nonneg</span><span class="p">,</span> <span class="n">Uf_neg</span></pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_nonneg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_nonneg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_Uf_nonneg));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_neg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_neg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_Uf_neg));
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;284: </pre>
<pre class='cython line score-78' onclick='toggleDiv(this)'>+285: <span class="k">def</span> <span class="nf">sift_by_CFL</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">CFL</span><span class="p">):</span></pre>
<pre class='cython code score-78'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_11sift_by_CFL(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6DECSKS_3lib_5remap_10sift_by_CFL[] = "\n    We sift by checking the sign on every CFL number associated\n    with each [i,j] of the flux-like object Uf. This is the most\n    general method and allows sifting of Uf into its negative\n    and nonnegative advecting directions into separate containers\n    Uf_neg and Uf_nonneg even if the associated CFL number for a given\n    row in a given column is different than the rest, i.e. can\n    handle the setup created by a symmetric boundary condition.\n\n    we acknowledge we could check the object Uf sign itself, the only case\n    where this will not agree is when either U (CFL.frac high order correction) or f\n    are very small (i.e. np.sign(CFL.number[i,j] != np.sign(Uf[i,j]), which is inconsequential\n    given that the product Uf ~ 0 will contribute negligible amount to the remapped gridpoints,\n    hence it does not matter if, for example that np.sign(CFL.number[i,j]) = -1 but\n    np.sign(Uf[i,j]) = 0, since no matter the remap rule, the contribution from Uf must be\n    negligibly small. We happen to check the CFL number here just out of arbitrary choice.\n\n    The argument for the equivalency of checking the sign of Uf is as follows:\n\n    Recall that,\n\n        Uf = CFL.frac * f + (Higher order corrections)\n\n    since f is strictly nonnegative everywhere in phase space, the\n    flux Uf already factors in CFL.frac as the zeroeth order term,\n    and the numerical limiter on the high order corrections ensure that Uf\n    shares the same sign as the zeroeth order term, hence Uf has the same\n    sign as CFL.frac which itself is defined in such a way to have\n    the same direction of travel (sign) as CFL.numbers; however, we have\n    noted that when the fraction is significantly small the two signs\n    may technically not calculate the same sign (CFL.frac sign may be\n    calculated as 0 if sufficiently small, whereas CFL.numbers would\n    be +1 or -1. Note that this does not matter as Uf ~ 0 so whichever\n    remapping rule is used in the s""ubsequent remapping procedure, it\n    contributes negligibly to the remappings)\n\n    This routine differs from remap.sift_by_column in two ways:\n\n        (1) it checks the sign on the input paramter Uf, hence\n            checking the sign on CFL.frac is not needed as discussed\n            above.\n        (2) it checks the sign of every (i,j), not just the first row\n            entry in a column (i.e. does not assume every row of\n            a given column are described by the same direction of\n            advection [given by the sign of the CFL number or\n            equivalently the product Uf, as discussed above])\n\n    ";
static PyMethodDef __pyx_mdef_6DECSKS_3lib_5remap_11sift_by_CFL = {"sift_by_CFL", (PyCFunction)__pyx_pw_6DECSKS_3lib_5remap_11sift_by_CFL, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6DECSKS_3lib_5remap_10sift_by_CFL};
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_11sift_by_CFL(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_Uf = 0;
  PyArrayObject *__pyx_v_CFL = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift_by_CFL (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_Uf,&amp;__pyx_n_s_CFL,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Uf)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_CFL)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sift_by_CFL", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sift_by_CFL") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_Uf = ((PyArrayObject *)values[0]);
    __pyx_v_CFL = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sift_by_CFL", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.sift_by_CFL", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Uf), __pyx_ptype_5numpy_ndarray, 1, "Uf", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_CFL), __pyx_ptype_5numpy_ndarray, 1, "CFL", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_5remap_10sift_by_CFL(__pyx_self, __pyx_v_Uf, __pyx_v_CFL);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_5remap_10sift_by_CFL(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_Uf, PyArrayObject *__pyx_v_CFL) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_dim1;
  int __pyx_v_dim2;
  PyArrayObject *__pyx_v_Uf_nonneg = 0;
  PyArrayObject *__pyx_v_Uf_neg = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_CFL;
  __Pyx_Buffer __pyx_pybuffer_CFL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf;
  __Pyx_Buffer __pyx_pybuffer_Uf;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_neg;
  __Pyx_Buffer __pyx_pybuffer_Uf_neg;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_nonneg;
  __Pyx_Buffer __pyx_pybuffer_Uf_nonneg;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift_by_CFL", 0);
  __pyx_pybuffer_Uf_nonneg.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_nonneg.refcount = 0;
  __pyx_pybuffernd_Uf_nonneg.data = NULL;
  __pyx_pybuffernd_Uf_nonneg.rcbuffer = &amp;__pyx_pybuffer_Uf_nonneg;
  __pyx_pybuffer_Uf_neg.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_neg.refcount = 0;
  __pyx_pybuffernd_Uf_neg.data = NULL;
  __pyx_pybuffernd_Uf_neg.rcbuffer = &amp;__pyx_pybuffer_Uf_neg;
  __pyx_pybuffer_Uf.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf.refcount = 0;
  __pyx_pybuffernd_Uf.data = NULL;
  __pyx_pybuffernd_Uf.rcbuffer = &amp;__pyx_pybuffer_Uf;
  __pyx_pybuffer_CFL.pybuffer.buf = NULL;
  __pyx_pybuffer_CFL.refcount = 0;
  __pyx_pybuffernd_CFL.data = NULL;
  __pyx_pybuffernd_CFL.rcbuffer = &amp;__pyx_pybuffer_CFL;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Uf, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Uf.diminfo[0].strides = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf.diminfo[0].shape = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf.diminfo[1].strides = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf.diminfo[1].shape = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_CFL, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_CFL.diminfo[0].strides = __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_CFL.diminfo[0].shape = __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_CFL.diminfo[1].strides = __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_CFL.diminfo[1].shape = __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.sift_by_CFL", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Uf_nonneg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Uf_neg);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_Uf, __pyx_n_s_CFL, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_dim1, __pyx_n_s_dim2, __pyx_n_s_Uf_nonneg, __pyx_n_s_Uf_neg);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_5remap_11sift_by_CFL, NULL, __pyx_n_s_DECSKS_lib_remap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sift_by_CFL, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;286:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;287: <span class="sd">    We sift by checking the sign on every CFL number associated</span></pre>
<pre class='cython line score-0'>&#xA0;288: <span class="sd">    with each [i,j] of the flux-like object Uf. This is the most</span></pre>
<pre class='cython line score-0'>&#xA0;289: <span class="sd">    general method and allows sifting of Uf into its negative</span></pre>
<pre class='cython line score-0'>&#xA0;290: <span class="sd">    and nonnegative advecting directions into separate containers</span></pre>
<pre class='cython line score-0'>&#xA0;291: <span class="sd">    Uf_neg and Uf_nonneg even if the associated CFL number for a given</span></pre>
<pre class='cython line score-0'>&#xA0;292: <span class="sd">    row in a given column is different than the rest, i.e. can</span></pre>
<pre class='cython line score-0'>&#xA0;293: <span class="sd">    handle the setup created by a symmetric boundary condition.</span></pre>
<pre class='cython line score-0'>&#xA0;294: </pre>
<pre class='cython line score-0'>&#xA0;295: <span class="sd">    we acknowledge we could check the object Uf sign itself, the only case</span></pre>
<pre class='cython line score-0'>&#xA0;296: <span class="sd">    where this will not agree is when either U (CFL.frac high order correction) or f</span></pre>
<pre class='cython line score-0'>&#xA0;297: <span class="sd">    are very small (i.e. np.sign(CFL.number[i,j] != np.sign(Uf[i,j]), which is inconsequential</span></pre>
<pre class='cython line score-0'>&#xA0;298: <span class="sd">    given that the product Uf ~ 0 will contribute negligible amount to the remapped gridpoints,</span></pre>
<pre class='cython line score-0'>&#xA0;299: <span class="sd">    hence it does not matter if, for example that np.sign(CFL.number[i,j]) = -1 but</span></pre>
<pre class='cython line score-0'>&#xA0;300: <span class="sd">    np.sign(Uf[i,j]) = 0, since no matter the remap rule, the contribution from Uf must be</span></pre>
<pre class='cython line score-0'>&#xA0;301: <span class="sd">    negligibly small. We happen to check the CFL number here just out of arbitrary choice.</span></pre>
<pre class='cython line score-0'>&#xA0;302: </pre>
<pre class='cython line score-0'>&#xA0;303: <span class="sd">    The argument for the equivalency of checking the sign of Uf is as follows:</span></pre>
<pre class='cython line score-0'>&#xA0;304: </pre>
<pre class='cython line score-0'>&#xA0;305: <span class="sd">    Recall that,</span></pre>
<pre class='cython line score-0'>&#xA0;306: </pre>
<pre class='cython line score-0'>&#xA0;307: <span class="sd">        Uf = CFL.frac * f + (Higher order corrections)</span></pre>
<pre class='cython line score-0'>&#xA0;308: </pre>
<pre class='cython line score-0'>&#xA0;309: <span class="sd">    since f is strictly nonnegative everywhere in phase space, the</span></pre>
<pre class='cython line score-0'>&#xA0;310: <span class="sd">    flux Uf already factors in CFL.frac as the zeroeth order term,</span></pre>
<pre class='cython line score-0'>&#xA0;311: <span class="sd">    and the numerical limiter on the high order corrections ensure that Uf</span></pre>
<pre class='cython line score-0'>&#xA0;312: <span class="sd">    shares the same sign as the zeroeth order term, hence Uf has the same</span></pre>
<pre class='cython line score-0'>&#xA0;313: <span class="sd">    sign as CFL.frac which itself is defined in such a way to have</span></pre>
<pre class='cython line score-0'>&#xA0;314: <span class="sd">    the same direction of travel (sign) as CFL.numbers; however, we have</span></pre>
<pre class='cython line score-0'>&#xA0;315: <span class="sd">    noted that when the fraction is significantly small the two signs</span></pre>
<pre class='cython line score-0'>&#xA0;316: <span class="sd">    may technically not calculate the same sign (CFL.frac sign may be</span></pre>
<pre class='cython line score-0'>&#xA0;317: <span class="sd">    calculated as 0 if sufficiently small, whereas CFL.numbers would</span></pre>
<pre class='cython line score-0'>&#xA0;318: <span class="sd">    be +1 or -1. Note that this does not matter as Uf ~ 0 so whichever</span></pre>
<pre class='cython line score-0'>&#xA0;319: <span class="sd">    remapping rule is used in the subsequent remapping procedure, it</span></pre>
<pre class='cython line score-0'>&#xA0;320: <span class="sd">    contributes negligibly to the remappings)</span></pre>
<pre class='cython line score-0'>&#xA0;321: </pre>
<pre class='cython line score-0'>&#xA0;322: <span class="sd">    This routine differs from remap.sift_by_column in two ways:</span></pre>
<pre class='cython line score-0'>&#xA0;323: </pre>
<pre class='cython line score-0'>&#xA0;324: <span class="sd">        (1) it checks the sign on the input paramter Uf, hence</span></pre>
<pre class='cython line score-0'>&#xA0;325: <span class="sd">            checking the sign on CFL.frac is not needed as discussed</span></pre>
<pre class='cython line score-0'>&#xA0;326: <span class="sd">            above.</span></pre>
<pre class='cython line score-0'>&#xA0;327: <span class="sd">        (2) it checks the sign of every (i,j), not just the first row</span></pre>
<pre class='cython line score-0'>&#xA0;328: <span class="sd">            entry in a column (i.e. does not assume every row of</span></pre>
<pre class='cython line score-0'>&#xA0;329: <span class="sd">            a given column are described by the same direction of</span></pre>
<pre class='cython line score-0'>&#xA0;330: <span class="sd">            advection [given by the sign of the CFL number or</span></pre>
<pre class='cython line score-0'>&#xA0;331: <span class="sd">            equivalently the product Uf, as discussed above])</span></pre>
<pre class='cython line score-0'>&#xA0;332: </pre>
<pre class='cython line score-0'>&#xA0;333: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;334:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+335:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim1</span> <span class="o">=</span> <span class="n">Uf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim1 = (__pyx_v_Uf-&gt;dimensions[0]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+336:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim2</span> <span class="o">=</span> <span class="n">Uf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim2 = (__pyx_v_Uf-&gt;dimensions[1]);
</pre><pre class='cython line score-0'>&#xA0;337: </pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+338:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_nonneg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Uf_nonneg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Uf_nonneg.diminfo[0].strides = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_nonneg.diminfo[1].strides = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_Uf_nonneg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-45' onclick='toggleDiv(this)'>+339:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Uf_neg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Uf_neg.diminfo[0].strides = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_neg.diminfo[0].shape = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_neg.diminfo[1].strides = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_neg.diminfo[1].shape = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_Uf_neg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;340: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+341:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_8 = __pyx_v_dim2;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_j = __pyx_t_9;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+342:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_dim1;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+343:             <span class="k">if</span> <span class="n">CFL</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-2'>      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_pybuffernd_CFL.diminfo[0].shape;
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_pybuffernd_CFL.diminfo[0].shape)) __pyx_t_14 = 0;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_pybuffernd_CFL.diminfo[1].shape;
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_pybuffernd_CFL.diminfo[1].shape)) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_15 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_CFL.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_CFL.diminfo[1].strides)) &gt;= 0.0) != 0);
      if (__pyx_t_15) {
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+344:                 <span class="n">Uf_nonneg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_14 = __pyx_v_i;
        __pyx_t_16 = __pyx_v_j;
        __pyx_t_17 = -1;
        if (__pyx_t_14 &lt; 0) {
          __pyx_t_14 += __pyx_pybuffernd_Uf.diminfo[0].shape;
          if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_17 = 0;
        } else if (unlikely(__pyx_t_14 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_17 = 0;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_pybuffernd_Uf.diminfo[1].shape;
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_17 = 1;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_17 = 1;
        if (unlikely(__pyx_t_17 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_17 = __pyx_v_i;
        __pyx_t_18 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape;
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape)) __pyx_t_19 = 0;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape;
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape)) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Uf_nonneg.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Uf_nonneg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Uf.diminfo[1].strides));
        goto __pyx_L7;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;345:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+346:                 <span class="n">Uf_neg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_19 = __pyx_v_i;
        __pyx_t_20 = __pyx_v_j;
        __pyx_t_21 = -1;
        if (__pyx_t_19 &lt; 0) {
          __pyx_t_19 += __pyx_pybuffernd_Uf.diminfo[0].shape;
          if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_21 = 0;
        } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_21 = 0;
        if (__pyx_t_20 &lt; 0) {
          __pyx_t_20 += __pyx_pybuffernd_Uf.diminfo[1].shape;
          if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_21 = 1;
        } else if (unlikely(__pyx_t_20 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_21 = 1;
        if (unlikely(__pyx_t_21 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_23 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_pybuffernd_Uf_neg.diminfo[0].shape;
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_23 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_pybuffernd_Uf_neg.diminfo[0].shape)) __pyx_t_23 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_pybuffernd_Uf_neg.diminfo[1].shape;
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_23 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_pybuffernd_Uf_neg.diminfo[1].shape)) __pyx_t_23 = 1;
        if (unlikely(__pyx_t_23 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_Uf_neg.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_Uf_neg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_Uf.diminfo[1].strides));
      }
      __pyx_L7:;
    }
  }
</pre><pre class='cython line score-0'>&#xA0;347: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+348:     <span class="k">return</span> <span class="n">Uf_nonneg</span><span class="p">,</span> <span class="n">Uf_neg</span></pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_nonneg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_nonneg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_Uf_nonneg));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_neg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_neg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_Uf_neg));
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre></div></body></html>
