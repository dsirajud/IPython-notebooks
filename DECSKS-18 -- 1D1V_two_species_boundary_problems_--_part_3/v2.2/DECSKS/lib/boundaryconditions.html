<!DOCTYPE html>
<!-- Generated by Cython 0.22.1 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: boundaryconditions.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.22.1</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="boundaryconditions.c">boundaryconditions.c</a></p>
<div class="cython"><pre class='cython line score-19' onclick='toggleDiv(this)'>+001: <span class="k">import</span> <span class="nn">DECSKS</span></pre>
<pre class='cython code score-19'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_DECSKS, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DECSKS, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+002: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;003: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython line score-0'>&#xA0;004: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class='cython line score-0'>&#xA0;005: </pre>
<pre class='cython line score-11' onclick='toggleDiv(this)'>+006: <span class="n">DTYPE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span></pre>
<pre class='cython code score-11'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+007: <span class="n">DTYPEINT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span></pre>
<pre class='cython code score-11'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPEINT, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;008: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+009: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">float64_t</span> <span class="n">DTYPE_t</span></pre>
<pre class='cython code score-0'>typedef __pyx_t_5numpy_float64_t __pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t;
</pre><pre class='cython line score-0'>&#xA0;010: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">int64_t</span> <span class="n">DTYPEINT_t</span></pre>
<pre class='cython line score-0'>&#xA0;011: </pre>
<pre class='cython line score-0'>&#xA0;012: </pre>
<pre class='cython line score-0'>&#xA0;013: <span class="c"># PYTHON METHODS</span></pre>
<pre class='cython line score-103' onclick='toggleDiv(this)'>+014: <span class="k">def</span> <span class="nf">periodic</span><span class="p">(</span><span class="n">f_k</span><span class="p">,</span></pre>
<pre class='cython code score-103'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_1periodic(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6DECSKS_3lib_18boundaryconditions_periodic[] = "Applies periodic boundary conditions to\n    postpointmesh\n\n    inputs:\n    f_old -- (ndarray, ndim=2) density array\n    z -- (instance) phase space variable being evolved\n\n        z.postpointmesh -- (ndarray, ndim=3),\n                           shape = (2, x.N, vx.N)\n\n    outputs:\n    f_old -- (ndarray, ndim=2) Array with both periodic\n             BCs being enforce\n    z    -- (instance) phase sapce variable being evolved with\n             updated attribute z.postpointmesh\n\n    f_old, Uf returned for symmetry with nonperiodic routine below\n\n    NOTE: f_k is the distribution function contribution to all postpoints k.\n    Only a symmetry boundary condition requires access to this object as it needs\n    to make sure particles whose postpoints are exactly on the symmetry plane\n    are factored in before replacing them in the reused f_old and Uf_old objects\n    with their entering partners which are subsequently remapped as usual. This\n    special consideration is described in github.com/dsirajud/../DECSKS-18 part 3 notebook.\n    ";
static PyMethodDef __pyx_mdef_6DECSKS_3lib_18boundaryconditions_1periodic = {"periodic", (PyCFunction)__pyx_pw_6DECSKS_3lib_18boundaryconditions_1periodic, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6DECSKS_3lib_18boundaryconditions_periodic};
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_1periodic(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_f_k = 0;
  PyObject *__pyx_v_f_old = 0;
  PyObject *__pyx_v_Uf = 0;
  PyObject *__pyx_v_z = 0;
  PyObject *__pyx_v_vz = 0;
  CYTHON_UNUSED PyObject *__pyx_v_sim_params = 0;
  CYTHON_UNUSED PyObject *__pyx_v_charge = 0;
  PyObject *__pyx_v_k = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("periodic (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_f_k,&amp;__pyx_n_s_f_old,&amp;__pyx_n_s_Uf,&amp;__pyx_n_s_z,&amp;__pyx_n_s_vz,&amp;__pyx_n_s_sim_params,&amp;__pyx_n_s_charge,&amp;__pyx_n_s_k,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    values[7] = ((PyObject *)__pyx_int_0);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_k)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_old)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("periodic", 0, 7, 8, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Uf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("periodic", 0, 7, 8, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("periodic", 0, 7, 8, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("periodic", 0, 7, 8, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sim_params)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("periodic", 0, 7, 8, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_charge)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("periodic", 0, 7, 8, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_k);
          if (value) { values[7] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "periodic") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_f_k = values[0];
    __pyx_v_f_old = values[1];
    __pyx_v_Uf = values[2];
    __pyx_v_z = values[3];
    __pyx_v_vz = values[4];
    __pyx_v_sim_params = values[5];
    __pyx_v_charge = values[6];
    __pyx_v_k = values[7];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("periodic", 0, 7, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.periodic", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6DECSKS_3lib_18boundaryconditions_periodic(__pyx_self, __pyx_v_f_k, __pyx_v_f_old, __pyx_v_Uf, __pyx_v_z, __pyx_v_vz, __pyx_v_sim_params, __pyx_v_charge, __pyx_v_k);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_18boundaryconditions_periodic(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_f_k, PyObject *__pyx_v_f_old, PyObject *__pyx_v_Uf, PyObject *__pyx_v_z, PyObject *__pyx_v_vz, CYTHON_UNUSED PyObject *__pyx_v_sim_params, CYTHON_UNUSED PyObject *__pyx_v_charge, PyObject *__pyx_v_k) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("periodic", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.periodic", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__37 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_f_k, __pyx_n_s_f_old, __pyx_n_s_Uf, __pyx_n_s_z, __pyx_n_s_vz, __pyx_n_s_sim_params, __pyx_n_s_charge, __pyx_n_s_k);<span class='error_goto'> if (unlikely(!__pyx_tuple__37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__37);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__37);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_18boundaryconditions_1periodic, NULL, __pyx_n_s_DECSKS_lib_boundaryconditions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_periodic, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__38 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_periodic, 14, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__38)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;015:              <span class="n">f_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;016:              <span class="n">Uf</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;017:              <span class="n">z</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;018:              <span class="n">vz</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;019:              <span class="n">sim_params</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;020:              <span class="n">charge</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;021:              <span class="n">k</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython line score-0'>&#xA0;022:              <span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;023:     <span class="sd">&quot;&quot;&quot;Applies periodic boundary conditions to</span></pre>
<pre class='cython line score-0'>&#xA0;024: <span class="sd">    postpointmesh</span></pre>
<pre class='cython line score-0'>&#xA0;025: </pre>
<pre class='cython line score-0'>&#xA0;026: <span class="sd">    inputs:</span></pre>
<pre class='cython line score-0'>&#xA0;027: <span class="sd">    f_old -- (ndarray, ndim=2) density array</span></pre>
<pre class='cython line score-0'>&#xA0;028: <span class="sd">    z -- (instance) phase space variable being evolved</span></pre>
<pre class='cython line score-0'>&#xA0;029: </pre>
<pre class='cython line score-0'>&#xA0;030: <span class="sd">        z.postpointmesh -- (ndarray, ndim=3),</span></pre>
<pre class='cython line score-0'>&#xA0;031: <span class="sd">                           shape = (2, x.N, vx.N)</span></pre>
<pre class='cython line score-0'>&#xA0;032: </pre>
<pre class='cython line score-0'>&#xA0;033: <span class="sd">    outputs:</span></pre>
<pre class='cython line score-0'>&#xA0;034: <span class="sd">    f_old -- (ndarray, ndim=2) Array with both periodic</span></pre>
<pre class='cython line score-0'>&#xA0;035: <span class="sd">             BCs being enforce</span></pre>
<pre class='cython line score-0'>&#xA0;036: <span class="sd">    z    -- (instance) phase sapce variable being evolved with</span></pre>
<pre class='cython line score-0'>&#xA0;037: <span class="sd">             updated attribute z.postpointmesh</span></pre>
<pre class='cython line score-0'>&#xA0;038: </pre>
<pre class='cython line score-0'>&#xA0;039: <span class="sd">    f_old, Uf returned for symmetry with nonperiodic routine below</span></pre>
<pre class='cython line score-0'>&#xA0;040: </pre>
<pre class='cython line score-0'>&#xA0;041: <span class="sd">    NOTE: f_k is the distribution function contribution to all postpoints k.</span></pre>
<pre class='cython line score-0'>&#xA0;042: <span class="sd">    Only a symmetry boundary condition requires access to this object as it needs</span></pre>
<pre class='cython line score-0'>&#xA0;043: <span class="sd">    to make sure particles whose postpoints are exactly on the symmetry plane</span></pre>
<pre class='cython line score-0'>&#xA0;044: <span class="sd">    are factored in before replacing them in the reused f_old and Uf_old objects</span></pre>
<pre class='cython line score-0'>&#xA0;045: <span class="sd">    with their entering partners which are subsequently remapped as usual. This</span></pre>
<pre class='cython line score-0'>&#xA0;046: <span class="sd">    special consideration is described in github.com/dsirajud/../DECSKS-18 part 3 notebook.</span></pre>
<pre class='cython line score-0'>&#xA0;047: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;048: </pre>
<pre class='cython line score-0'>&#xA0;049:     <span class="c"># this orchestrator is called if periodic boundary conditions are specified on the distribution</span></pre>
<pre class='cython line score-0'>&#xA0;050:     <span class="c"># function if a velocity variable or if periodic boundary conditions are specfied on BOTH</span></pre>
<pre class='cython line score-0'>&#xA0;051:     <span class="c"># the distribution function for the configuration variable and its corresponding boundary conditions</span></pre>
<pre class='cython line score-0'>&#xA0;052:     <span class="c"># on the electrostatic potential phi (note that periodic BCs on one but not the other does not make</span></pre>
<pre class='cython line score-0'>&#xA0;053:     <span class="c"># sense and DECSKS will not accept such an input file; simulation will not start and InputErrors</span></pre>
<pre class='cython line score-0'>&#xA0;054:     <span class="c"># will be broadcasted to the user)</span></pre>
<pre class='cython line score-0'>&#xA0;055: </pre>
<pre class='cython line score-90' onclick='toggleDiv(this)'>+056:     <span class="n">z</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:],</span> <span class="n">z</span><span class="o">.</span><span class="n">N</span><span class="p">)</span></pre>
<pre class='cython code score-90'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_mod);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_slice_ = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice_);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice_);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_slice_);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_slice__2);
  __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_N);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (__pyx_t_2) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_4);
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_slice__2 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
  __pyx_slice__3 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__3);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_slice__3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_slice__4);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_3, __pyx_t_7, __pyx_t_1) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_slice__4 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__4);
</pre><pre class='cython line score-33' onclick='toggleDiv(this)'>+057:     <span class="n">vz</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">vz</span><span class="o">.</span><span class="n">prepointmesh</span></pre>
<pre class='cython code score-33'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_prepointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
/* … */
  __pyx_slice__5 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_slice__5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_slice__6);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_7, __pyx_t_3, __pyx_t_1) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_slice__6 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__6);
</pre><pre class='cython line score-0'>&#xA0;058: </pre>
<pre class='cython line score-12' onclick='toggleDiv(this)'>+059:     <span class="k">return</span> <span class="n">f_k</span><span class="p">,</span> <span class="n">f_old</span><span class="p">,</span> <span class="n">Uf</span></pre>
<pre class='cython code score-12'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_f_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_old);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f_old);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_f_old);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Uf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Uf);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_v_Uf);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;060: </pre>
<pre class='cython line score-110' onclick='toggleDiv(this)'>+061: <span class="k">def</span> <span class="nf">nonperiodic</span><span class="p">(</span><span class="n">f_k</span><span class="p">,</span></pre>
<pre class='cython code score-110'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_3nonperiodic(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6DECSKS_3lib_18boundaryconditions_2nonperiodic[] = "orchestrates applying nonperiodic boundary conditions\n    to the array w with total active grid points Nw. Nonperiodic\n    boundary conditions require handling both left and right\n    boundaries\n\n    inputs:\n    f_old -- (ndarray, ndim=2) density array\n    z -- (instance) phase space variable being evolved\n\n    outputs:\n    f_old -- (ndarray, ndim=2) density with both left and right\n             nonperiodic BCs enforced\n    Uf -- (ndarray, ndim=2) high order fluxes with both left and right\n             nonperiodic BCs enforced\n\n\n    z returned (no changes) for symmetry with periodic routine above\n\n    NOTE: f_k is the distribution function contribution to all postpoints k.\n    Only a symmetry boundary condition requires access to this object as it needs\n    to make sure particles whose postpoints are exactly on the symmetry plane\n    are factored in before replacing them in the reused f_old and Uf_old objects\n    with their entering partners which are subsequently remapped as usual. This\n    special consideration is described in github.com/dsirajud/../DECSKS-18 part 3 notebook.\n    ";
static PyMethodDef __pyx_mdef_6DECSKS_3lib_18boundaryconditions_3nonperiodic = {"nonperiodic", (PyCFunction)__pyx_pw_6DECSKS_3lib_18boundaryconditions_3nonperiodic, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6DECSKS_3lib_18boundaryconditions_2nonperiodic};
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_3nonperiodic(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_f_k = 0;
  PyObject *__pyx_v_f_old = 0;
  PyObject *__pyx_v_Uf = 0;
  PyObject *__pyx_v_z = 0;
  PyObject *__pyx_v_vz = 0;
  PyObject *__pyx_v_sim_params = 0;
  PyObject *__pyx_v_charge = 0;
  PyObject *__pyx_v_k = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("nonperiodic (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_f_k,&amp;__pyx_n_s_f_old,&amp;__pyx_n_s_Uf,&amp;__pyx_n_s_z,&amp;__pyx_n_s_vz,&amp;__pyx_n_s_sim_params,&amp;__pyx_n_s_charge,&amp;__pyx_n_s_k,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    values[7] = ((PyObject *)__pyx_int_0);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_k)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_old)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("nonperiodic", 0, 7, 8, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Uf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("nonperiodic", 0, 7, 8, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("nonperiodic", 0, 7, 8, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("nonperiodic", 0, 7, 8, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sim_params)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("nonperiodic", 0, 7, 8, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_charge)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("nonperiodic", 0, 7, 8, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_k);
          if (value) { values[7] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nonperiodic") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_f_k = values[0];
    __pyx_v_f_old = values[1];
    __pyx_v_Uf = values[2];
    __pyx_v_z = values[3];
    __pyx_v_vz = values[4];
    __pyx_v_sim_params = values[5];
    __pyx_v_charge = values[6];
    __pyx_v_k = values[7];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("nonperiodic", 0, 7, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.nonperiodic", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6DECSKS_3lib_18boundaryconditions_2nonperiodic(__pyx_self, __pyx_v_f_k, __pyx_v_f_old, __pyx_v_Uf, __pyx_v_z, __pyx_v_vz, __pyx_v_sim_params, __pyx_v_charge, __pyx_v_k);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_18boundaryconditions_2nonperiodic(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_f_k, PyObject *__pyx_v_f_old, PyObject *__pyx_v_Uf, PyObject *__pyx_v_z, PyObject *__pyx_v_vz, PyObject *__pyx_v_sim_params, PyObject *__pyx_v_charge, PyObject *__pyx_v_k) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("nonperiodic", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_old);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Uf);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.nonperiodic", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_f_old);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Uf);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__39 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_f_k, __pyx_n_s_f_old, __pyx_n_s_Uf, __pyx_n_s_z, __pyx_n_s_vz, __pyx_n_s_sim_params, __pyx_n_s_charge, __pyx_n_s_k);<span class='error_goto'> if (unlikely(!__pyx_tuple__39)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__39);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__39);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_18boundaryconditions_3nonperiodic, NULL, __pyx_n_s_DECSKS_lib_boundaryconditions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_nonperiodic, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__40 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_nonperiodic, 61, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;062:                 <span class="n">f_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;063:                 <span class="n">Uf</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;064:                 <span class="n">z</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;065:                 <span class="n">vz</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;066:                 <span class="n">sim_params</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;067:                 <span class="n">charge</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;068:                 <span class="n">k</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython line score-0'>&#xA0;069:                 <span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;070:     <span class="sd">&quot;&quot;&quot;orchestrates applying nonperiodic boundary conditions</span></pre>
<pre class='cython line score-0'>&#xA0;071: <span class="sd">    to the array w with total active grid points Nw. Nonperiodic</span></pre>
<pre class='cython line score-0'>&#xA0;072: <span class="sd">    boundary conditions require handling both left and right</span></pre>
<pre class='cython line score-0'>&#xA0;073: <span class="sd">    boundaries</span></pre>
<pre class='cython line score-0'>&#xA0;074: </pre>
<pre class='cython line score-0'>&#xA0;075: <span class="sd">    inputs:</span></pre>
<pre class='cython line score-0'>&#xA0;076: <span class="sd">    f_old -- (ndarray, ndim=2) density array</span></pre>
<pre class='cython line score-0'>&#xA0;077: <span class="sd">    z -- (instance) phase space variable being evolved</span></pre>
<pre class='cython line score-0'>&#xA0;078: </pre>
<pre class='cython line score-0'>&#xA0;079: <span class="sd">    outputs:</span></pre>
<pre class='cython line score-0'>&#xA0;080: <span class="sd">    f_old -- (ndarray, ndim=2) density with both left and right</span></pre>
<pre class='cython line score-0'>&#xA0;081: <span class="sd">             nonperiodic BCs enforced</span></pre>
<pre class='cython line score-0'>&#xA0;082: <span class="sd">    Uf -- (ndarray, ndim=2) high order fluxes with both left and right</span></pre>
<pre class='cython line score-0'>&#xA0;083: <span class="sd">             nonperiodic BCs enforced</span></pre>
<pre class='cython line score-0'>&#xA0;084: </pre>
<pre class='cython line score-0'>&#xA0;085: </pre>
<pre class='cython line score-0'>&#xA0;086: <span class="sd">    z returned (no changes) for symmetry with periodic routine above</span></pre>
<pre class='cython line score-0'>&#xA0;087: </pre>
<pre class='cython line score-0'>&#xA0;088: <span class="sd">    NOTE: f_k is the distribution function contribution to all postpoints k.</span></pre>
<pre class='cython line score-0'>&#xA0;089: <span class="sd">    Only a symmetry boundary condition requires access to this object as it needs</span></pre>
<pre class='cython line score-0'>&#xA0;090: <span class="sd">    to make sure particles whose postpoints are exactly on the symmetry plane</span></pre>
<pre class='cython line score-0'>&#xA0;091: <span class="sd">    are factored in before replacing them in the reused f_old and Uf_old objects</span></pre>
<pre class='cython line score-0'>&#xA0;092: <span class="sd">    with their entering partners which are subsequently remapped as usual. This</span></pre>
<pre class='cython line score-0'>&#xA0;093: <span class="sd">    special consideration is described in github.com/dsirajud/../DECSKS-18 part 3 notebook.</span></pre>
<pre class='cython line score-0'>&#xA0;094: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;095:     <span class="c"># lower boundary</span></pre>
<pre class='cython line score-80' onclick='toggleDiv(this)'>+096:     <span class="n">f_old</span><span class="p">,</span> <span class="n">Uf</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">sim_params</span><span class="p">[</span><span class="s">&#39;distribution_function_boundarycondition_handle&#39;</span><span class="p">][</span><span class="n">z</span><span class="o">.</span><span class="n">str</span><span class="p">][</span><span class="s">&#39;lower&#39;</span><span class="p">])(</span></pre>
<pre class='cython code score-80'>  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_sim_params, __pyx_n_s_distribution_function_boundaryco);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_str);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_4, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_Globals</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (__pyx_v_Uf) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_Uf, __pyx_v_Uf) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_charge) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_charge, __pyx_v_charge) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_f_k) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_f_k, __pyx_v_f_k) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_f_old) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_f_old, __pyx_v_f_old) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_k) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_k, __pyx_v_k) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_sim_params) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_sim_params, __pyx_v_sim_params) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_vz) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_vz, __pyx_v_vz) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_z) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_z, __pyx_v_z) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_2);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_eval, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_f_old, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_Uf, __pyx_t_10);
  __pyx_t_10 = 0;
</pre><pre class='cython line score-0'>&#xA0;097:                                               <span class="n">f_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;098:                                               <span class="n">Uf</span><span class="p">,</span></pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+099:                                               <span class="n">z</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:],</span></pre>
<pre class='cython code score-30'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* … */
  __pyx_slice__7 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__7);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_slice__7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_slice__8);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_slice__8 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__8);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+100:                                               <span class="n">vz</span><span class="o">.</span><span class="n">prepointmesh</span><span class="p">,</span></pre>
<pre class='cython code score-2'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_prepointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+101:                                               <span class="n">vz</span><span class="o">.</span><span class="n">prepointvaluemesh</span><span class="p">,</span></pre>
<pre class='cython code score-2'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_prepointvaluemesh);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+102:                                               <span class="n">z</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">vz</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">charge</span><span class="p">,</span></pre>
<pre class='cython code score-4'>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_N);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_N);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class='cython line score-0'>&#xA0;103:                                               <span class="n">sim_params</span><span class="p">,</span></pre>
<pre class='cython line score-86' onclick='toggleDiv(this)'>+104:                                               <span class="n">z</span><span class="p">,</span> <span class="n">vz</span><span class="p">)</span></pre>
<pre class='cython code score-86'>  __pyx_t_8 = NULL;
  __pyx_t_9 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_9 = 1;
    }
  }
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(12+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  if (__pyx_t_8) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_old);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f_old);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_9, __pyx_v_f_old);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Uf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Uf);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_9, __pyx_v_Uf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2+__pyx_t_9, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 3+__pyx_t_9, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 4+__pyx_t_9, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 5+__pyx_t_9, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 6+__pyx_t_9, __pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 7+__pyx_t_9, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_charge);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_charge);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 8+__pyx_t_9, __pyx_v_charge);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sim_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sim_params);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 9+__pyx_t_9, __pyx_v_sim_params);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_z);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_z);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 10+__pyx_t_9, __pyx_v_z);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vz);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vz);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 11+__pyx_t_9, __pyx_v_vz);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
  __pyx_t_7 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_10 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = Py_TYPE(__pyx_t_7)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_11(__pyx_t_7); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_10 = __pyx_t_11(__pyx_t_7); if (unlikely(!__pyx_t_10)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_11(__pyx_t_7), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_11 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_11 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L4_unpacking_done:;
  }
</pre><pre class='cython line score-0'>&#xA0;105: </pre>
<pre class='cython line score-0'>&#xA0;106:     <span class="c"># upper boundary</span></pre>
<pre class='cython line score-80' onclick='toggleDiv(this)'>+107:     <span class="n">f_old</span><span class="p">,</span> <span class="n">Uf</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">sim_params</span><span class="p">[</span><span class="s">&#39;distribution_function_boundarycondition_handle&#39;</span><span class="p">][</span><span class="n">z</span><span class="o">.</span><span class="n">str</span><span class="p">][</span><span class="s">&#39;upper&#39;</span><span class="p">])(</span></pre>
<pre class='cython code score-80'>  __pyx_t_10 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_sim_params, __pyx_n_s_distribution_function_boundaryco);<span class='error_goto'> if (unlikely(__pyx_t_10 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_str);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_10, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_7, __pyx_n_s_upper);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_Globals</span>();<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_10 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  if (__pyx_v_Uf) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_Uf, __pyx_v_Uf) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_charge) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_charge, __pyx_v_charge) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_f_k) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_f_k, __pyx_v_f_k) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_f_old) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_f_old, __pyx_v_f_old) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_k) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_k, __pyx_v_k) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_sim_params) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_sim_params, __pyx_v_sim_params) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_vz) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_vz, __pyx_v_vz) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_z) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_z, __pyx_v_z) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_10);
  __pyx_t_2 = 0;
  __pyx_t_7 = 0;
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_eval, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_f_old, __pyx_t_10);
  __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_Uf, __pyx_t_8);
  __pyx_t_8 = 0;
</pre><pre class='cython line score-0'>&#xA0;108:                                               <span class="n">f_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;109:                                               <span class="n">Uf</span><span class="p">,</span></pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+110:                                               <span class="n">z</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:],</span></pre>
<pre class='cython code score-30'>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
/* … */
  __pyx_slice__9 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_slice__9);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_slice__10);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_6, __pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_slice__10 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__10);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+111:                                               <span class="n">vz</span><span class="o">.</span><span class="n">prepointmesh</span><span class="p">,</span></pre>
<pre class='cython code score-2'>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_prepointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+112:                                               <span class="n">vz</span><span class="o">.</span><span class="n">prepointvaluemesh</span><span class="p">,</span></pre>
<pre class='cython code score-2'>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_prepointvaluemesh);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+113:                                               <span class="n">z</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">vz</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">charge</span><span class="p">,</span></pre>
<pre class='cython code score-4'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_N);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_N);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class='cython line score-0'>&#xA0;114:                                               <span class="n">sim_params</span><span class="p">,</span></pre>
<pre class='cython line score-86' onclick='toggleDiv(this)'>+115:                                               <span class="n">z</span><span class="p">,</span> <span class="n">vz</span><span class="p">)</span></pre>
<pre class='cython code score-86'>  __pyx_t_3 = NULL;
  __pyx_t_9 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
      __pyx_t_9 = 1;
    }
  }
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(12+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_old);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f_old);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_9, __pyx_v_f_old);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Uf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Uf);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_9, __pyx_v_Uf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_9, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 3+__pyx_t_9, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 4+__pyx_t_9, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 5+__pyx_t_9, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 6+__pyx_t_9, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 7+__pyx_t_9, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_charge);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_charge);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 8+__pyx_t_9, __pyx_v_charge);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sim_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sim_params);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 9+__pyx_t_9, __pyx_v_sim_params);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_z);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_z);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 10+__pyx_t_9, __pyx_v_z);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vz);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vz);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 11+__pyx_t_9, __pyx_v_vz);
  __pyx_t_2 = 0;
  __pyx_t_7 = 0;
  __pyx_t_6 = 0;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
    #else
    __pyx_t_10 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_10 = __pyx_t_11(__pyx_t_4); if (unlikely(!__pyx_t_10)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    index = 1; __pyx_t_8 = __pyx_t_11(__pyx_t_4); if (unlikely(!__pyx_t_8)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_11(__pyx_t_4), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_11 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_11 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L6_unpacking_done:;
  }
</pre><pre class='cython line score-0'>&#xA0;116: </pre>
<pre class='cython line score-0'>&#xA0;117: </pre>
<pre class='cython line score-0'>&#xA0;118:     <span class="c"># this orchestrator will be called if the distribution function boundary conditions are</span></pre>
<pre class='cython line score-0'>&#xA0;119:     <span class="c">#</span></pre>
<pre class='cython line score-0'>&#xA0;120:     <span class="c">#    (1) absorbing</span></pre>
<pre class='cython line score-0'>&#xA0;121:     <span class="c">#    (2) collector</span></pre>
<pre class='cython line score-0'>&#xA0;122:     <span class="c">#</span></pre>
<pre class='cython line score-0'>&#xA0;123:     <span class="c"># these boundary conditions remove particles from the distribution function and eithier</span></pre>
<pre class='cython line score-0'>&#xA0;124:     <span class="c"># absorbs them at walls with zero further influece (i.e. such a condition would be specified for</span></pre>
<pre class='cython line score-0'>&#xA0;125:     <span class="c"># biased electrodes at a constant voltage), or their charge is collected and then asborbed.</span></pre>
<pre class='cython line score-0'>&#xA0;126:     <span class="c"># the routine absorbs (zeroes out the density) and sets their postpoints to correspond</span></pre>
<pre class='cython line score-0'>&#xA0;127:     <span class="c"># to such a wall where they are absorbed/collected. The remap procedure in the parent</span></pre>
<pre class='cython line score-0'>&#xA0;128:     <span class="c"># function (convect_configuration or convect_velocity) then remaps these zeroed entries</span></pre>
<pre class='cython line score-0'>&#xA0;129:     <span class="c"># to the gridpoint corresponding to the wall, which contribute zero. There is no numerical</span></pre>
<pre class='cython line score-0'>&#xA0;130:     <span class="c"># need to change the velocity postpoints as the entries of the distribution themselves which</span></pre>
<pre class='cython line score-0'>&#xA0;131:     <span class="c"># are zero do not affect the distribution function hereafter, so its velocity postpoints</span></pre>
<pre class='cython line score-0'>&#xA0;132:     <span class="c"># are inconsequential.</span></pre>
<pre class='cython line score-0'>&#xA0;133:     <span class="c">#</span></pre>
<pre class='cython line score-33' onclick='toggleDiv(this)'>+134:     <span class="n">vz</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">vz</span><span class="o">.</span><span class="n">prepointmesh</span></pre>
<pre class='cython code score-33'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_prepointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
/* … */
  __pyx_slice__11 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__11);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_slice__11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__12);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_slice__12);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_8, __pyx_t_10, __pyx_t_1) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_slice__12 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__12);
</pre><pre class='cython line score-0'>&#xA0;135: </pre>
<pre class='cython line score-12' onclick='toggleDiv(this)'>+136:     <span class="k">return</span> <span class="n">f_k</span><span class="p">,</span> <span class="n">f_old</span><span class="p">,</span> <span class="n">Uf</span></pre>
<pre class='cython code score-12'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_f_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_old);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f_old);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_f_old);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Uf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Uf);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_v_Uf);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;137: </pre>
<pre class='cython line score-113' onclick='toggleDiv(this)'>+138: <span class="k">def</span> <span class="nf">symmetric</span><span class="p">(</span><span class="n">f_k</span><span class="p">,</span></pre>
<pre class='cython code score-113'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_5symmetric(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6DECSKS_3lib_18boundaryconditions_4symmetric[] = "orchestrates applying nonperiodic boundary conditions\n    to the array w with total active grid points Nw. Nonperiodic\n    boundary conditions require handling both left and right\n    boundaries\n\n    inputs:\n    f_old -- (ndarray, ndim=2) density array\n    z -- (instance) phase space variable being evolved\n\n    outputs:\n    f_old -- (ndarray, ndim=2) density with both left and right\n             nonperiodic BCs enforced\n    Uf -- (ndarray, ndim=2) high order fluxes with both left and right\n             nonperiodic BCs enforced\n\n\n    z returned (no changes) for symmetry with periodic routine above\n    ";
static PyMethodDef __pyx_mdef_6DECSKS_3lib_18boundaryconditions_5symmetric = {"symmetric", (PyCFunction)__pyx_pw_6DECSKS_3lib_18boundaryconditions_5symmetric, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6DECSKS_3lib_18boundaryconditions_4symmetric};
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_5symmetric(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_f_k = 0;
  PyObject *__pyx_v_f_old = 0;
  PyObject *__pyx_v_Uf = 0;
  PyObject *__pyx_v_z = 0;
  PyObject *__pyx_v_vz = 0;
  PyObject *__pyx_v_sim_params = 0;
  PyObject *__pyx_v_charge = 0;
  PyObject *__pyx_v_k = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("symmetric (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_f_k,&amp;__pyx_n_s_f_old,&amp;__pyx_n_s_Uf,&amp;__pyx_n_s_z,&amp;__pyx_n_s_vz,&amp;__pyx_n_s_sim_params,&amp;__pyx_n_s_charge,&amp;__pyx_n_s_k,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    values[7] = ((PyObject *)__pyx_int_0);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_k)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_old)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric", 0, 7, 8, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Uf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric", 0, 7, 8, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric", 0, 7, 8, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric", 0, 7, 8, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sim_params)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric", 0, 7, 8, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_charge)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric", 0, 7, 8, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_k);
          if (value) { values[7] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "symmetric") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_f_k = values[0];
    __pyx_v_f_old = values[1];
    __pyx_v_Uf = values[2];
    __pyx_v_z = values[3];
    __pyx_v_vz = values[4];
    __pyx_v_sim_params = values[5];
    __pyx_v_charge = values[6];
    __pyx_v_k = values[7];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric", 0, 7, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.symmetric", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6DECSKS_3lib_18boundaryconditions_4symmetric(__pyx_self, __pyx_v_f_k, __pyx_v_f_old, __pyx_v_Uf, __pyx_v_z, __pyx_v_vz, __pyx_v_sim_params, __pyx_v_charge, __pyx_v_k);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_18boundaryconditions_4symmetric(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_f_k, PyObject *__pyx_v_f_old, PyObject *__pyx_v_Uf, PyObject *__pyx_v_z, PyObject *__pyx_v_vz, PyObject *__pyx_v_sim_params, PyObject *__pyx_v_charge, PyObject *__pyx_v_k) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("symmetric", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_old);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Uf);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.symmetric", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_f_k);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_f_old);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Uf);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__41 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_f_k, __pyx_n_s_f_old, __pyx_n_s_Uf, __pyx_n_s_z, __pyx_n_s_vz, __pyx_n_s_sim_params, __pyx_n_s_charge, __pyx_n_s_k);<span class='error_goto'> if (unlikely(!__pyx_tuple__41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__41);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__41);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_18boundaryconditions_5symmetric, NULL, __pyx_n_s_DECSKS_lib_boundaryconditions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_symmetric, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__42 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_symmetric, 138, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;139:               <span class="n">f_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;140:               <span class="n">Uf</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;141:               <span class="n">z</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;142:               <span class="n">vz</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;143:               <span class="n">sim_params</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;144:               <span class="n">charge</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;145:               <span class="n">k</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython line score-0'>&#xA0;146:               <span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;147:     <span class="sd">&quot;&quot;&quot;orchestrates applying nonperiodic boundary conditions</span></pre>
<pre class='cython line score-0'>&#xA0;148: <span class="sd">    to the array w with total active grid points Nw. Nonperiodic</span></pre>
<pre class='cython line score-0'>&#xA0;149: <span class="sd">    boundary conditions require handling both left and right</span></pre>
<pre class='cython line score-0'>&#xA0;150: <span class="sd">    boundaries</span></pre>
<pre class='cython line score-0'>&#xA0;151: </pre>
<pre class='cython line score-0'>&#xA0;152: <span class="sd">    inputs:</span></pre>
<pre class='cython line score-0'>&#xA0;153: <span class="sd">    f_old -- (ndarray, ndim=2) density array</span></pre>
<pre class='cython line score-0'>&#xA0;154: <span class="sd">    z -- (instance) phase space variable being evolved</span></pre>
<pre class='cython line score-0'>&#xA0;155: </pre>
<pre class='cython line score-0'>&#xA0;156: <span class="sd">    outputs:</span></pre>
<pre class='cython line score-0'>&#xA0;157: <span class="sd">    f_old -- (ndarray, ndim=2) density with both left and right</span></pre>
<pre class='cython line score-0'>&#xA0;158: <span class="sd">             nonperiodic BCs enforced</span></pre>
<pre class='cython line score-0'>&#xA0;159: <span class="sd">    Uf -- (ndarray, ndim=2) high order fluxes with both left and right</span></pre>
<pre class='cython line score-0'>&#xA0;160: <span class="sd">             nonperiodic BCs enforced</span></pre>
<pre class='cython line score-0'>&#xA0;161: </pre>
<pre class='cython line score-0'>&#xA0;162: </pre>
<pre class='cython line score-0'>&#xA0;163: <span class="sd">    z returned (no changes) for symmetry with periodic routine above</span></pre>
<pre class='cython line score-0'>&#xA0;164: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;165: </pre>
<pre class='cython line score-0'>&#xA0;166:     <span class="c"># lower boundary</span></pre>
<pre class='cython line score-81' onclick='toggleDiv(this)'>+167:     <span class="n">f_k</span><span class="p">,</span> <span class="n">f_old</span><span class="p">,</span> <span class="n">Uf</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">sim_params</span><span class="p">[</span><span class="s">&#39;distribution_function_boundarycondition_handle&#39;</span><span class="p">][</span><span class="n">z</span><span class="o">.</span><span class="n">str</span><span class="p">][</span><span class="s">&#39;lower&#39;</span><span class="p">])(</span><span class="n">f_k</span><span class="p">,</span></pre>
<pre class='cython code score-81'>  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_sim_params, __pyx_n_s_distribution_function_boundaryco);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_str);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_4, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_Globals</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (__pyx_v_Uf) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_Uf, __pyx_v_Uf) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_charge) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_charge, __pyx_v_charge) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_f_k) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_f_k, __pyx_v_f_k) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_f_old) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_f_old, __pyx_v_f_old) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_k) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_k, __pyx_v_k) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_sim_params) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_sim_params, __pyx_v_sim_params) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_vz) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_vz, __pyx_v_vz) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_z) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_z, __pyx_v_z) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_2);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_eval, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_f_k, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_f_old, __pyx_t_11);
  __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_Uf, __pyx_t_8);
  __pyx_t_8 = 0;
</pre><pre class='cython line score-0'>&#xA0;168:                                                                                                    <span class="n">f_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;169:                                                                                                    <span class="n">Uf</span><span class="p">,</span></pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+170:                                                                                                    <span class="n">z</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:],</span></pre>
<pre class='cython code score-30'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* … */
  __pyx_slice__13 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__13);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__13);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_slice__13);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__14);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_slice__14);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_slice__14 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__14);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+171:                                                                                                    <span class="n">vz</span><span class="o">.</span><span class="n">prepointmesh</span><span class="p">,</span></pre>
<pre class='cython code score-2'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_prepointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class='cython line score-30' onclick='toggleDiv(this)'>+172:                                                                                                    <span class="n">vz</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:],</span></pre>
<pre class='cython code score-30'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* … */
  __pyx_slice__15 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__15);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__15);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_slice__15);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__16);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_slice__16);
  __pyx_t_7 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_slice__16 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__16);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+173:                                                                                                    <span class="n">vz</span><span class="o">.</span><span class="n">prepointvaluemesh</span><span class="p">,</span></pre>
<pre class='cython code score-2'>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_prepointvaluemesh);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+174:                                                                                                    <span class="n">z</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">vz</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span></pre>
<pre class='cython code score-4'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_N);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_N);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
</pre><pre class='cython line score-0'>&#xA0;175:                                                                                                    <span class="n">charge</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;176:                                                                                                    <span class="n">sim_params</span><span class="p">,</span></pre>
<pre class='cython line score-93' onclick='toggleDiv(this)'>+177:                                                                                                    <span class="n">z</span><span class="p">,</span> <span class="n">vz</span><span class="p">)</span></pre>
<pre class='cython code score-93'>  __pyx_t_9 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_10 = 1;
    }
  }
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(14+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  if (__pyx_t_9) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_10, __pyx_v_f_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_old);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f_old);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_10, __pyx_v_f_old);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Uf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Uf);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2+__pyx_t_10, __pyx_v_Uf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 3+__pyx_t_10, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 4+__pyx_t_10, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 5+__pyx_t_10, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 6+__pyx_t_10, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 7+__pyx_t_10, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 8+__pyx_t_10, __pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 9+__pyx_t_10, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_charge);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_charge);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 10+__pyx_t_10, __pyx_v_charge);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sim_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sim_params);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 11+__pyx_t_10, __pyx_v_sim_params);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_z);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_z);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 12+__pyx_t_10, __pyx_v_z);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vz);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vz);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 13+__pyx_t_10, __pyx_v_vz);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_7 = 0;
  __pyx_t_6 = 0;
  __pyx_t_5 = 0;
  __pyx_t_8 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 3)) {
      if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_12(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_11 = __pyx_t_12(__pyx_t_5); if (unlikely(!__pyx_t_11)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    index = 2; __pyx_t_8 = __pyx_t_12(__pyx_t_5); if (unlikely(!__pyx_t_8)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_5), 3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_12 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L4_unpacking_done:;
  }
</pre><pre class='cython line score-0'>&#xA0;178: </pre>
<pre class='cython line score-0'>&#xA0;179: </pre>
<pre class='cython line score-0'>&#xA0;180:     <span class="c"># upper boundary</span></pre>
<pre class='cython line score-80' onclick='toggleDiv(this)'>+181:     <span class="n">f_old</span><span class="p">,</span> <span class="n">Uf</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">sim_params</span><span class="p">[</span><span class="s">&#39;distribution_function_boundarycondition_handle&#39;</span><span class="p">][</span><span class="n">z</span><span class="o">.</span><span class="n">str</span><span class="p">][</span><span class="s">&#39;upper&#39;</span><span class="p">])(</span></pre>
<pre class='cython code score-80'>  __pyx_t_8 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_sim_params, __pyx_n_s_distribution_function_boundaryco);<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_str);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_8, __pyx_t_11);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_2, __pyx_n_s_upper);<span class='error_goto'> if (unlikely(__pyx_t_11 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Globals</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (__pyx_v_Uf) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_Uf, __pyx_v_Uf) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_charge) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_charge, __pyx_v_charge) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_f_k) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_f_k, __pyx_v_f_k) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_f_old) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_f_old, __pyx_v_f_old) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_k) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_k, __pyx_v_k) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_sim_params) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_sim_params, __pyx_v_sim_params) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_vz) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_vz, __pyx_v_vz) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  if (__pyx_v_z) {
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_z, __pyx_v_z) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_8);
  __pyx_t_11 = 0;
  __pyx_t_2 = 0;
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_eval, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_f_old, __pyx_t_8);
  __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_Uf, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;182:                                               <span class="n">f_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;183:                                               <span class="n">Uf</span><span class="p">,</span></pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+184:                                               <span class="n">z</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:],</span></pre>
<pre class='cython code score-30'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* … */
  __pyx_slice__17 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__17);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__17);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_slice__17);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__18);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_slice__18);
  __pyx_t_11 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_11 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_slice__18 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__18);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+185:                                               <span class="n">vz</span><span class="o">.</span><span class="n">prepointmesh</span><span class="p">,</span></pre>
<pre class='cython code score-2'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_prepointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+186:                                               <span class="n">vz</span><span class="o">.</span><span class="n">prepointvaluemesh</span><span class="p">,</span></pre>
<pre class='cython code score-2'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_prepointvaluemesh);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+187:                                               <span class="n">z</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">vz</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">charge</span><span class="p">,</span></pre>
<pre class='cython code score-4'>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_N);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_N);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class='cython line score-0'>&#xA0;188:                                               <span class="n">sim_params</span><span class="p">,</span></pre>
<pre class='cython line score-86' onclick='toggleDiv(this)'>+189:                                               <span class="n">z</span><span class="p">,</span> <span class="n">vz</span><span class="p">)</span></pre>
<pre class='cython code score-86'>  __pyx_t_4 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_10 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(12+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_4) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_old);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f_old);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_10, __pyx_v_f_old);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Uf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Uf);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_10, __pyx_v_Uf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2+__pyx_t_10, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3+__pyx_t_10, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 4+__pyx_t_10, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 5+__pyx_t_10, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 6+__pyx_t_10, __pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 7+__pyx_t_10, __pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_charge);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_charge);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 8+__pyx_t_10, __pyx_v_charge);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sim_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sim_params);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 9+__pyx_t_10, __pyx_v_sim_params);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_z);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_z);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 10+__pyx_t_10, __pyx_v_z);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vz);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vz);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 11+__pyx_t_10, __pyx_v_vz);
  __pyx_t_11 = 0;
  __pyx_t_2 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
  __pyx_t_7 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = Py_TYPE(__pyx_t_7)-&gt;tp_iternext;
    index = 0; __pyx_t_8 = __pyx_t_12(__pyx_t_7); if (unlikely(!__pyx_t_8)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    index = 1; __pyx_t_3 = __pyx_t_12(__pyx_t_7); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_7), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_12 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L6_unpacking_done:;
  }
</pre><pre class='cython line score-0'>&#xA0;190: </pre>
<pre class='cython line score-0'>&#xA0;191: </pre>
<pre class='cython line score-0'>&#xA0;192:     <span class="c"># vz.postpointmesh[k,:,:] to be set in boundaryconditions.symmetric_lower_boundary</span></pre>
<pre class='cython line score-0'>&#xA0;193: </pre>
<pre class='cython line score-12' onclick='toggleDiv(this)'>+194:     <span class="k">return</span> <span class="n">f_k</span><span class="p">,</span> <span class="n">f_old</span><span class="p">,</span> <span class="n">Uf</span></pre>
<pre class='cython code score-12'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_k);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f_k);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_f_k);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f_old);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f_old);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_f_old);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Uf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Uf);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_v_Uf);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;195: </pre>
<pre class='cython line score-0'>&#xA0;196: <span class="c"># CYTHON METHODS</span></pre>
<pre class='cython line score-0'>&#xA0;197: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-190' onclick='toggleDiv(this)'>+198: <span class="k">def</span> <span class="nf">absorbing_lower_boundary</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f_old</span><span class="p">,</span></pre>
<pre class='cython code score-190'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_7absorbing_lower_boundary(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6DECSKS_3lib_18boundaryconditions_7absorbing_lower_boundary = {"absorbing_lower_boundary", (PyCFunction)__pyx_pw_6DECSKS_3lib_18boundaryconditions_7absorbing_lower_boundary, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_7absorbing_lower_boundary(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_f_old = 0;
  PyArrayObject *__pyx_v_Uf_old = 0;
  PyArrayObject *__pyx_v_zpostpointmesh = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointmesh = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointvaluemesh = 0;
  int __pyx_v_Nz;
  int __pyx_v_Nvz;
  int __pyx_v_k;
  CYTHON_UNUSED int __pyx_v_charge;
  CYTHON_UNUSED PyObject *__pyx_v_sim_params = 0;
  PyObject *__pyx_v_z = 0;
  CYTHON_UNUSED PyObject *__pyx_v_vz = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("absorbing_lower_boundary (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_f_old,&amp;__pyx_n_s_Uf_old,&amp;__pyx_n_s_zpostpointmesh,&amp;__pyx_n_s_vzprepointmesh,&amp;__pyx_n_s_vzprepointvaluemesh,&amp;__pyx_n_s_Nz,&amp;__pyx_n_s_Nvz,&amp;__pyx_n_s_k,&amp;__pyx_n_s_charge,&amp;__pyx_n_s_sim_params,&amp;__pyx_n_s_z,&amp;__pyx_n_s_vz,0};
    PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_old)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Uf_old)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_lower_boundary", 1, 12, 12, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_zpostpointmesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_lower_boundary", 1, 12, 12, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vzprepointmesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_lower_boundary", 1, 12, 12, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vzprepointvaluemesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_lower_boundary", 1, 12, 12, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Nz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_lower_boundary", 1, 12, 12, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Nvz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_lower_boundary", 1, 12, 12, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  7:
        if (likely((values[7] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_k)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_lower_boundary", 1, 12, 12, 7); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  8:
        if (likely((values[8] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_charge)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_lower_boundary", 1, 12, 12, 8); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  9:
        if (likely((values[9] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sim_params)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_lower_boundary", 1, 12, 12, 9); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case 10:
        if (likely((values[10] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_lower_boundary", 1, 12, 12, 10); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case 11:
        if (likely((values[11] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_lower_boundary", 1, 12, 12, 11); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "absorbing_lower_boundary") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 12) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
    }
    __pyx_v_f_old = ((PyArrayObject *)values[0]);
    __pyx_v_Uf_old = ((PyArrayObject *)values[1]);
    __pyx_v_zpostpointmesh = ((PyArrayObject *)values[2]);
    __pyx_v_vzprepointmesh = ((PyArrayObject *)values[3]);
    __pyx_v_vzprepointvaluemesh = ((PyArrayObject *)values[4]);
    __pyx_v_Nz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_Nz == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_Nvz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_Nvz == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_k = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]);<span class='error_goto'> if (unlikely((__pyx_v_k == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_charge = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]);<span class='error_goto'> if (unlikely((__pyx_v_charge == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_sim_params = values[9];
    __pyx_v_z = values[10];
    __pyx_v_vz = values[11];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_lower_boundary", 1, 12, 12, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.absorbing_lower_boundary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_f_old), __pyx_ptype_5numpy_ndarray, 1, "f_old", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Uf_old), __pyx_ptype_5numpy_ndarray, 1, "Uf_old", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zpostpointmesh), __pyx_ptype_5numpy_ndarray, 1, "zpostpointmesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vzprepointmesh), __pyx_ptype_5numpy_ndarray, 1, "vzprepointmesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vzprepointvaluemesh), __pyx_ptype_5numpy_ndarray, 1, "vzprepointvaluemesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_18boundaryconditions_6absorbing_lower_boundary(__pyx_self, __pyx_v_f_old, __pyx_v_Uf_old, __pyx_v_zpostpointmesh, __pyx_v_vzprepointmesh, __pyx_v_vzprepointvaluemesh, __pyx_v_Nz, __pyx_v_Nvz, __pyx_v_k, __pyx_v_charge, __pyx_v_sim_params, __pyx_v_z, __pyx_v_vz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_18boundaryconditions_6absorbing_lower_boundary(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_f_old, PyArrayObject *__pyx_v_Uf_old, PyArrayObject *__pyx_v_zpostpointmesh, CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointmesh, CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointvaluemesh, int __pyx_v_Nz, int __pyx_v_Nvz, int __pyx_v_k, CYTHON_UNUSED int __pyx_v_charge, CYTHON_UNUSED PyObject *__pyx_v_sim_params, PyObject *__pyx_v_z, CYTHON_UNUSED PyObject *__pyx_v_vz) {
  int __pyx_v_i;
  int __pyx_v_j;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_old;
  __Pyx_Buffer __pyx_pybuffer_Uf_old;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f_old;
  __Pyx_Buffer __pyx_pybuffer_f_old;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vzprepointmesh;
  __Pyx_Buffer __pyx_pybuffer_vzprepointmesh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vzprepointvaluemesh;
  __Pyx_Buffer __pyx_pybuffer_vzprepointvaluemesh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zpostpointmesh;
  __Pyx_Buffer __pyx_pybuffer_zpostpointmesh;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("absorbing_lower_boundary", 0);
  __pyx_pybuffer_f_old.pybuffer.buf = NULL;
  __pyx_pybuffer_f_old.refcount = 0;
  __pyx_pybuffernd_f_old.data = NULL;
  __pyx_pybuffernd_f_old.rcbuffer = &amp;__pyx_pybuffer_f_old;
  __pyx_pybuffer_Uf_old.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_old.refcount = 0;
  __pyx_pybuffernd_Uf_old.data = NULL;
  __pyx_pybuffernd_Uf_old.rcbuffer = &amp;__pyx_pybuffer_Uf_old;
  __pyx_pybuffer_zpostpointmesh.pybuffer.buf = NULL;
  __pyx_pybuffer_zpostpointmesh.refcount = 0;
  __pyx_pybuffernd_zpostpointmesh.data = NULL;
  __pyx_pybuffernd_zpostpointmesh.rcbuffer = &amp;__pyx_pybuffer_zpostpointmesh;
  __pyx_pybuffer_vzprepointmesh.pybuffer.buf = NULL;
  __pyx_pybuffer_vzprepointmesh.refcount = 0;
  __pyx_pybuffernd_vzprepointmesh.data = NULL;
  __pyx_pybuffernd_vzprepointmesh.rcbuffer = &amp;__pyx_pybuffer_vzprepointmesh;
  __pyx_pybuffer_vzprepointvaluemesh.pybuffer.buf = NULL;
  __pyx_pybuffer_vzprepointvaluemesh.refcount = 0;
  __pyx_pybuffernd_vzprepointvaluemesh.data = NULL;
  __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer = &amp;__pyx_pybuffer_vzprepointvaluemesh;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_f_old, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_f_old.diminfo[0].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f_old.diminfo[0].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f_old.diminfo[1].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f_old.diminfo[1].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Uf_old, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Uf_old.diminfo[0].strides = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_old.diminfo[0].shape = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_old.diminfo[1].strides = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_old.diminfo[1].shape = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zpostpointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzprepointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vzprepointmesh.diminfo[0].strides = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzprepointmesh.diminfo[0].shape = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzprepointmesh.diminfo[1].strides = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzprepointmesh.diminfo[1].shape = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzprepointvaluemesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].strides = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].shape = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].strides = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].shape = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.absorbing_lower_boundary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__43 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_f_old, __pyx_n_s_Uf_old, __pyx_n_s_zpostpointmesh, __pyx_n_s_vzprepointmesh, __pyx_n_s_vzprepointvaluemesh, __pyx_n_s_Nz, __pyx_n_s_Nvz, __pyx_n_s_k, __pyx_n_s_charge, __pyx_n_s_sim_params, __pyx_n_s_z, __pyx_n_s_vz, __pyx_n_s_i, __pyx_n_s_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__43)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__43);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__43);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_18boundaryconditions_7absorbing_lower_boundary, NULL, __pyx_n_s_DECSKS_lib_boundaryconditions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_absorbing_lower_boundary, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__44 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(12, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_absorbing_lower_boundary, 198, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__44)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;199:                               <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;200:                               <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">zpostpointmesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;201:                               <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">vzprepointmesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;202:                               <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">vzprepointvaluemesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;203:                               <span class="nb">int</span> <span class="n">Nz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">Nvz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">charge</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;204:                               <span class="n">sim_params</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;205:                               <span class="n">z</span><span class="p">,</span> <span class="n">vz</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;206: </pre>
<pre class='cython line score-0'>&#xA0;207:     <span class="c"># vars here are typed as C data types to minimize python interaction</span></pre>
<pre class='cython line score-0'>&#xA0;208:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+209:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_Nz;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+210:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nvz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_Nvz;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_j = __pyx_t_4;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+211:             <span class="k">if</span> <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_5 = __pyx_v_i;
      __pyx_t_6 = __pyx_v_j;
      if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
      if (__pyx_t_6 &lt; 0) __pyx_t_6 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
      __pyx_t_7 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_6, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides)) &lt;= 0) != 0);
      if (__pyx_t_7) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+212:                 <span class="n">f_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>        __pyx_t_8 = __pyx_v_i;
        __pyx_t_9 = __pyx_v_j;
        if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_pybuffernd_f_old.diminfo[0].shape;
        if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_pybuffernd_f_old.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_f_old.diminfo[0].strides, __pyx_t_9, __pyx_pybuffernd_f_old.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+213:                 <span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>        __pyx_t_10 = __pyx_v_i;
        __pyx_t_11 = __pyx_v_j;
        if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
        if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Uf_old.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+214:                 <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span> <span class="c"># set postpoint at the absorber</span></pre>
<pre class='cython code score-0'>        __pyx_t_12 = __pyx_v_i;
        __pyx_t_13 = __pyx_v_j;
        if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
        if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides) = 0;
        goto __pyx_L7;
      }
      __pyx_L7:;
    }
  }
</pre><pre class='cython line score-0'>&#xA0;215: </pre>
<pre class='cython line score-0'>&#xA0;216:     <span class="c"># permanently copy to instance attribute</span></pre>
<pre class='cython line score-31' onclick='toggleDiv(this)'>+217:     <span class="n">z</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">zpostpointmesh</span></pre>
<pre class='cython code score-31'>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
/* … */
  __pyx_slice__19 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__19);
  __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__19);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1, __pyx_slice__19);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__20);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 2, __pyx_slice__20);
  __pyx_t_15 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_14, __pyx_t_16, ((PyObject *)__pyx_v_zpostpointmesh)) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  __pyx_slice__20 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__20);
</pre><pre class='cython line score-0'>&#xA0;218: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+219:     <span class="k">return</span> <span class="n">f_old</span><span class="p">,</span> <span class="n">Uf_old</span></pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_f_old));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_f_old));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, ((PyObject *)__pyx_v_f_old));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_old));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_old));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1, ((PyObject *)__pyx_v_Uf_old));
  __pyx_r = __pyx_t_16;
  __pyx_t_16 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;220: </pre>
<pre class='cython line score-0'>&#xA0;221: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-190' onclick='toggleDiv(this)'>+222: <span class="k">def</span> <span class="nf">absorbing_upper_boundary</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f_old</span><span class="p">,</span></pre>
<pre class='cython code score-190'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_9absorbing_upper_boundary(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6DECSKS_3lib_18boundaryconditions_9absorbing_upper_boundary = {"absorbing_upper_boundary", (PyCFunction)__pyx_pw_6DECSKS_3lib_18boundaryconditions_9absorbing_upper_boundary, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_9absorbing_upper_boundary(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_f_old = 0;
  PyArrayObject *__pyx_v_Uf_old = 0;
  PyArrayObject *__pyx_v_zpostpointmesh = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointmesh = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointvaluemesh = 0;
  int __pyx_v_Nz;
  int __pyx_v_Nvz;
  int __pyx_v_k;
  CYTHON_UNUSED int __pyx_v_charge;
  CYTHON_UNUSED PyObject *__pyx_v_sim_params = 0;
  PyObject *__pyx_v_z = 0;
  CYTHON_UNUSED PyObject *__pyx_v_vz = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("absorbing_upper_boundary (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_f_old,&amp;__pyx_n_s_Uf_old,&amp;__pyx_n_s_zpostpointmesh,&amp;__pyx_n_s_vzprepointmesh,&amp;__pyx_n_s_vzprepointvaluemesh,&amp;__pyx_n_s_Nz,&amp;__pyx_n_s_Nvz,&amp;__pyx_n_s_k,&amp;__pyx_n_s_charge,&amp;__pyx_n_s_sim_params,&amp;__pyx_n_s_z,&amp;__pyx_n_s_vz,0};
    PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_old)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Uf_old)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_upper_boundary", 1, 12, 12, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_zpostpointmesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_upper_boundary", 1, 12, 12, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vzprepointmesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_upper_boundary", 1, 12, 12, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vzprepointvaluemesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_upper_boundary", 1, 12, 12, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Nz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_upper_boundary", 1, 12, 12, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Nvz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_upper_boundary", 1, 12, 12, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  7:
        if (likely((values[7] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_k)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_upper_boundary", 1, 12, 12, 7); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  8:
        if (likely((values[8] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_charge)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_upper_boundary", 1, 12, 12, 8); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  9:
        if (likely((values[9] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sim_params)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_upper_boundary", 1, 12, 12, 9); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case 10:
        if (likely((values[10] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_upper_boundary", 1, 12, 12, 10); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case 11:
        if (likely((values[11] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_upper_boundary", 1, 12, 12, 11); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "absorbing_upper_boundary") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 12) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
    }
    __pyx_v_f_old = ((PyArrayObject *)values[0]);
    __pyx_v_Uf_old = ((PyArrayObject *)values[1]);
    __pyx_v_zpostpointmesh = ((PyArrayObject *)values[2]);
    __pyx_v_vzprepointmesh = ((PyArrayObject *)values[3]);
    __pyx_v_vzprepointvaluemesh = ((PyArrayObject *)values[4]);
    __pyx_v_Nz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_Nz == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_Nvz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_Nvz == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_k = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]);<span class='error_goto'> if (unlikely((__pyx_v_k == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_charge = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]);<span class='error_goto'> if (unlikely((__pyx_v_charge == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_sim_params = values[9];
    __pyx_v_z = values[10];
    __pyx_v_vz = values[11];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("absorbing_upper_boundary", 1, 12, 12, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.absorbing_upper_boundary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_f_old), __pyx_ptype_5numpy_ndarray, 1, "f_old", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Uf_old), __pyx_ptype_5numpy_ndarray, 1, "Uf_old", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zpostpointmesh), __pyx_ptype_5numpy_ndarray, 1, "zpostpointmesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vzprepointmesh), __pyx_ptype_5numpy_ndarray, 1, "vzprepointmesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vzprepointvaluemesh), __pyx_ptype_5numpy_ndarray, 1, "vzprepointvaluemesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_18boundaryconditions_8absorbing_upper_boundary(__pyx_self, __pyx_v_f_old, __pyx_v_Uf_old, __pyx_v_zpostpointmesh, __pyx_v_vzprepointmesh, __pyx_v_vzprepointvaluemesh, __pyx_v_Nz, __pyx_v_Nvz, __pyx_v_k, __pyx_v_charge, __pyx_v_sim_params, __pyx_v_z, __pyx_v_vz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_18boundaryconditions_8absorbing_upper_boundary(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_f_old, PyArrayObject *__pyx_v_Uf_old, PyArrayObject *__pyx_v_zpostpointmesh, CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointmesh, CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointvaluemesh, int __pyx_v_Nz, int __pyx_v_Nvz, int __pyx_v_k, CYTHON_UNUSED int __pyx_v_charge, CYTHON_UNUSED PyObject *__pyx_v_sim_params, PyObject *__pyx_v_z, CYTHON_UNUSED PyObject *__pyx_v_vz) {
  int __pyx_v_i;
  int __pyx_v_j;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_old;
  __Pyx_Buffer __pyx_pybuffer_Uf_old;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f_old;
  __Pyx_Buffer __pyx_pybuffer_f_old;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vzprepointmesh;
  __Pyx_Buffer __pyx_pybuffer_vzprepointmesh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vzprepointvaluemesh;
  __Pyx_Buffer __pyx_pybuffer_vzprepointvaluemesh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zpostpointmesh;
  __Pyx_Buffer __pyx_pybuffer_zpostpointmesh;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("absorbing_upper_boundary", 0);
  __pyx_pybuffer_f_old.pybuffer.buf = NULL;
  __pyx_pybuffer_f_old.refcount = 0;
  __pyx_pybuffernd_f_old.data = NULL;
  __pyx_pybuffernd_f_old.rcbuffer = &amp;__pyx_pybuffer_f_old;
  __pyx_pybuffer_Uf_old.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_old.refcount = 0;
  __pyx_pybuffernd_Uf_old.data = NULL;
  __pyx_pybuffernd_Uf_old.rcbuffer = &amp;__pyx_pybuffer_Uf_old;
  __pyx_pybuffer_zpostpointmesh.pybuffer.buf = NULL;
  __pyx_pybuffer_zpostpointmesh.refcount = 0;
  __pyx_pybuffernd_zpostpointmesh.data = NULL;
  __pyx_pybuffernd_zpostpointmesh.rcbuffer = &amp;__pyx_pybuffer_zpostpointmesh;
  __pyx_pybuffer_vzprepointmesh.pybuffer.buf = NULL;
  __pyx_pybuffer_vzprepointmesh.refcount = 0;
  __pyx_pybuffernd_vzprepointmesh.data = NULL;
  __pyx_pybuffernd_vzprepointmesh.rcbuffer = &amp;__pyx_pybuffer_vzprepointmesh;
  __pyx_pybuffer_vzprepointvaluemesh.pybuffer.buf = NULL;
  __pyx_pybuffer_vzprepointvaluemesh.refcount = 0;
  __pyx_pybuffernd_vzprepointvaluemesh.data = NULL;
  __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer = &amp;__pyx_pybuffer_vzprepointvaluemesh;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_f_old, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_f_old.diminfo[0].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f_old.diminfo[0].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f_old.diminfo[1].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f_old.diminfo[1].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Uf_old, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Uf_old.diminfo[0].strides = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_old.diminfo[0].shape = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_old.diminfo[1].strides = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_old.diminfo[1].shape = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zpostpointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzprepointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vzprepointmesh.diminfo[0].strides = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzprepointmesh.diminfo[0].shape = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzprepointmesh.diminfo[1].strides = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzprepointmesh.diminfo[1].shape = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzprepointvaluemesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].strides = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].shape = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].strides = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].shape = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.absorbing_upper_boundary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__45 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_f_old, __pyx_n_s_Uf_old, __pyx_n_s_zpostpointmesh, __pyx_n_s_vzprepointmesh, __pyx_n_s_vzprepointvaluemesh, __pyx_n_s_Nz, __pyx_n_s_Nvz, __pyx_n_s_k, __pyx_n_s_charge, __pyx_n_s_sim_params, __pyx_n_s_z, __pyx_n_s_vz, __pyx_n_s_i, __pyx_n_s_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__45)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__45);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__45);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_18boundaryconditions_9absorbing_upper_boundary, NULL, __pyx_n_s_DECSKS_lib_boundaryconditions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_absorbing_upper_boundary, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__46 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(12, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__45, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_absorbing_upper_boundary, 222, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__46)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;223:                               <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;224:                               <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">zpostpointmesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;225:                               <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">vzprepointmesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;226:                               <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">vzprepointvaluemesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;227:                               <span class="nb">int</span> <span class="n">Nz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">Nvz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">charge</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;228:                               <span class="n">sim_params</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;229:                               <span class="n">z</span><span class="p">,</span> <span class="n">vz</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;230: </pre>
<pre class='cython line score-0'>&#xA0;231:     <span class="c"># vars here are typed as C data types to minimize python interaction</span></pre>
<pre class='cython line score-0'>&#xA0;232:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+233:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_Nz;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+234:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nvz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_Nvz;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_j = __pyx_t_4;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+235:             <span class="k">if</span> <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Nz</span> <span class="o">-</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_5 = __pyx_v_i;
      __pyx_t_6 = __pyx_v_j;
      if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
      if (__pyx_t_6 &lt; 0) __pyx_t_6 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
      __pyx_t_7 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_6, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides)) &gt;= (__pyx_v_Nz - 1)) != 0);
      if (__pyx_t_7) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+236:                 <span class="n">f_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>        __pyx_t_8 = __pyx_v_i;
        __pyx_t_9 = __pyx_v_j;
        if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_pybuffernd_f_old.diminfo[0].shape;
        if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_pybuffernd_f_old.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_f_old.diminfo[0].strides, __pyx_t_9, __pyx_pybuffernd_f_old.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+237:                 <span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>        __pyx_t_10 = __pyx_v_i;
        __pyx_t_11 = __pyx_v_j;
        if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
        if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Uf_old.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0'>&#xA0;238: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+239:                 <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nz</span> <span class="o">-</span> <span class="mf">1</span> <span class="c"># set postpoint at the absorber</span></pre>
<pre class='cython code score-0'>        __pyx_t_12 = __pyx_v_i;
        __pyx_t_13 = __pyx_v_j;
        if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
        if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides) = (__pyx_v_Nz - 1);
        goto __pyx_L7;
      }
      __pyx_L7:;
    }
  }
</pre><pre class='cython line score-0'>&#xA0;240: </pre>
<pre class='cython line score-0'>&#xA0;241:     <span class="c"># permanently copy to instance attribute</span></pre>
<pre class='cython line score-31' onclick='toggleDiv(this)'>+242:     <span class="n">z</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">zpostpointmesh</span></pre>
<pre class='cython code score-31'>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
/* … */
  __pyx_slice__21 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__21);
  __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__21);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1, __pyx_slice__21);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__22);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 2, __pyx_slice__22);
  __pyx_t_15 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_14, __pyx_t_16, ((PyObject *)__pyx_v_zpostpointmesh)) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  __pyx_slice__22 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__22);
</pre><pre class='cython line score-0'>&#xA0;243: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+244:     <span class="k">return</span> <span class="n">f_old</span><span class="p">,</span> <span class="n">Uf_old</span></pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_f_old));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_f_old));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, ((PyObject *)__pyx_v_f_old));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_old));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_old));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1, ((PyObject *)__pyx_v_Uf_old));
  __pyx_r = __pyx_t_16;
  __pyx_t_16 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;245: </pre>
<pre class='cython line score-0'>&#xA0;246: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-192' onclick='toggleDiv(this)'>+247: <span class="k">def</span> <span class="nf">collector_lower_boundary</span><span class="p">(</span></pre>
<pre class='cython code score-192'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_11collector_lower_boundary(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6DECSKS_3lib_18boundaryconditions_11collector_lower_boundary = {"collector_lower_boundary", (PyCFunction)__pyx_pw_6DECSKS_3lib_18boundaryconditions_11collector_lower_boundary, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_11collector_lower_boundary(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_f_old = 0;
  PyArrayObject *__pyx_v_Uf_old = 0;
  PyArrayObject *__pyx_v_zpostpointmesh = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointmesh = 0;
  PyArrayObject *__pyx_v_vzprepointvaluemesh = 0;
  int __pyx_v_Nz;
  int __pyx_v_Nvz;
  int __pyx_v_k;
  int __pyx_v_charge;
  PyObject *__pyx_v_sim_params = 0;
  PyObject *__pyx_v_z = 0;
  PyObject *__pyx_v_vz = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("collector_lower_boundary (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_f_old,&amp;__pyx_n_s_Uf_old,&amp;__pyx_n_s_zpostpointmesh,&amp;__pyx_n_s_vzprepointmesh,&amp;__pyx_n_s_vzprepointvaluemesh,&amp;__pyx_n_s_Nz,&amp;__pyx_n_s_Nvz,&amp;__pyx_n_s_k,&amp;__pyx_n_s_charge,&amp;__pyx_n_s_sim_params,&amp;__pyx_n_s_z,&amp;__pyx_n_s_vz,0};
    PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_old)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Uf_old)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_lower_boundary", 1, 12, 12, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_zpostpointmesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_lower_boundary", 1, 12, 12, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vzprepointmesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_lower_boundary", 1, 12, 12, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vzprepointvaluemesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_lower_boundary", 1, 12, 12, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Nz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_lower_boundary", 1, 12, 12, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Nvz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_lower_boundary", 1, 12, 12, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  7:
        if (likely((values[7] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_k)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_lower_boundary", 1, 12, 12, 7); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  8:
        if (likely((values[8] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_charge)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_lower_boundary", 1, 12, 12, 8); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  9:
        if (likely((values[9] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sim_params)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_lower_boundary", 1, 12, 12, 9); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case 10:
        if (likely((values[10] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_lower_boundary", 1, 12, 12, 10); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case 11:
        if (likely((values[11] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_lower_boundary", 1, 12, 12, 11); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "collector_lower_boundary") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 12) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
    }
    __pyx_v_f_old = ((PyArrayObject *)values[0]);
    __pyx_v_Uf_old = ((PyArrayObject *)values[1]);
    __pyx_v_zpostpointmesh = ((PyArrayObject *)values[2]);
    __pyx_v_vzprepointmesh = ((PyArrayObject *)values[3]);
    __pyx_v_vzprepointvaluemesh = ((PyArrayObject *)values[4]);
    __pyx_v_Nz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_Nz == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_Nvz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_Nvz == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_k = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]);<span class='error_goto'> if (unlikely((__pyx_v_k == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_charge = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]);<span class='error_goto'> if (unlikely((__pyx_v_charge == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_sim_params = values[9];
    __pyx_v_z = values[10];
    __pyx_v_vz = values[11];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_lower_boundary", 1, 12, 12, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.collector_lower_boundary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_f_old), __pyx_ptype_5numpy_ndarray, 1, "f_old", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Uf_old), __pyx_ptype_5numpy_ndarray, 1, "Uf_old", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zpostpointmesh), __pyx_ptype_5numpy_ndarray, 1, "zpostpointmesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vzprepointmesh), __pyx_ptype_5numpy_ndarray, 1, "vzprepointmesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vzprepointvaluemesh), __pyx_ptype_5numpy_ndarray, 1, "vzprepointvaluemesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_18boundaryconditions_10collector_lower_boundary(__pyx_self, __pyx_v_f_old, __pyx_v_Uf_old, __pyx_v_zpostpointmesh, __pyx_v_vzprepointmesh, __pyx_v_vzprepointvaluemesh, __pyx_v_Nz, __pyx_v_Nvz, __pyx_v_k, __pyx_v_charge, __pyx_v_sim_params, __pyx_v_z, __pyx_v_vz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_18boundaryconditions_10collector_lower_boundary(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_f_old, PyArrayObject *__pyx_v_Uf_old, PyArrayObject *__pyx_v_zpostpointmesh, CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointmesh, PyArrayObject *__pyx_v_vzprepointvaluemesh, int __pyx_v_Nz, int __pyx_v_Nvz, int __pyx_v_k, int __pyx_v_charge, PyObject *__pyx_v_sim_params, PyObject *__pyx_v_z, PyObject *__pyx_v_vz) {
  int __pyx_v_i;
  int __pyx_v_j;
  __pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t __pyx_v_sigma_nk;
  __pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t __pyx_v_vzwidth;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_old;
  __Pyx_Buffer __pyx_pybuffer_Uf_old;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f_old;
  __Pyx_Buffer __pyx_pybuffer_f_old;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vzprepointmesh;
  __Pyx_Buffer __pyx_pybuffer_vzprepointmesh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vzprepointvaluemesh;
  __Pyx_Buffer __pyx_pybuffer_vzprepointvaluemesh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zpostpointmesh;
  __Pyx_Buffer __pyx_pybuffer_zpostpointmesh;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("collector_lower_boundary", 0);
  __pyx_pybuffer_f_old.pybuffer.buf = NULL;
  __pyx_pybuffer_f_old.refcount = 0;
  __pyx_pybuffernd_f_old.data = NULL;
  __pyx_pybuffernd_f_old.rcbuffer = &amp;__pyx_pybuffer_f_old;
  __pyx_pybuffer_Uf_old.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_old.refcount = 0;
  __pyx_pybuffernd_Uf_old.data = NULL;
  __pyx_pybuffernd_Uf_old.rcbuffer = &amp;__pyx_pybuffer_Uf_old;
  __pyx_pybuffer_zpostpointmesh.pybuffer.buf = NULL;
  __pyx_pybuffer_zpostpointmesh.refcount = 0;
  __pyx_pybuffernd_zpostpointmesh.data = NULL;
  __pyx_pybuffernd_zpostpointmesh.rcbuffer = &amp;__pyx_pybuffer_zpostpointmesh;
  __pyx_pybuffer_vzprepointmesh.pybuffer.buf = NULL;
  __pyx_pybuffer_vzprepointmesh.refcount = 0;
  __pyx_pybuffernd_vzprepointmesh.data = NULL;
  __pyx_pybuffernd_vzprepointmesh.rcbuffer = &amp;__pyx_pybuffer_vzprepointmesh;
  __pyx_pybuffer_vzprepointvaluemesh.pybuffer.buf = NULL;
  __pyx_pybuffer_vzprepointvaluemesh.refcount = 0;
  __pyx_pybuffernd_vzprepointvaluemesh.data = NULL;
  __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer = &amp;__pyx_pybuffer_vzprepointvaluemesh;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_f_old, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_f_old.diminfo[0].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f_old.diminfo[0].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f_old.diminfo[1].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f_old.diminfo[1].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Uf_old, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Uf_old.diminfo[0].strides = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_old.diminfo[0].shape = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_old.diminfo[1].strides = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_old.diminfo[1].shape = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zpostpointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzprepointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vzprepointmesh.diminfo[0].strides = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzprepointmesh.diminfo[0].shape = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzprepointmesh.diminfo[1].strides = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzprepointmesh.diminfo[1].shape = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzprepointvaluemesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].strides = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].shape = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].strides = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].shape = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_34);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_35);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_36);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_37);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.collector_lower_boundary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__47 = <span class='py_c_api'>PyTuple_Pack</span>(16, __pyx_n_s_f_old, __pyx_n_s_Uf_old, __pyx_n_s_zpostpointmesh, __pyx_n_s_vzprepointmesh, __pyx_n_s_vzprepointvaluemesh, __pyx_n_s_Nz, __pyx_n_s_Nvz, __pyx_n_s_k, __pyx_n_s_charge, __pyx_n_s_sim_params, __pyx_n_s_z, __pyx_n_s_vz, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_sigma_nk, __pyx_n_s_vzwidth);<span class='error_goto'> if (unlikely(!__pyx_tuple__47)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__47);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__47);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_18boundaryconditions_11collector_lower_boundary, NULL, __pyx_n_s_DECSKS_lib_boundaryconditions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_collector_lower_boundary, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__48 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(12, 0, 16, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_collector_lower_boundary, 247, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__48)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;248:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;249:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;250:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">zpostpointmesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;251:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">vzprepointmesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;252:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">vzprepointvaluemesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;253:         <span class="nb">int</span> <span class="n">Nz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">Nvz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">charge</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;254:         <span class="n">sim_params</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;255:         <span class="n">z</span><span class="p">,</span> <span class="n">vz</span></pre>
<pre class='cython line score-0'>&#xA0;256:         <span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;257:     <span class="c"># vars here are typed as C data types to minimize python interaction</span></pre>
<pre class='cython line score-0'>&#xA0;258: </pre>
<pre class='cython line score-0'>&#xA0;259:     <span class="c"># for any such density packet whose postpoint predicts exceeding the lower boundary of</span></pre>
<pre class='cython line score-0'>&#xA0;260:     <span class="c"># the domain, zero out (absorb) the density, and add contribution to total charge</span></pre>
<pre class='cython line score-0'>&#xA0;261:     <span class="c"># density sigma at that boundary</span></pre>
<pre class='cython line score-0'>&#xA0;262:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+263:     <span class="k">cdef</span> <span class="kt">DTYPE_t</span> <span class="nf">sigma_nk</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_sigma_nk = 0.0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+264:     <span class="k">cdef</span> <span class="kt">DTYPE_t</span> <span class="nf">vzwidth</span> <span class="o">=</span> <span class="n">vz</span><span class="o">.</span><span class="n">width</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_width);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (npy_float64)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_vzwidth = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;265: </pre>
<pre class='cython line score-0'>&#xA0;266:     <span class="c">#    j_inflection = sim_params[&#39;vx_inflection_gridpoint&#39;]</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+267:     <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    case 0:
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+268:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_Nz;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+269:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nvz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_5 = __pyx_v_Nvz;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_j = __pyx_t_6;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+270:                 <span class="k">if</span> <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        __pyx_t_7 = __pyx_v_i;
        __pyx_t_8 = __pyx_v_j;
        if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
        if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
        __pyx_t_9 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_8, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides)) &lt;= 0) != 0);
        if (__pyx_t_9) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+271:                     <span class="n">sigma_nk</span> <span class="o">+=</span> <span class="o">-</span><span class="n">vzprepointvaluemesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">f_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span></pre>
<pre class='cython code score-0'>          __pyx_t_10 = __pyx_v_i;
          __pyx_t_11 = __pyx_v_j;
          if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].shape;
          if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].shape;
          __pyx_t_12 = __pyx_v_i;
          __pyx_t_13 = __pyx_v_j;
          if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_pybuffernd_f_old.diminfo[0].shape;
          if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_pybuffernd_f_old.diminfo[1].shape;
          __pyx_t_14 = __pyx_v_i;
          __pyx_t_15 = __pyx_v_j;
          if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
          if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
          __pyx_v_sigma_nk = (__pyx_v_sigma_nk + ((-(*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].strides))) * ((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_f_old.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_f_old.diminfo[1].strides)) + (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_Uf_old.diminfo[1].strides)))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+272:                     <span class="n">f_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>          __pyx_t_16 = __pyx_v_i;
          __pyx_t_17 = __pyx_v_j;
          if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_pybuffernd_f_old.diminfo[0].shape;
          if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_pybuffernd_f_old.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_f_old.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_f_old.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+273:                     <span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_i;
          __pyx_t_19 = __pyx_v_j;
          if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
          if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Uf_old.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+274:                     <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span>  <span class="c"># set postpoint at the absorber</span></pre>
<pre class='cython code score-0'>          __pyx_t_20 = __pyx_v_i;
          __pyx_t_21 = __pyx_v_j;
          if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
          if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides) = 0;
          goto __pyx_L7;
        }
        __pyx_L7:;
      }
    }
    break;
</pre><pre class='cython line score-0'>&#xA0;275: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+276:     <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  switch (__pyx_v_k) {
/* … */
    case 1:
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+277:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_Nz;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+278:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nvz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_5 = __pyx_v_Nvz;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_j = __pyx_t_6;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+279:                 <span class="k">if</span> <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        __pyx_t_22 = __pyx_v_i;
        __pyx_t_23 = __pyx_v_j;
        if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
        if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
        __pyx_t_9 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_23, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides)) &lt;= 0) != 0);
        if (__pyx_t_9) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+280:                     <span class="n">sigma_nk</span> <span class="o">+=</span> <span class="n">vzprepointvaluemesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_24 = __pyx_v_i;
          __pyx_t_25 = __pyx_v_j;
          if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].shape;
          if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].shape;
          __pyx_t_26 = __pyx_v_i;
          __pyx_t_27 = __pyx_v_j;
          if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
          if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
          __pyx_v_sigma_nk = (__pyx_v_sigma_nk + ((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].strides, __pyx_t_25, __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_27, __pyx_pybuffernd_Uf_old.diminfo[1].strides))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+281:                     <span class="n">f_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>          __pyx_t_28 = __pyx_v_i;
          __pyx_t_29 = __pyx_v_j;
          if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_pybuffernd_f_old.diminfo[0].shape;
          if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_pybuffernd_f_old.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_f_old.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_f_old.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+282:                     <span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>          __pyx_t_30 = __pyx_v_i;
          __pyx_t_31 = __pyx_v_j;
          if (__pyx_t_30 &lt; 0) __pyx_t_30 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
          if (__pyx_t_31 &lt; 0) __pyx_t_31 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_31, __pyx_pybuffernd_Uf_old.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+283:                     <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span>  <span class="c"># set postpoint at the absorber</span></pre>
<pre class='cython code score-0'>          __pyx_t_32 = __pyx_v_i;
          __pyx_t_33 = __pyx_v_j;
          if (__pyx_t_32 &lt; 0) __pyx_t_32 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
          if (__pyx_t_33 &lt; 0) __pyx_t_33 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_33, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides) = 0;
          goto __pyx_L12;
        }
        __pyx_L12:;
      }
    }
    break;
    default: break;
  }
</pre><pre class='cython line score-0'>&#xA0;284: </pre>
<pre class='cython line score-0'>&#xA0;285: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+286:     <span class="n">sigma_nk</span> <span class="o">*=</span> <span class="n">charge</span></pre>
<pre class='cython code score-0'>  __pyx_v_sigma_nk = (__pyx_v_sigma_nk * __pyx_v_charge);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+287:     <span class="n">sigma_nk</span> <span class="o">*=</span> <span class="n">vzwidth</span></pre>
<pre class='cython code score-0'>  __pyx_v_sigma_nk = (__pyx_v_sigma_nk * __pyx_v_vzwidth);
</pre><pre class='cython line score-0'>&#xA0;288: </pre>
<pre class='cython line score-0'>&#xA0;289:     <span class="c"># update cumulative charge density</span></pre>
<pre class='cython line score-40' onclick='toggleDiv(this)'>+290:     <span class="n">sim_params</span><span class="p">[</span><span class="s">&#39;sigma&#39;</span><span class="p">][</span><span class="n">z</span><span class="o">.</span><span class="n">str</span><span class="p">][</span><span class="s">&#39;lower&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sigma_nk</span></pre>
<pre class='cython code score-40'>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_sim_params, __pyx_n_s_sigma);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_34 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_str);<span class='error_goto'> if (unlikely(!__pyx_t_34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_34);
  __pyx_t_35 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_1, __pyx_t_34);<span class='error_goto'> if (unlikely(__pyx_t_35 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_35);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_34); __pyx_t_34 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_lower);
  __pyx_t_36 = __pyx_n_s_lower;
  __pyx_t_34 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_35, __pyx_t_36);<span class='error_goto'> if (unlikely(__pyx_t_34 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_34);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sigma_nk);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_37 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_34, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_37);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_34); __pyx_t_34 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_35, __pyx_t_36, __pyx_t_37) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_37); __pyx_t_37 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_36); __pyx_t_36 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_35); __pyx_t_35 = 0;
</pre><pre class='cython line score-31' onclick='toggleDiv(this)'>+291:     <span class="n">z</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">zpostpointmesh</span></pre>
<pre class='cython code score-31'>  __pyx_t_35 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_35);
  __pyx_t_37 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_37);
/* … */
  __pyx_slice__23 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__23);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_37);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_37);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__23);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_slice__23);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__24);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_slice__24);
  __pyx_t_37 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_35, __pyx_t_1, ((PyObject *)__pyx_v_zpostpointmesh)) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_35); __pyx_t_35 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_slice__24 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__24);
</pre><pre class='cython line score-0'>&#xA0;292: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+293:     <span class="k">return</span> <span class="n">f_old</span><span class="p">,</span> <span class="n">Uf_old</span></pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_f_old));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_f_old));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_f_old));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_old));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_old));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_Uf_old));
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;294: </pre>
<pre class='cython line score-0'>&#xA0;295: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-192' onclick='toggleDiv(this)'>+296: <span class="k">def</span> <span class="nf">collector_upper_boundary</span><span class="p">(</span></pre>
<pre class='cython code score-192'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_13collector_upper_boundary(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6DECSKS_3lib_18boundaryconditions_13collector_upper_boundary = {"collector_upper_boundary", (PyCFunction)__pyx_pw_6DECSKS_3lib_18boundaryconditions_13collector_upper_boundary, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_13collector_upper_boundary(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_f_old = 0;
  PyArrayObject *__pyx_v_Uf_old = 0;
  PyArrayObject *__pyx_v_zpostpointmesh = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointmesh = 0;
  PyArrayObject *__pyx_v_vzprepointvaluemesh = 0;
  int __pyx_v_Nz;
  int __pyx_v_Nvz;
  int __pyx_v_k;
  int __pyx_v_charge;
  PyObject *__pyx_v_sim_params = 0;
  PyObject *__pyx_v_z = 0;
  PyObject *__pyx_v_vz = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("collector_upper_boundary (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_f_old,&amp;__pyx_n_s_Uf_old,&amp;__pyx_n_s_zpostpointmesh,&amp;__pyx_n_s_vzprepointmesh,&amp;__pyx_n_s_vzprepointvaluemesh,&amp;__pyx_n_s_Nz,&amp;__pyx_n_s_Nvz,&amp;__pyx_n_s_k,&amp;__pyx_n_s_charge,&amp;__pyx_n_s_sim_params,&amp;__pyx_n_s_z,&amp;__pyx_n_s_vz,0};
    PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_old)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Uf_old)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_upper_boundary", 1, 12, 12, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_zpostpointmesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_upper_boundary", 1, 12, 12, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vzprepointmesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_upper_boundary", 1, 12, 12, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vzprepointvaluemesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_upper_boundary", 1, 12, 12, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Nz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_upper_boundary", 1, 12, 12, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Nvz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_upper_boundary", 1, 12, 12, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  7:
        if (likely((values[7] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_k)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_upper_boundary", 1, 12, 12, 7); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  8:
        if (likely((values[8] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_charge)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_upper_boundary", 1, 12, 12, 8); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  9:
        if (likely((values[9] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sim_params)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_upper_boundary", 1, 12, 12, 9); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case 10:
        if (likely((values[10] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_upper_boundary", 1, 12, 12, 10); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case 11:
        if (likely((values[11] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_upper_boundary", 1, 12, 12, 11); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "collector_upper_boundary") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 12) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
    }
    __pyx_v_f_old = ((PyArrayObject *)values[0]);
    __pyx_v_Uf_old = ((PyArrayObject *)values[1]);
    __pyx_v_zpostpointmesh = ((PyArrayObject *)values[2]);
    __pyx_v_vzprepointmesh = ((PyArrayObject *)values[3]);
    __pyx_v_vzprepointvaluemesh = ((PyArrayObject *)values[4]);
    __pyx_v_Nz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_Nz == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_Nvz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_Nvz == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_k = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]);<span class='error_goto'> if (unlikely((__pyx_v_k == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_charge = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]);<span class='error_goto'> if (unlikely((__pyx_v_charge == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_sim_params = values[9];
    __pyx_v_z = values[10];
    __pyx_v_vz = values[11];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("collector_upper_boundary", 1, 12, 12, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.collector_upper_boundary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_f_old), __pyx_ptype_5numpy_ndarray, 1, "f_old", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 297; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Uf_old), __pyx_ptype_5numpy_ndarray, 1, "Uf_old", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zpostpointmesh), __pyx_ptype_5numpy_ndarray, 1, "zpostpointmesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vzprepointmesh), __pyx_ptype_5numpy_ndarray, 1, "vzprepointmesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vzprepointvaluemesh), __pyx_ptype_5numpy_ndarray, 1, "vzprepointvaluemesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_18boundaryconditions_12collector_upper_boundary(__pyx_self, __pyx_v_f_old, __pyx_v_Uf_old, __pyx_v_zpostpointmesh, __pyx_v_vzprepointmesh, __pyx_v_vzprepointvaluemesh, __pyx_v_Nz, __pyx_v_Nvz, __pyx_v_k, __pyx_v_charge, __pyx_v_sim_params, __pyx_v_z, __pyx_v_vz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_18boundaryconditions_12collector_upper_boundary(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_f_old, PyArrayObject *__pyx_v_Uf_old, PyArrayObject *__pyx_v_zpostpointmesh, CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointmesh, PyArrayObject *__pyx_v_vzprepointvaluemesh, int __pyx_v_Nz, int __pyx_v_Nvz, int __pyx_v_k, int __pyx_v_charge, PyObject *__pyx_v_sim_params, PyObject *__pyx_v_z, PyObject *__pyx_v_vz) {
  int __pyx_v_i;
  int __pyx_v_j;
  __pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t __pyx_v_sigma_nk;
  __pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t __pyx_v_vzwidth;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_old;
  __Pyx_Buffer __pyx_pybuffer_Uf_old;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f_old;
  __Pyx_Buffer __pyx_pybuffer_f_old;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vzprepointmesh;
  __Pyx_Buffer __pyx_pybuffer_vzprepointmesh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vzprepointvaluemesh;
  __Pyx_Buffer __pyx_pybuffer_vzprepointvaluemesh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zpostpointmesh;
  __Pyx_Buffer __pyx_pybuffer_zpostpointmesh;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("collector_upper_boundary", 0);
  __pyx_pybuffer_f_old.pybuffer.buf = NULL;
  __pyx_pybuffer_f_old.refcount = 0;
  __pyx_pybuffernd_f_old.data = NULL;
  __pyx_pybuffernd_f_old.rcbuffer = &amp;__pyx_pybuffer_f_old;
  __pyx_pybuffer_Uf_old.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_old.refcount = 0;
  __pyx_pybuffernd_Uf_old.data = NULL;
  __pyx_pybuffernd_Uf_old.rcbuffer = &amp;__pyx_pybuffer_Uf_old;
  __pyx_pybuffer_zpostpointmesh.pybuffer.buf = NULL;
  __pyx_pybuffer_zpostpointmesh.refcount = 0;
  __pyx_pybuffernd_zpostpointmesh.data = NULL;
  __pyx_pybuffernd_zpostpointmesh.rcbuffer = &amp;__pyx_pybuffer_zpostpointmesh;
  __pyx_pybuffer_vzprepointmesh.pybuffer.buf = NULL;
  __pyx_pybuffer_vzprepointmesh.refcount = 0;
  __pyx_pybuffernd_vzprepointmesh.data = NULL;
  __pyx_pybuffernd_vzprepointmesh.rcbuffer = &amp;__pyx_pybuffer_vzprepointmesh;
  __pyx_pybuffer_vzprepointvaluemesh.pybuffer.buf = NULL;
  __pyx_pybuffer_vzprepointvaluemesh.refcount = 0;
  __pyx_pybuffernd_vzprepointvaluemesh.data = NULL;
  __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer = &amp;__pyx_pybuffer_vzprepointvaluemesh;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_f_old, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_f_old.diminfo[0].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f_old.diminfo[0].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f_old.diminfo[1].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f_old.diminfo[1].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Uf_old, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Uf_old.diminfo[0].strides = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_old.diminfo[0].shape = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_old.diminfo[1].strides = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_old.diminfo[1].shape = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zpostpointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzprepointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vzprepointmesh.diminfo[0].strides = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzprepointmesh.diminfo[0].shape = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzprepointmesh.diminfo[1].strides = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzprepointmesh.diminfo[1].shape = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzprepointvaluemesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].strides = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].shape = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].strides = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].shape = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_34);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_35);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_36);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_37);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.collector_upper_boundary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__49 = <span class='py_c_api'>PyTuple_Pack</span>(16, __pyx_n_s_f_old, __pyx_n_s_Uf_old, __pyx_n_s_zpostpointmesh, __pyx_n_s_vzprepointmesh, __pyx_n_s_vzprepointvaluemesh, __pyx_n_s_Nz, __pyx_n_s_Nvz, __pyx_n_s_k, __pyx_n_s_charge, __pyx_n_s_sim_params, __pyx_n_s_z, __pyx_n_s_vz, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_sigma_nk, __pyx_n_s_vzwidth);<span class='error_goto'> if (unlikely(!__pyx_tuple__49)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__49);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__49);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_18boundaryconditions_13collector_upper_boundary, NULL, __pyx_n_s_DECSKS_lib_boundaryconditions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_collector_upper_boundary, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__50 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(12, 0, 16, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__49, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_collector_upper_boundary, 296, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__50)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;297:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;298:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;299:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">zpostpointmesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;300:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">vzprepointmesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;301:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">vzprepointvaluemesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;302:         <span class="nb">int</span> <span class="n">Nz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">Nvz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">charge</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;303:         <span class="n">sim_params</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;304:         <span class="n">z</span><span class="p">,</span> <span class="n">vz</span></pre>
<pre class='cython line score-0'>&#xA0;305:         <span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;306:     <span class="c"># vars here are typed as C data types to minimize python interaction</span></pre>
<pre class='cython line score-0'>&#xA0;307: </pre>
<pre class='cython line score-0'>&#xA0;308:     <span class="c"># for any such density packet whose postpoint predicts exceeding the lower boundary of</span></pre>
<pre class='cython line score-0'>&#xA0;309:     <span class="c"># the domain, zero out (absorb) the density, and add contribution to total charge</span></pre>
<pre class='cython line score-0'>&#xA0;310:     <span class="c"># density sigma at that boundary</span></pre>
<pre class='cython line score-0'>&#xA0;311:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+312:     <span class="k">cdef</span> <span class="kt">DTYPE_t</span> <span class="nf">sigma_nk</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_sigma_nk = 0.0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+313:     <span class="k">cdef</span> <span class="kt">DTYPE_t</span> <span class="nf">vzwidth</span> <span class="o">=</span> <span class="n">vz</span><span class="o">.</span><span class="n">width</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_width);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (npy_float64)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_vzwidth = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;314: </pre>
<pre class='cython line score-0'>&#xA0;315:     <span class="c">#j_inflection = sim_params[&#39;vx_inflection_gridpoint&#39;]</span></pre>
<pre class='cython line score-0'>&#xA0;316: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+317:     <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    case 0:
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+318:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_Nz;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+319:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nvz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_5 = __pyx_v_Nvz;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_j = __pyx_t_6;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+320:                 <span class="k">if</span> <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span>  <span class="n">Nz</span> <span class="o">-</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        __pyx_t_7 = __pyx_v_i;
        __pyx_t_8 = __pyx_v_j;
        if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
        if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
        __pyx_t_9 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_8, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides)) &gt;= (__pyx_v_Nz - 1)) != 0);
        if (__pyx_t_9) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+321:                     <span class="n">sigma_nk</span> <span class="o">+=</span> <span class="n">vzprepointvaluemesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">f_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span></pre>
<pre class='cython code score-0'>          __pyx_t_10 = __pyx_v_i;
          __pyx_t_11 = __pyx_v_j;
          if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].shape;
          if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].shape;
          __pyx_t_12 = __pyx_v_i;
          __pyx_t_13 = __pyx_v_j;
          if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_pybuffernd_f_old.diminfo[0].shape;
          if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_pybuffernd_f_old.diminfo[1].shape;
          __pyx_t_14 = __pyx_v_i;
          __pyx_t_15 = __pyx_v_j;
          if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
          if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
          __pyx_v_sigma_nk = (__pyx_v_sigma_nk + ((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].strides)) * ((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_f_old.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_f_old.diminfo[1].strides)) - (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_Uf_old.diminfo[1].strides)))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+322:                     <span class="n">f_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>          __pyx_t_16 = __pyx_v_i;
          __pyx_t_17 = __pyx_v_j;
          if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_pybuffernd_f_old.diminfo[0].shape;
          if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_pybuffernd_f_old.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_f_old.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_f_old.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+323:                     <span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_i;
          __pyx_t_19 = __pyx_v_j;
          if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
          if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Uf_old.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+324:                     <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nz</span> <span class="o">-</span> <span class="mf">1</span>  <span class="c"># set postpoint at the absorber</span></pre>
<pre class='cython code score-0'>          __pyx_t_20 = __pyx_v_i;
          __pyx_t_21 = __pyx_v_j;
          if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
          if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides) = (__pyx_v_Nz - 1);
          goto __pyx_L7;
        }
        __pyx_L7:;
      }
    }
    break;
</pre><pre class='cython line score-0'>&#xA0;325: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+326:     <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  switch (__pyx_v_k) {
/* … */
    case 1:
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+327:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_Nz;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+328:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nvz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_5 = __pyx_v_Nvz;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_j = __pyx_t_6;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+329:                 <span class="k">if</span> <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span>  <span class="n">Nz</span> <span class="o">-</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        __pyx_t_22 = __pyx_v_i;
        __pyx_t_23 = __pyx_v_j;
        if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
        if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
        __pyx_t_9 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_23, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides)) &gt;= (__pyx_v_Nz - 1)) != 0);
        if (__pyx_t_9) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+330:                     <span class="n">sigma_nk</span> <span class="o">+=</span> <span class="n">vzprepointvaluemesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_24 = __pyx_v_i;
          __pyx_t_25 = __pyx_v_j;
          if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].shape;
          if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].shape;
          __pyx_t_26 = __pyx_v_i;
          __pyx_t_27 = __pyx_v_j;
          if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
          if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
          __pyx_v_sigma_nk = (__pyx_v_sigma_nk + ((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].strides, __pyx_t_25, __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_27, __pyx_pybuffernd_Uf_old.diminfo[1].strides))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+331:                     <span class="n">f_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>          __pyx_t_28 = __pyx_v_i;
          __pyx_t_29 = __pyx_v_j;
          if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_pybuffernd_f_old.diminfo[0].shape;
          if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_pybuffernd_f_old.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_f_old.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_f_old.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+332:                     <span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>          __pyx_t_30 = __pyx_v_i;
          __pyx_t_31 = __pyx_v_j;
          if (__pyx_t_30 &lt; 0) __pyx_t_30 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
          if (__pyx_t_31 &lt; 0) __pyx_t_31 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_31, __pyx_pybuffernd_Uf_old.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+333:                     <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nz</span> <span class="o">-</span> <span class="mf">1</span>  <span class="c"># set postpoint at the absorber</span></pre>
<pre class='cython code score-0'>          __pyx_t_32 = __pyx_v_i;
          __pyx_t_33 = __pyx_v_j;
          if (__pyx_t_32 &lt; 0) __pyx_t_32 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
          if (__pyx_t_33 &lt; 0) __pyx_t_33 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_33, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides) = (__pyx_v_Nz - 1);
          goto __pyx_L12;
        }
        __pyx_L12:;
      }
    }
    break;
    default: break;
  }
</pre><pre class='cython line score-0'>&#xA0;334: </pre>
<pre class='cython line score-0'>&#xA0;335: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+336:     <span class="n">sigma_nk</span> <span class="o">*=</span> <span class="n">charge</span></pre>
<pre class='cython code score-0'>  __pyx_v_sigma_nk = (__pyx_v_sigma_nk * __pyx_v_charge);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+337:     <span class="n">sigma_nk</span> <span class="o">*=</span> <span class="n">vzwidth</span></pre>
<pre class='cython code score-0'>  __pyx_v_sigma_nk = (__pyx_v_sigma_nk * __pyx_v_vzwidth);
</pre><pre class='cython line score-0'>&#xA0;338: </pre>
<pre class='cython line score-0'>&#xA0;339:     <span class="c"># update cumulative charge density</span></pre>
<pre class='cython line score-40' onclick='toggleDiv(this)'>+340:     <span class="n">sim_params</span><span class="p">[</span><span class="s">&#39;sigma&#39;</span><span class="p">][</span><span class="n">z</span><span class="o">.</span><span class="n">str</span><span class="p">][</span><span class="s">&#39;upper&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sigma_nk</span></pre>
<pre class='cython code score-40'>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_sim_params, __pyx_n_s_sigma);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_34 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_str);<span class='error_goto'> if (unlikely(!__pyx_t_34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_34);
  __pyx_t_35 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_1, __pyx_t_34);<span class='error_goto'> if (unlikely(__pyx_t_35 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_35);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_34); __pyx_t_34 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_upper);
  __pyx_t_36 = __pyx_n_s_upper;
  __pyx_t_34 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_35, __pyx_t_36);<span class='error_goto'> if (unlikely(__pyx_t_34 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_34);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sigma_nk);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_37 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_34, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_37);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_34); __pyx_t_34 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_35, __pyx_t_36, __pyx_t_37) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_37); __pyx_t_37 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_36); __pyx_t_36 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_35); __pyx_t_35 = 0;
</pre><pre class='cython line score-31' onclick='toggleDiv(this)'>+341:     <span class="n">z</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">zpostpointmesh</span></pre>
<pre class='cython code score-31'>  __pyx_t_35 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_35);
  __pyx_t_37 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_37);
/* … */
  __pyx_slice__25 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__25);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_37);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_37);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__25);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_slice__25);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__26);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_slice__26);
  __pyx_t_37 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_35, __pyx_t_1, ((PyObject *)__pyx_v_zpostpointmesh)) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_35); __pyx_t_35 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_slice__26 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__26);
</pre><pre class='cython line score-0'>&#xA0;342: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+343:     <span class="k">return</span> <span class="n">f_old</span><span class="p">,</span> <span class="n">Uf_old</span></pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_f_old));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_f_old));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_f_old));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_old));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_old));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_Uf_old));
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;344: </pre>
<pre class='cython line score-0'>&#xA0;345: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-224' onclick='toggleDiv(this)'>+346: <span class="k">def</span> <span class="nf">symmetric_lower_boundary</span><span class="p">(</span></pre>
<pre class='cython code score-224'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_15symmetric_lower_boundary(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6DECSKS_3lib_18boundaryconditions_14symmetric_lower_boundary[] = "\n\n    This routine assumes a time substep is positive as the Vlasov-Poisson system are irreversible\n    when boundaries are present (i.e. the upper boundary cannot be periodic/open in this setup)\n\n    this boundary condition must not inherently must operate on a symmetric velocity grid,\n    but it is more natural and consistent this way.\n\n    For example, if an exiting particle at the symmetry plane has\n    a velocity V1 &lt; 0, it is the case that there exists an entering partner particle from the\n    complement domain with oppositely directly velocity -V1 &gt; 0. If a symmetric velocity\n    grid, i.e. [avx, bvx] = [-V, V], is used then it is always possible to factor in both\n    exiting (V1 &lt; 0) density with entering partners (-V1 &gt; 0) provided that V1 is inside [-V,V].\n\n    If we have an asymmetric case where [avx, bvx] where avx != -bvx, then in the handling\n    of the symmetry plane, there would be cases where such an exiting particle having V1 &lt; 0 could\n    its entering partner with velocity -V1 could not be represented (i.e. if avx &lt; V1 is in the velocity grid,\n    but bvx &lt; -V1). There are two options for handling this, one of which is erroneous.\n\n        (1) [Erroneous] The routine could try to muster some approximation to the scenario by\n            taking the maximum value on the grid, but that would be unphysical.\n\n        (2) [Correct] We could still argue that it would be appropriate means of handling such\n            situations would be that if a particle with V1 &lt; 0 exits, and if an entering particle\n            would have -V1 &gt; bvx, then to take the partner density to be zero and interpret the\n            situation as the \"window\" of phase space we are looking at just does not show the entering partner.\n\n\n    method (2) is permissible; however, we do not have current motivation to code this generality\n    as the circumstances seem inferior to symmetric velocity grid setups. Instead, we currently\n    advise users to set up s""ymmetric velocity grids if a symmetry boundary condition is used.\n    ";
static PyMethodDef __pyx_mdef_6DECSKS_3lib_18boundaryconditions_15symmetric_lower_boundary = {"symmetric_lower_boundary", (PyCFunction)__pyx_pw_6DECSKS_3lib_18boundaryconditions_15symmetric_lower_boundary, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6DECSKS_3lib_18boundaryconditions_14symmetric_lower_boundary};
static PyObject *__pyx_pw_6DECSKS_3lib_18boundaryconditions_15symmetric_lower_boundary(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_f_k = 0;
  PyArrayObject *__pyx_v_f_old = 0;
  PyArrayObject *__pyx_v_Uf_old = 0;
  PyArrayObject *__pyx_v_zpostpointmesh = 0;
  PyArrayObject *__pyx_v_vzprepointmesh = 0;
  PyArrayObject *__pyx_v_vzpostpointmesh = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointvaluemesh = 0;
  int __pyx_v_Nz;
  int __pyx_v_Nvz;
  int __pyx_v_k;
  CYTHON_UNUSED int __pyx_v_charge;
  CYTHON_UNUSED PyObject *__pyx_v_sim_params = 0;
  PyObject *__pyx_v_z = 0;
  PyObject *__pyx_v_vz = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("symmetric_lower_boundary (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_f_k,&amp;__pyx_n_s_f_old,&amp;__pyx_n_s_Uf_old,&amp;__pyx_n_s_zpostpointmesh,&amp;__pyx_n_s_vzprepointmesh,&amp;__pyx_n_s_vzpostpointmesh,&amp;__pyx_n_s_vzprepointvaluemesh,&amp;__pyx_n_s_Nz,&amp;__pyx_n_s_Nvz,&amp;__pyx_n_s_k,&amp;__pyx_n_s_charge,&amp;__pyx_n_s_sim_params,&amp;__pyx_n_s_z,&amp;__pyx_n_s_vz,0};
    PyObject* values[14] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 14: values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_k)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_old)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Uf_old)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_zpostpointmesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vzprepointmesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vzpostpointmesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vzprepointvaluemesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  7:
        if (likely((values[7] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Nz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 7); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  8:
        if (likely((values[8] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Nvz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 8); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  9:
        if (likely((values[9] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_k)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 9); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case 10:
        if (likely((values[10] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_charge)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 10); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case 11:
        if (likely((values[11] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sim_params)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 11); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case 12:
        if (likely((values[12] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 12); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case 13:
        if (likely((values[13] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, 13); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "symmetric_lower_boundary") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 14) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
      values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
      values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
    }
    __pyx_v_f_k = ((PyArrayObject *)values[0]);
    __pyx_v_f_old = ((PyArrayObject *)values[1]);
    __pyx_v_Uf_old = ((PyArrayObject *)values[2]);
    __pyx_v_zpostpointmesh = ((PyArrayObject *)values[3]);
    __pyx_v_vzprepointmesh = ((PyArrayObject *)values[4]);
    __pyx_v_vzpostpointmesh = ((PyArrayObject *)values[5]);
    __pyx_v_vzprepointvaluemesh = ((PyArrayObject *)values[6]);
    __pyx_v_Nz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]);<span class='error_goto'> if (unlikely((__pyx_v_Nz == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_Nvz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]);<span class='error_goto'> if (unlikely((__pyx_v_Nvz == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_k = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[9]);<span class='error_goto'> if (unlikely((__pyx_v_k == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_charge = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[10]);<span class='error_goto'> if (unlikely((__pyx_v_charge == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_sim_params = values[11];
    __pyx_v_z = values[12];
    __pyx_v_vz = values[13];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("symmetric_lower_boundary", 1, 14, 14, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.symmetric_lower_boundary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_f_k), __pyx_ptype_5numpy_ndarray, 1, "f_k", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_f_old), __pyx_ptype_5numpy_ndarray, 1, "f_old", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Uf_old), __pyx_ptype_5numpy_ndarray, 1, "Uf_old", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zpostpointmesh), __pyx_ptype_5numpy_ndarray, 1, "zpostpointmesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vzprepointmesh), __pyx_ptype_5numpy_ndarray, 1, "vzprepointmesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vzpostpointmesh), __pyx_ptype_5numpy_ndarray, 1, "vzpostpointmesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vzprepointvaluemesh), __pyx_ptype_5numpy_ndarray, 1, "vzprepointvaluemesh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_18boundaryconditions_14symmetric_lower_boundary(__pyx_self, __pyx_v_f_k, __pyx_v_f_old, __pyx_v_Uf_old, __pyx_v_zpostpointmesh, __pyx_v_vzprepointmesh, __pyx_v_vzpostpointmesh, __pyx_v_vzprepointvaluemesh, __pyx_v_Nz, __pyx_v_Nvz, __pyx_v_k, __pyx_v_charge, __pyx_v_sim_params, __pyx_v_z, __pyx_v_vz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_18boundaryconditions_14symmetric_lower_boundary(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_f_k, PyArrayObject *__pyx_v_f_old, PyArrayObject *__pyx_v_Uf_old, PyArrayObject *__pyx_v_zpostpointmesh, PyArrayObject *__pyx_v_vzprepointmesh, PyArrayObject *__pyx_v_vzpostpointmesh, CYTHON_UNUSED PyArrayObject *__pyx_v_vzprepointvaluemesh, int __pyx_v_Nz, int __pyx_v_Nvz, int __pyx_v_k, CYTHON_UNUSED int __pyx_v_charge, CYTHON_UNUSED PyObject *__pyx_v_sim_params, PyObject *__pyx_v_z, PyObject *__pyx_v_vz) {
  int __pyx_v_i;
  int __pyx_v_j;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_old;
  __Pyx_Buffer __pyx_pybuffer_Uf_old;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f_k;
  __Pyx_Buffer __pyx_pybuffer_f_k;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f_old;
  __Pyx_Buffer __pyx_pybuffer_f_old;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vzpostpointmesh;
  __Pyx_Buffer __pyx_pybuffer_vzpostpointmesh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vzprepointmesh;
  __Pyx_Buffer __pyx_pybuffer_vzprepointmesh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vzprepointvaluemesh;
  __Pyx_Buffer __pyx_pybuffer_vzprepointvaluemesh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zpostpointmesh;
  __Pyx_Buffer __pyx_pybuffer_zpostpointmesh;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("symmetric_lower_boundary", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_vzpostpointmesh);
  __pyx_pybuffer_f_k.pybuffer.buf = NULL;
  __pyx_pybuffer_f_k.refcount = 0;
  __pyx_pybuffernd_f_k.data = NULL;
  __pyx_pybuffernd_f_k.rcbuffer = &amp;__pyx_pybuffer_f_k;
  __pyx_pybuffer_f_old.pybuffer.buf = NULL;
  __pyx_pybuffer_f_old.refcount = 0;
  __pyx_pybuffernd_f_old.data = NULL;
  __pyx_pybuffernd_f_old.rcbuffer = &amp;__pyx_pybuffer_f_old;
  __pyx_pybuffer_Uf_old.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_old.refcount = 0;
  __pyx_pybuffernd_Uf_old.data = NULL;
  __pyx_pybuffernd_Uf_old.rcbuffer = &amp;__pyx_pybuffer_Uf_old;
  __pyx_pybuffer_zpostpointmesh.pybuffer.buf = NULL;
  __pyx_pybuffer_zpostpointmesh.refcount = 0;
  __pyx_pybuffernd_zpostpointmesh.data = NULL;
  __pyx_pybuffernd_zpostpointmesh.rcbuffer = &amp;__pyx_pybuffer_zpostpointmesh;
  __pyx_pybuffer_vzprepointmesh.pybuffer.buf = NULL;
  __pyx_pybuffer_vzprepointmesh.refcount = 0;
  __pyx_pybuffernd_vzprepointmesh.data = NULL;
  __pyx_pybuffernd_vzprepointmesh.rcbuffer = &amp;__pyx_pybuffer_vzprepointmesh;
  __pyx_pybuffer_vzpostpointmesh.pybuffer.buf = NULL;
  __pyx_pybuffer_vzpostpointmesh.refcount = 0;
  __pyx_pybuffernd_vzpostpointmesh.data = NULL;
  __pyx_pybuffernd_vzpostpointmesh.rcbuffer = &amp;__pyx_pybuffer_vzpostpointmesh;
  __pyx_pybuffer_vzprepointvaluemesh.pybuffer.buf = NULL;
  __pyx_pybuffer_vzprepointvaluemesh.refcount = 0;
  __pyx_pybuffernd_vzprepointvaluemesh.data = NULL;
  __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer = &amp;__pyx_pybuffer_vzprepointvaluemesh;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f_k.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_f_k, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_f_k.diminfo[0].strides = __pyx_pybuffernd_f_k.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f_k.diminfo[0].shape = __pyx_pybuffernd_f_k.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f_k.diminfo[1].strides = __pyx_pybuffernd_f_k.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f_k.diminfo[1].shape = __pyx_pybuffernd_f_k.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_f_old, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_f_old.diminfo[0].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f_old.diminfo[0].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f_old.diminfo[1].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f_old.diminfo[1].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Uf_old, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Uf_old.diminfo[0].strides = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_old.diminfo[0].shape = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_old.diminfo[1].strides = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_old.diminfo[1].shape = __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zpostpointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape = __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzprepointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vzprepointmesh.diminfo[0].strides = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzprepointmesh.diminfo[0].shape = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzprepointmesh.diminfo[1].strides = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzprepointmesh.diminfo[1].shape = __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzpostpointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vzpostpointmesh.diminfo[0].strides = __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzpostpointmesh.diminfo[0].shape = __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzpostpointmesh.diminfo[1].strides = __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzpostpointmesh.diminfo[1].shape = __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzprepointvaluemesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].strides = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[0].shape = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].strides = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzprepointvaluemesh.diminfo[1].shape = __pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_k.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.boundaryconditions.symmetric_lower_boundary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_k.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzprepointvaluemesh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_vzpostpointmesh);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__51 = <span class='py_c_api'>PyTuple_Pack</span>(16, __pyx_n_s_f_k, __pyx_n_s_f_old, __pyx_n_s_Uf_old, __pyx_n_s_zpostpointmesh, __pyx_n_s_vzprepointmesh, __pyx_n_s_vzpostpointmesh, __pyx_n_s_vzprepointvaluemesh, __pyx_n_s_Nz, __pyx_n_s_Nvz, __pyx_n_s_k, __pyx_n_s_charge, __pyx_n_s_sim_params, __pyx_n_s_z, __pyx_n_s_vz, __pyx_n_s_i, __pyx_n_s_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__51)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__51);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__51);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_18boundaryconditions_15symmetric_lower_boundary, NULL, __pyx_n_s_DECSKS_lib_boundaryconditions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_symmetric_lower_boundary, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;347:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f_k</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;348:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;349:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_old</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;350:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">zpostpointmesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;351:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">vzprepointmesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;352:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">vzpostpointmesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;353:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">vzprepointvaluemesh</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;354:         <span class="nb">int</span> <span class="n">Nz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">Nvz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;355:         <span class="nb">int</span> <span class="n">charge</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;356:         <span class="n">sim_params</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;357:         <span class="n">z</span><span class="p">,</span> <span class="n">vz</span></pre>
<pre class='cython line score-0'>&#xA0;358:         <span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;359:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;360: </pre>
<pre class='cython line score-0'>&#xA0;361: <span class="sd">    This routine assumes a time substep is positive as the Vlasov-Poisson system are irreversible</span></pre>
<pre class='cython line score-0'>&#xA0;362: <span class="sd">    when boundaries are present (i.e. the upper boundary cannot be periodic/open in this setup)</span></pre>
<pre class='cython line score-0'>&#xA0;363: </pre>
<pre class='cython line score-0'>&#xA0;364: <span class="sd">    this boundary condition must not inherently must operate on a symmetric velocity grid,</span></pre>
<pre class='cython line score-0'>&#xA0;365: <span class="sd">    but it is more natural and consistent this way.</span></pre>
<pre class='cython line score-0'>&#xA0;366: </pre>
<pre class='cython line score-0'>&#xA0;367: <span class="sd">    For example, if an exiting particle at the symmetry plane has</span></pre>
<pre class='cython line score-0'>&#xA0;368: <span class="sd">    a velocity V1 &lt; 0, it is the case that there exists an entering partner particle from the</span></pre>
<pre class='cython line score-0'>&#xA0;369: <span class="sd">    complement domain with oppositely directly velocity -V1 &gt; 0. If a symmetric velocity</span></pre>
<pre class='cython line score-0'>&#xA0;370: <span class="sd">    grid, i.e. [avx, bvx] = [-V, V], is used then it is always possible to factor in both</span></pre>
<pre class='cython line score-0'>&#xA0;371: <span class="sd">    exiting (V1 &lt; 0) density with entering partners (-V1 &gt; 0) provided that V1 is inside [-V,V].</span></pre>
<pre class='cython line score-0'>&#xA0;372: </pre>
<pre class='cython line score-0'>&#xA0;373: <span class="sd">    If we have an asymmetric case where [avx, bvx] where avx != -bvx, then in the handling</span></pre>
<pre class='cython line score-0'>&#xA0;374: <span class="sd">    of the symmetry plane, there would be cases where such an exiting particle having V1 &lt; 0 could</span></pre>
<pre class='cython line score-0'>&#xA0;375: <span class="sd">    its entering partner with velocity -V1 could not be represented (i.e. if avx &lt; V1 is in the velocity grid,</span></pre>
<pre class='cython line score-0'>&#xA0;376: <span class="sd">    but bvx &lt; -V1). There are two options for handling this, one of which is erroneous.</span></pre>
<pre class='cython line score-0'>&#xA0;377: </pre>
<pre class='cython line score-0'>&#xA0;378: <span class="sd">        (1) [Erroneous] The routine could try to muster some approximation to the scenario by</span></pre>
<pre class='cython line score-0'>&#xA0;379: <span class="sd">            taking the maximum value on the grid, but that would be unphysical.</span></pre>
<pre class='cython line score-0'>&#xA0;380: </pre>
<pre class='cython line score-0'>&#xA0;381: <span class="sd">        (2) [Correct] We could still argue that it would be appropriate means of handling such</span></pre>
<pre class='cython line score-0'>&#xA0;382: <span class="sd">            situations would be that if a particle with V1 &lt; 0 exits, and if an entering particle</span></pre>
<pre class='cython line score-0'>&#xA0;383: <span class="sd">            would have -V1 &gt; bvx, then to take the partner density to be zero and interpret the</span></pre>
<pre class='cython line score-0'>&#xA0;384: <span class="sd">            situation as the &quot;window&quot; of phase space we are looking at just does not show the entering partner.</span></pre>
<pre class='cython line score-0'>&#xA0;385: </pre>
<pre class='cython line score-0'>&#xA0;386: </pre>
<pre class='cython line score-0'>&#xA0;387: <span class="sd">    method (2) is permissible; however, we do not have current motivation to code this generality</span></pre>
<pre class='cython line score-0'>&#xA0;388: <span class="sd">    as the circumstances seem inferior to symmetric velocity grid setups. Instead, we currently</span></pre>
<pre class='cython line score-0'>&#xA0;389: <span class="sd">    advise users to set up symmetric velocity grids if a symmetry boundary condition is used.</span></pre>
<pre class='cython line score-0'>&#xA0;390: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-39' onclick='toggleDiv(this)'>+391:     <span class="n">vzpostpointmesh</span> <span class="o">=</span> <span class="n">vzprepointmesh</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c"># by this point, vzpostpointmesh has not been assigned (is an array of zeroes), init to prepointmesh values</span></pre>
<pre class='cython code score-39'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_vzprepointmesh), __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_4, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_5 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_6, &amp;__pyx_t_7, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vzpostpointmesh, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_6); Py_XDECREF(__pyx_t_7); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_6, __pyx_t_7, __pyx_t_8);
      }
    }
    __pyx_pybuffernd_vzpostpointmesh.diminfo[0].strides = __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vzpostpointmesh.diminfo[0].shape = __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_vzpostpointmesh.diminfo[1].strides = __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_vzpostpointmesh.diminfo[1].shape = __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vzpostpointmesh, ((PyArrayObject *)__pyx_t_1));
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;392:                                             <span class="c"># and replace exiting particles with their partner velocities if encountered when scanning of all [i,j]</span></pre>
<pre class='cython line score-0'>&#xA0;393: </pre>
<pre class='cython line score-0'>&#xA0;394:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+395:     <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_9 = ((__pyx_v_k == 0) != 0);
  if (__pyx_t_9) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+396:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nvz</span><span class="o">/</span><span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __Pyx_div_long(__pyx_v_Nvz, 2);
    for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_10; __pyx_t_5+=1) {
      __pyx_v_j = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+397:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_11 = __pyx_v_Nz;
      for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
        __pyx_v_i = __pyx_t_12;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+398:                 <span class="k">if</span> <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        __pyx_t_13 = __pyx_v_i;
        __pyx_t_14 = __pyx_v_j;
        if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
        if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
        __pyx_t_9 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides)) &lt;= 0) != 0);
        if (__pyx_t_9) {
</pre><pre class='cython line score-0'>&#xA0;399:                     <span class="c"># prepare for partner remap in lib.convect_configuration.remap_step</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+400:                     <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_15 = __pyx_v_i;
          __pyx_t_16 = __pyx_v_j;
          if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
          if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
          __pyx_t_17 = __pyx_v_i;
          __pyx_t_18 = __pyx_v_j;
          if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
          if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides) = (-(*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+401:                     <span class="n">vzpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nvz</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">vzprepointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_19 = __pyx_v_i;
          __pyx_t_20 = __pyx_v_j;
          if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_pybuffernd_vzprepointmesh.diminfo[0].shape;
          if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_pybuffernd_vzprepointmesh.diminfo[1].shape;
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_22 = __pyx_v_j;
          if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_pybuffernd_vzpostpointmesh.diminfo[0].shape;
          if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_pybuffernd_vzpostpointmesh.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_vzpostpointmesh.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_vzpostpointmesh.diminfo[1].strides) = ((__pyx_v_Nvz - 1) - (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_vzprepointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_vzprepointmesh.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_vzprepointmesh.diminfo[1].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+402:                     <span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_23 = __pyx_v_i;
          __pyx_t_24 = __pyx_v_j;
          if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
          if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
          __pyx_t_25 = __pyx_v_i;
          __pyx_t_26 = __pyx_v_j;
          if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
          if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_26, __pyx_pybuffernd_Uf_old.diminfo[1].strides) = (-(*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_Uf_old.diminfo[1].strides)));
          goto __pyx_L8;
        }
        __pyx_L8:;
      }
    }
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+403:     <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_9 = ((__pyx_v_k == 1) != 0);
  if (__pyx_t_9) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+404:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nvz</span> <span class="o">/</span> <span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __Pyx_div_long(__pyx_v_Nvz, 2);
    for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_10; __pyx_t_5+=1) {
      __pyx_v_j = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+405:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_11 = __pyx_v_Nz;
      for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
        __pyx_v_i = __pyx_t_12;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+406:                 <span class="k">if</span> <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        __pyx_t_27 = __pyx_v_i;
        __pyx_t_28 = __pyx_v_j;
        if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
        if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
        __pyx_t_9 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides)) &lt;= 0) != 0);
        if (__pyx_t_9) {
</pre><pre class='cython line score-0'>&#xA0;407:                     <span class="c"># prepare for partner remap in lib.convect_configuration.remap_step</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+408:                     <span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">zpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_29 = __pyx_v_i;
          __pyx_t_30 = __pyx_v_j;
          if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
          if (__pyx_t_30 &lt; 0) __pyx_t_30 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
          __pyx_t_31 = __pyx_v_i;
          __pyx_t_32 = __pyx_v_j;
          if (__pyx_t_31 &lt; 0) __pyx_t_31 += __pyx_pybuffernd_zpostpointmesh.diminfo[0].shape;
          if (__pyx_t_32 &lt; 0) __pyx_t_32 += __pyx_pybuffernd_zpostpointmesh.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_32, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides) = (-(*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_zpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_zpostpointmesh.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_zpostpointmesh.diminfo[1].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+409:                     <span class="n">vzpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nvz</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">vzpostpointmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_33 = __pyx_v_i;
          __pyx_t_34 = __pyx_v_j;
          if (__pyx_t_33 &lt; 0) __pyx_t_33 += __pyx_pybuffernd_vzpostpointmesh.diminfo[0].shape;
          if (__pyx_t_34 &lt; 0) __pyx_t_34 += __pyx_pybuffernd_vzpostpointmesh.diminfo[1].shape;
          __pyx_t_35 = __pyx_v_i;
          __pyx_t_36 = __pyx_v_j;
          if (__pyx_t_35 &lt; 0) __pyx_t_35 += __pyx_pybuffernd_vzpostpointmesh.diminfo[0].shape;
          if (__pyx_t_36 &lt; 0) __pyx_t_36 += __pyx_pybuffernd_vzpostpointmesh.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_vzpostpointmesh.diminfo[0].strides, __pyx_t_36, __pyx_pybuffernd_vzpostpointmesh.diminfo[1].strides) = ((__pyx_v_Nvz - 1) - (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPEINT_t *, __pyx_pybuffernd_vzpostpointmesh.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_vzpostpointmesh.diminfo[0].strides, __pyx_t_34, __pyx_pybuffernd_vzpostpointmesh.diminfo[1].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+410:                     <span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Uf_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_37 = __pyx_v_i;
          __pyx_t_38 = __pyx_v_j;
          if (__pyx_t_37 &lt; 0) __pyx_t_37 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
          if (__pyx_t_38 &lt; 0) __pyx_t_38 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
          __pyx_t_39 = __pyx_v_i;
          __pyx_t_40 = __pyx_v_j;
          if (__pyx_t_39 &lt; 0) __pyx_t_39 += __pyx_pybuffernd_Uf_old.diminfo[0].shape;
          if (__pyx_t_40 &lt; 0) __pyx_t_40 += __pyx_pybuffernd_Uf_old.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_40, __pyx_pybuffernd_Uf_old.diminfo[1].strides) = (-(*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_18boundaryconditions_DTYPE_t *, __pyx_pybuffernd_Uf_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_Uf_old.diminfo[0].strides, __pyx_t_38, __pyx_pybuffernd_Uf_old.diminfo[1].strides)));
          goto __pyx_L14;
        }
        __pyx_L14:;
      }
    }
    goto __pyx_L9;
  }
  __pyx_L9:;
</pre><pre class='cython line score-0'>&#xA0;411: </pre>
<pre class='cython line score-31' onclick='toggleDiv(this)'>+412:     <span class="n">z</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">zpostpointmesh</span></pre>
<pre class='cython code score-31'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_slice__27 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__27);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__27);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_slice__27);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__28);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_slice__28);
  __pyx_t_2 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_1, __pyx_t_3, ((PyObject *)__pyx_v_zpostpointmesh)) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_slice__28 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__28);
</pre><pre class='cython line score-31' onclick='toggleDiv(this)'>+413:     <span class="n">vz</span><span class="o">.</span><span class="n">postpointmesh</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">vzpostpointmesh</span></pre>
<pre class='cython code score-31'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vz, __pyx_n_s_postpointmesh);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_slice__29 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__29);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__29);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_slice__29);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__30);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_slice__30);
  __pyx_t_1 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_3, __pyx_t_2, ((PyObject *)__pyx_v_vzpostpointmesh)) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_slice__30 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__30);
</pre><pre class='cython line score-0'>&#xA0;414: </pre>
<pre class='cython line score-12' onclick='toggleDiv(this)'>+415:     <span class="k">return</span> <span class="n">f_k</span><span class="p">,</span> <span class="n">f_old</span><span class="p">,</span> <span class="n">Uf_old</span></pre>
<pre class='cython code score-12'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_f_k));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_f_k));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_f_k));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_f_old));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_f_old));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_f_old));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_old));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_old));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_v_Uf_old));
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre></div></body></html>
