<!DOCTYPE html>
<!-- Generated by Cython 0.22.1 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: remap.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.22.1</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="remap.c">remap.c</a></p>
<div class="cython"><pre class='cython line score-19' onclick='toggleDiv(this)'>+001: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-19'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;002: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython line score-0'>&#xA0;003: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class='cython line score-0'>&#xA0;004: </pre>
<pre class='cython line score-11' onclick='toggleDiv(this)'>+005: <span class="n">DTYPE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span></pre>
<pre class='cython code score-11'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+006: <span class="n">DTYPEINT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span></pre>
<pre class='cython code score-11'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPEINT, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;007: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+008: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">float64_t</span> <span class="n">DTYPE_t</span></pre>
<pre class='cython code score-0'>typedef __pyx_t_5numpy_float64_t __pyx_t_6DECSKS_3lib_5remap_DTYPE_t;
</pre><pre class='cython line score-0'>&#xA0;009: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">int64_t</span> <span class="n">DTYPEINT_t</span></pre>
<pre class='cython line score-0'>&#xA0;010: </pre>
<pre class='cython line score-0'>&#xA0;011: </pre>
<pre class='cython line score-113' onclick='toggleDiv(this)'>+012: <span class="k">def</span> <span class="nf">assignment</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f_old</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">map1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPEINT_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">map2</span><span class="p">,</span> <span class="nb">int</span> <span class="n">dim1</span><span class="p">,</span> <span class="nb">int</span> <span class="n">dim2</span><span class="p">):</span></pre>
<pre class='cython code score-113'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_1assignment(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6DECSKS_3lib_5remap_1assignment = {"assignment", (PyCFunction)__pyx_pw_6DECSKS_3lib_5remap_1assignment, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_1assignment(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_f_old = 0;
  PyArrayObject *__pyx_v_map1 = 0;
  PyArrayObject *__pyx_v_map2 = 0;
  int __pyx_v_dim1;
  int __pyx_v_dim2;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assignment (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_f_old,&amp;__pyx_n_s_map1,&amp;__pyx_n_s_map2,&amp;__pyx_n_s_dim1,&amp;__pyx_n_s_dim2,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_old)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_map1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assignment", 1, 5, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_map2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assignment", 1, 5, 5, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_dim1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assignment", 1, 5, 5, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_dim2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assignment", 1, 5, 5, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "assignment") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_f_old = ((PyArrayObject *)values[0]);
    __pyx_v_map1 = ((PyArrayObject *)values[1]);
    __pyx_v_map2 = ((PyArrayObject *)values[2]);
    __pyx_v_dim1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_dim1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_dim2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_dim2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assignment", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.assignment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_f_old), __pyx_ptype_5numpy_ndarray, 1, "f_old", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_map1), __pyx_ptype_5numpy_ndarray, 1, "map1", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_map2), __pyx_ptype_5numpy_ndarray, 1, "map2", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_5remap_assignment(__pyx_self, __pyx_v_f_old, __pyx_v_map1, __pyx_v_map2, __pyx_v_dim1, __pyx_v_dim2);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_5remap_assignment(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_f_old, PyArrayObject *__pyx_v_map1, PyArrayObject *__pyx_v_map2, int __pyx_v_dim1, int __pyx_v_dim2) {
  PyArrayObject *__pyx_v_f_new = 0;
  int __pyx_v_i;
  int __pyx_v_j;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f_new;
  __Pyx_Buffer __pyx_pybuffer_f_new;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f_old;
  __Pyx_Buffer __pyx_pybuffer_f_old;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_map1;
  __Pyx_Buffer __pyx_pybuffer_map1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_map2;
  __Pyx_Buffer __pyx_pybuffer_map2;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assignment", 0);
  __pyx_pybuffer_f_new.pybuffer.buf = NULL;
  __pyx_pybuffer_f_new.refcount = 0;
  __pyx_pybuffernd_f_new.data = NULL;
  __pyx_pybuffernd_f_new.rcbuffer = &amp;__pyx_pybuffer_f_new;
  __pyx_pybuffer_f_old.pybuffer.buf = NULL;
  __pyx_pybuffer_f_old.refcount = 0;
  __pyx_pybuffernd_f_old.data = NULL;
  __pyx_pybuffernd_f_old.rcbuffer = &amp;__pyx_pybuffer_f_old;
  __pyx_pybuffer_map1.pybuffer.buf = NULL;
  __pyx_pybuffer_map1.refcount = 0;
  __pyx_pybuffernd_map1.data = NULL;
  __pyx_pybuffernd_map1.rcbuffer = &amp;__pyx_pybuffer_map1;
  __pyx_pybuffer_map2.pybuffer.buf = NULL;
  __pyx_pybuffer_map2.refcount = 0;
  __pyx_pybuffernd_map2.data = NULL;
  __pyx_pybuffernd_map2.rcbuffer = &amp;__pyx_pybuffer_map2;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_f_old, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_f_old.diminfo[0].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f_old.diminfo[0].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f_old.diminfo[1].strides = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f_old.diminfo[1].shape = __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_map1, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_map1.diminfo[0].strides = __pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_map1.diminfo[0].shape = __pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_map1.diminfo[1].strides = __pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_map1.diminfo[1].shape = __pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_map2, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPEINT_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_map2.diminfo[0].strides = __pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_map2.diminfo[0].shape = __pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_map2.diminfo[1].strides = __pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_map2.diminfo[1].shape = __pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.assignment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_f_new);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_f_old, __pyx_n_s_map1, __pyx_n_s_map2, __pyx_n_s_dim1, __pyx_n_s_dim2, __pyx_n_s_f_new, __pyx_n_s_i, __pyx_n_s_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_5remap_1assignment, NULL, __pyx_n_s_DECSKS_lib_remap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_assignment, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__8 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__7, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_assignment, 12, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;013: </pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+014:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-45'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_5, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_f_new = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_f_new.diminfo[0].strides = __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f_new.diminfo[0].shape = __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f_new.diminfo[1].strides = __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f_new.diminfo[1].shape = __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_5 = 0;
  __pyx_v_f_new = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;015:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class='cython line score-0'>&#xA0;016:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">j</span></pre>
<pre class='cython line score-0'>&#xA0;017: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+018:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_dim1;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+019:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_dim2;
    for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_j = __pyx_t_9;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+020:             <span class="n">f_new</span><span class="p">[</span><span class="n">map1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span> <span class="n">map2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">f_old</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-8'>      __pyx_t_10 = __pyx_v_i;
      __pyx_t_11 = __pyx_v_j;
      __pyx_t_12 = -1;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_pybuffernd_f_old.diminfo[0].shape;
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_12 = 0;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_pybuffernd_f_old.diminfo[0].shape)) __pyx_t_12 = 0;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_pybuffernd_f_old.diminfo[1].shape;
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_12 = 1;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_pybuffernd_f_old.diminfo[1].shape)) __pyx_t_12 = 1;
      if (unlikely(__pyx_t_12 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_pybuffernd_map1.diminfo[0].shape;
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_pybuffernd_map1.diminfo[0].shape)) __pyx_t_14 = 0;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_pybuffernd_map1.diminfo[1].shape;
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_pybuffernd_map1.diminfo[1].shape)) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_14 = __pyx_v_i;
      __pyx_t_15 = __pyx_v_j;
      __pyx_t_16 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_pybuffernd_map2.diminfo[0].shape;
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_pybuffernd_map2.diminfo[0].shape)) __pyx_t_16 = 0;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_pybuffernd_map2.diminfo[1].shape;
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_pybuffernd_map2.diminfo[1].shape)) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_17 = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPEINT_t *, __pyx_pybuffernd_map1.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_map1.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_map1.diminfo[1].strides));
      __pyx_t_18 = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPEINT_t *, __pyx_pybuffernd_map2.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_map2.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_map2.diminfo[1].strides));
      __pyx_t_16 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_pybuffernd_f_new.diminfo[0].shape;
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_f_new.diminfo[0].shape)) __pyx_t_16 = 0;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_pybuffernd_f_new.diminfo[1].shape;
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_f_new.diminfo[1].shape)) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_f_new.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_f_new.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_f_new.diminfo[1].strides) += (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_f_old.rcbuffer-&gt;pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_f_old.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_f_old.diminfo[1].strides));
    }
  }
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+021:     <span class="k">return</span> <span class="n">f_new</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_f_new));
  __pyx_r = ((PyObject *)__pyx_v_f_new);
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;022: </pre>
<pre class='cython line score-42' onclick='toggleDiv(this)'>+023: <span class="k">def</span> <span class="nf">sift_flux</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf</span><span class="p">):</span></pre>
<pre class='cython code score-42'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_3sift_flux(PyObject *__pyx_self, PyObject *__pyx_v_Uf); /*proto*/
static char __pyx_doc_6DECSKS_3lib_5remap_2sift_flux[] = "\n    Examines a flux-like array Uf, and returns two arrays, Uf_nonneg\n    and Uf_neg. These two arrays which are identically sized with respect\n    to Uf and are so-named due to Uf_nonneg containing the entries of\n    Uf which are nonnegative, and Uf_neg cdontaining those which\n    are negative. Note that this method expects a flux-like object (Uf),\n    not a density-like object (f). Recall that,\n\n        Uf = CFL.frac * f + (Higher order corrections)\n\n    since f is strictly nonnegative everywhere in phase space, the\n    flux Uf already factors in CFL.frac as the zeroeth order term,\n    and the numerical limiter on the high order corrections ensure that Uf\n    shares the same sign as the zeroeth order term, hence Uf has the same\n    sign as CFL.frac.\n\n    This routine differs from remap.sift_old in three ways:\n\n        (1) it sifts a flux Uf, rather than a density f\n        (2) it checks the sign on the input paramter Uf, hence\n            checking the sign on CFL.frac is not needed as discussed\n            above.\n        (3) it checks the sign of every (i,j), not just the first row\n            entry in a column.\n\n    check on every (i,j), whereas remap.sift_old only checks the top\n    entry for each j (i.e. is used for situations where each column has\n    one CFL number per column j that corresponds to all i therein). Hence,\n    this routine (remap.sift) is general, whereas the other (remap.sift_old)\n    is only valid for some cases, but not all (so far, the only boundary\n    condition that precludes using remap.sift_old is the symmetry/reflecting\n    boundary condition)\n    ";
static PyMethodDef __pyx_mdef_6DECSKS_3lib_5remap_3sift_flux = {"sift_flux", (PyCFunction)__pyx_pw_6DECSKS_3lib_5remap_3sift_flux, METH_O, __pyx_doc_6DECSKS_3lib_5remap_2sift_flux};
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_3sift_flux(PyObject *__pyx_self, PyObject *__pyx_v_Uf) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift_flux (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Uf), __pyx_ptype_5numpy_ndarray, 1, "Uf", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_5remap_2sift_flux(__pyx_self, ((PyArrayObject *)__pyx_v_Uf));
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_5remap_2sift_flux(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_Uf) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_dim1;
  int __pyx_v_dim2;
  PyArrayObject *__pyx_v_Uf_nonneg = 0;
  PyArrayObject *__pyx_v_Uf_neg = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf;
  __Pyx_Buffer __pyx_pybuffer_Uf;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_neg;
  __Pyx_Buffer __pyx_pybuffer_Uf_neg;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Uf_nonneg;
  __Pyx_Buffer __pyx_pybuffer_Uf_nonneg;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift_flux", 0);
  __pyx_pybuffer_Uf_nonneg.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_nonneg.refcount = 0;
  __pyx_pybuffernd_Uf_nonneg.data = NULL;
  __pyx_pybuffernd_Uf_nonneg.rcbuffer = &amp;__pyx_pybuffer_Uf_nonneg;
  __pyx_pybuffer_Uf_neg.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf_neg.refcount = 0;
  __pyx_pybuffernd_Uf_neg.data = NULL;
  __pyx_pybuffernd_Uf_neg.rcbuffer = &amp;__pyx_pybuffer_Uf_neg;
  __pyx_pybuffer_Uf.pybuffer.buf = NULL;
  __pyx_pybuffer_Uf.refcount = 0;
  __pyx_pybuffernd_Uf.data = NULL;
  __pyx_pybuffernd_Uf.rcbuffer = &amp;__pyx_pybuffer_Uf;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Uf, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Uf.diminfo[0].strides = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf.diminfo[0].shape = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf.diminfo[1].strides = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf.diminfo[1].shape = __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.sift_flux", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Uf_nonneg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Uf_neg);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_Uf, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_dim1, __pyx_n_s_dim2, __pyx_n_s_Uf_nonneg, __pyx_n_s_Uf_neg);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_5remap_3sift_flux, NULL, __pyx_n_s_DECSKS_lib_remap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sift_flux, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__10 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__9, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_dsirajud_Work_IPython_note, __pyx_n_s_sift_flux, 23, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;024:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;025: <span class="sd">    Examines a flux-like array Uf, and returns two arrays, Uf_nonneg</span></pre>
<pre class='cython line score-0'>&#xA0;026: <span class="sd">    and Uf_neg. These two arrays which are identically sized with respect</span></pre>
<pre class='cython line score-0'>&#xA0;027: <span class="sd">    to Uf and are so-named due to Uf_nonneg containing the entries of</span></pre>
<pre class='cython line score-0'>&#xA0;028: <span class="sd">    Uf which are nonnegative, and Uf_neg cdontaining those which</span></pre>
<pre class='cython line score-0'>&#xA0;029: <span class="sd">    are negative. Note that this method expects a flux-like object (Uf),</span></pre>
<pre class='cython line score-0'>&#xA0;030: <span class="sd">    not a density-like object (f). Recall that,</span></pre>
<pre class='cython line score-0'>&#xA0;031: </pre>
<pre class='cython line score-0'>&#xA0;032: <span class="sd">        Uf = CFL.frac * f + (Higher order corrections)</span></pre>
<pre class='cython line score-0'>&#xA0;033: </pre>
<pre class='cython line score-0'>&#xA0;034: <span class="sd">    since f is strictly nonnegative everywhere in phase space, the</span></pre>
<pre class='cython line score-0'>&#xA0;035: <span class="sd">    flux Uf already factors in CFL.frac as the zeroeth order term,</span></pre>
<pre class='cython line score-0'>&#xA0;036: <span class="sd">    and the numerical limiter on the high order corrections ensure that Uf</span></pre>
<pre class='cython line score-0'>&#xA0;037: <span class="sd">    shares the same sign as the zeroeth order term, hence Uf has the same</span></pre>
<pre class='cython line score-0'>&#xA0;038: <span class="sd">    sign as CFL.frac.</span></pre>
<pre class='cython line score-0'>&#xA0;039: </pre>
<pre class='cython line score-0'>&#xA0;040: <span class="sd">    This routine differs from remap.sift_old in three ways:</span></pre>
<pre class='cython line score-0'>&#xA0;041: </pre>
<pre class='cython line score-0'>&#xA0;042: <span class="sd">        (1) it sifts a flux Uf, rather than a density f</span></pre>
<pre class='cython line score-0'>&#xA0;043: <span class="sd">        (2) it checks the sign on the input paramter Uf, hence</span></pre>
<pre class='cython line score-0'>&#xA0;044: <span class="sd">            checking the sign on CFL.frac is not needed as discussed</span></pre>
<pre class='cython line score-0'>&#xA0;045: <span class="sd">            above.</span></pre>
<pre class='cython line score-0'>&#xA0;046: <span class="sd">        (3) it checks the sign of every (i,j), not just the first row</span></pre>
<pre class='cython line score-0'>&#xA0;047: <span class="sd">            entry in a column.</span></pre>
<pre class='cython line score-0'>&#xA0;048: </pre>
<pre class='cython line score-0'>&#xA0;049: <span class="sd">    check on every (i,j), whereas remap.sift_old only checks the top</span></pre>
<pre class='cython line score-0'>&#xA0;050: <span class="sd">    entry for each j (i.e. is used for situations where each column has</span></pre>
<pre class='cython line score-0'>&#xA0;051: <span class="sd">    one CFL number per column j that corresponds to all i therein). Hence,</span></pre>
<pre class='cython line score-0'>&#xA0;052: <span class="sd">    this routine (remap.sift) is general, whereas the other (remap.sift_old)</span></pre>
<pre class='cython line score-0'>&#xA0;053: <span class="sd">    is only valid for some cases, but not all (so far, the only boundary</span></pre>
<pre class='cython line score-0'>&#xA0;054: <span class="sd">    condition that precludes using remap.sift_old is the symmetry/reflecting</span></pre>
<pre class='cython line score-0'>&#xA0;055: <span class="sd">    boundary condition)</span></pre>
<pre class='cython line score-0'>&#xA0;056: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;057:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+058:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim1</span> <span class="o">=</span> <span class="n">Uf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim1 = (__pyx_v_Uf-&gt;dimensions[0]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+059:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim2</span> <span class="o">=</span> <span class="n">Uf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim2 = (__pyx_v_Uf-&gt;dimensions[1]);
</pre><pre class='cython line score-0'>&#xA0;060: </pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+061:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_nonneg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Uf_nonneg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Uf_nonneg.diminfo[0].strides = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_nonneg.diminfo[1].strides = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape = __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_Uf_nonneg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-45' onclick='toggleDiv(this)'>+062:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">Uf_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Uf_neg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Uf_neg.diminfo[0].strides = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Uf_neg.diminfo[0].shape = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Uf_neg.diminfo[1].strides = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Uf_neg.diminfo[1].shape = __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_Uf_neg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;063: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+064:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_8 = __pyx_v_dim2;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_j = __pyx_t_9;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+065:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_dim1;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+066:             <span class="k">if</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-2'>      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_pybuffernd_Uf.diminfo[0].shape;
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_14 = 0;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_pybuffernd_Uf.diminfo[1].shape;
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_15 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Uf.diminfo[1].strides)) &gt;= 0.0) != 0);
      if (__pyx_t_15) {
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+067:                 <span class="n">Uf_nonneg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_14 = __pyx_v_i;
        __pyx_t_16 = __pyx_v_j;
        __pyx_t_17 = -1;
        if (__pyx_t_14 &lt; 0) {
          __pyx_t_14 += __pyx_pybuffernd_Uf.diminfo[0].shape;
          if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_17 = 0;
        } else if (unlikely(__pyx_t_14 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_17 = 0;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_pybuffernd_Uf.diminfo[1].shape;
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_17 = 1;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_17 = 1;
        if (unlikely(__pyx_t_17 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_17 = __pyx_v_i;
        __pyx_t_18 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape;
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_Uf_nonneg.diminfo[0].shape)) __pyx_t_19 = 0;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape;
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_Uf_nonneg.diminfo[1].shape)) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf_nonneg.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Uf_nonneg.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Uf_nonneg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Uf.diminfo[1].strides));
        goto __pyx_L7;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;068:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+069:                 <span class="n">Uf_neg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_19 = __pyx_v_i;
        __pyx_t_20 = __pyx_v_j;
        __pyx_t_21 = -1;
        if (__pyx_t_19 &lt; 0) {
          __pyx_t_19 += __pyx_pybuffernd_Uf.diminfo[0].shape;
          if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_21 = 0;
        } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_Uf.diminfo[0].shape)) __pyx_t_21 = 0;
        if (__pyx_t_20 &lt; 0) {
          __pyx_t_20 += __pyx_pybuffernd_Uf.diminfo[1].shape;
          if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_21 = 1;
        } else if (unlikely(__pyx_t_20 &gt;= __pyx_pybuffernd_Uf.diminfo[1].shape)) __pyx_t_21 = 1;
        if (unlikely(__pyx_t_21 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_23 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_pybuffernd_Uf_neg.diminfo[0].shape;
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_23 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_pybuffernd_Uf_neg.diminfo[0].shape)) __pyx_t_23 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_pybuffernd_Uf_neg.diminfo[1].shape;
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_23 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_pybuffernd_Uf_neg.diminfo[1].shape)) __pyx_t_23 = 1;
        if (unlikely(__pyx_t_23 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf_neg.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_Uf_neg.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_Uf_neg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_Uf.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Uf.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_Uf.diminfo[1].strides));
      }
      __pyx_L7:;
    }
  }
</pre><pre class='cython line score-0'>&#xA0;070: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+071:     <span class="k">return</span> <span class="n">Uf_nonneg</span><span class="p">,</span> <span class="n">Uf_neg</span></pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_nonneg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_nonneg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_Uf_nonneg));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Uf_neg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Uf_neg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_Uf_neg));
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;072: </pre>
<pre class='cython line score-78' onclick='toggleDiv(this)'>+073: <span class="k">def</span> <span class="nf">sift_old</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">CFL</span><span class="p">):</span></pre>
<pre class='cython code score-78'>/* Python wrapper */
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_5sift_old(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6DECSKS_3lib_5remap_4sift_old[] = "\n    Examines a density-like array f, and returns two arrays, f_nonneg\n    and f_neg. These two arrays which are identically sized with respect\n    to f and are so-named due to f_nonneg containing the entries of\n    f which correspond to CFL.numbers[i,j] with nonnegative sign, and f_neg\n    containing those which have negative sign.\n\n    inputs:\n\n    f -- (ndarray, ndim = 2) density-like or flux-like array\n    CFL -- (ndarray, ndim = 2) 2D array of CFL numbers, identical dimenions as f\n\n    outputs:\n\n    f_nonneg -- (ndarray, ndim = 2) density-like array with only those entries\n                from f[i,j] which are associated with sign(CFL.numbers[i,j]) &gt;= 0\n\n    f_neg -- (ndarray, ndim = 2) density-like array with only those entries\n                from f[i,j] which are associated with sign(CFL.numbers[i,j]) &lt; 0\n\n\n    NOTE:\n\n    This routine is of limited applicability. It presumes that the sign of\n    the normalized velocity (CFL number) only varies in the column direction,\n    i.e. that each row within a column is described by the same CFL number\n    which is the physical velocity normalized by the grid velocity:\n\n       CFL number = v / v_grid = v / (x.width / t.width) = v * t.width / x.width\n\n    This will be true for all cases EXCEPT a symmetric/reflection boundary condition\n    which reverses the direction of any such density packet which reaches the\n    so-described boundary in a time step. Since not all rows i in the\n    prepoint set {(i,j)} at a given j will reach the boundary (where\n    (i,j) refer to configuration and velocity prepoints, respectively), only\n    some rows i, in CFL[i,j] will have their direction reversed. Hence, such a\n    boundary condition breaks the constancy among rows for a given column.\n\n    This routine exploits the constancy of CFL sign among the rows for each column\n    to gain efficiency. We only check the sign of the first CFL value in the column\n    and presume all rows share the same si""gn as the first row. Again, this will\n    be true for all BCs except a symmetry/reflecting condition. If used, it reduces\n    the number of conditional checks on the sign of every (i,j) (requiring Nx*Nvx\n    checks) to conditional checks on the sign of one j for all such i (requires only\n    Nvx checks).\n\n    The above routine (remap.sift) checks every (i,j) and hence is general.\n    ";
static PyMethodDef __pyx_mdef_6DECSKS_3lib_5remap_5sift_old = {"sift_old", (PyCFunction)__pyx_pw_6DECSKS_3lib_5remap_5sift_old, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6DECSKS_3lib_5remap_4sift_old};
static PyObject *__pyx_pw_6DECSKS_3lib_5remap_5sift_old(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_f = 0;
  PyArrayObject *__pyx_v_CFL = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift_old (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_f,&amp;__pyx_n_s_CFL,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_CFL)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sift_old", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sift_old") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_f = ((PyArrayObject *)values[0]);
    __pyx_v_CFL = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sift_old", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.sift_old", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_f), __pyx_ptype_5numpy_ndarray, 1, "f", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_CFL), __pyx_ptype_5numpy_ndarray, 1, "CFL", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6DECSKS_3lib_5remap_4sift_old(__pyx_self, __pyx_v_f, __pyx_v_CFL);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6DECSKS_3lib_5remap_4sift_old(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_f, PyArrayObject *__pyx_v_CFL) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_dim1;
  int __pyx_v_dim2;
  PyArrayObject *__pyx_v_f_nonneg = 0;
  PyArrayObject *__pyx_v_f_neg = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_CFL;
  __Pyx_Buffer __pyx_pybuffer_CFL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f;
  __Pyx_Buffer __pyx_pybuffer_f;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f_neg;
  __Pyx_Buffer __pyx_pybuffer_f_neg;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_f_nonneg;
  __Pyx_Buffer __pyx_pybuffer_f_nonneg;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sift_old", 0);
  __pyx_pybuffer_f_nonneg.pybuffer.buf = NULL;
  __pyx_pybuffer_f_nonneg.refcount = 0;
  __pyx_pybuffernd_f_nonneg.data = NULL;
  __pyx_pybuffernd_f_nonneg.rcbuffer = &amp;__pyx_pybuffer_f_nonneg;
  __pyx_pybuffer_f_neg.pybuffer.buf = NULL;
  __pyx_pybuffer_f_neg.refcount = 0;
  __pyx_pybuffernd_f_neg.data = NULL;
  __pyx_pybuffernd_f_neg.rcbuffer = &amp;__pyx_pybuffer_f_neg;
  __pyx_pybuffer_f.pybuffer.buf = NULL;
  __pyx_pybuffer_f.refcount = 0;
  __pyx_pybuffernd_f.data = NULL;
  __pyx_pybuffernd_f.rcbuffer = &amp;__pyx_pybuffer_f;
  __pyx_pybuffer_CFL.pybuffer.buf = NULL;
  __pyx_pybuffer_CFL.refcount = 0;
  __pyx_pybuffernd_CFL.data = NULL;
  __pyx_pybuffernd_CFL.rcbuffer = &amp;__pyx_pybuffer_CFL;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_f, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_f.diminfo[0].strides = __pyx_pybuffernd_f.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f.diminfo[0].shape = __pyx_pybuffernd_f.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f.diminfo[1].strides = __pyx_pybuffernd_f.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f.diminfo[1].shape = __pyx_pybuffernd_f.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_CFL, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_CFL.diminfo[0].strides = __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_CFL.diminfo[0].shape = __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_CFL.diminfo[1].strides = __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_CFL.diminfo[1].shape = __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_neg.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_nonneg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("DECSKS.lib.remap.sift_old", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_neg.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_f_nonneg.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_f_nonneg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_f_neg);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_f, __pyx_n_s_CFL, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_dim1, __pyx_n_s_dim2, __pyx_n_s_f_nonneg, __pyx_n_s_f_neg);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6DECSKS_3lib_5remap_5sift_old, NULL, __pyx_n_s_DECSKS_lib_remap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sift_old, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;074:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;075: <span class="sd">    Examines a density-like array f, and returns two arrays, f_nonneg</span></pre>
<pre class='cython line score-0'>&#xA0;076: <span class="sd">    and f_neg. These two arrays which are identically sized with respect</span></pre>
<pre class='cython line score-0'>&#xA0;077: <span class="sd">    to f and are so-named due to f_nonneg containing the entries of</span></pre>
<pre class='cython line score-0'>&#xA0;078: <span class="sd">    f which correspond to CFL.numbers[i,j] with nonnegative sign, and f_neg</span></pre>
<pre class='cython line score-0'>&#xA0;079: <span class="sd">    containing those which have negative sign.</span></pre>
<pre class='cython line score-0'>&#xA0;080: </pre>
<pre class='cython line score-0'>&#xA0;081: <span class="sd">    inputs:</span></pre>
<pre class='cython line score-0'>&#xA0;082: </pre>
<pre class='cython line score-0'>&#xA0;083: <span class="sd">    f -- (ndarray, ndim = 2) density-like or flux-like array</span></pre>
<pre class='cython line score-0'>&#xA0;084: <span class="sd">    CFL -- (ndarray, ndim = 2) 2D array of CFL numbers, identical dimenions as f</span></pre>
<pre class='cython line score-0'>&#xA0;085: </pre>
<pre class='cython line score-0'>&#xA0;086: <span class="sd">    outputs:</span></pre>
<pre class='cython line score-0'>&#xA0;087: </pre>
<pre class='cython line score-0'>&#xA0;088: <span class="sd">    f_nonneg -- (ndarray, ndim = 2) density-like array with only those entries</span></pre>
<pre class='cython line score-0'>&#xA0;089: <span class="sd">                from f[i,j] which are associated with sign(CFL.numbers[i,j]) &gt;= 0</span></pre>
<pre class='cython line score-0'>&#xA0;090: </pre>
<pre class='cython line score-0'>&#xA0;091: <span class="sd">    f_neg -- (ndarray, ndim = 2) density-like array with only those entries</span></pre>
<pre class='cython line score-0'>&#xA0;092: <span class="sd">                from f[i,j] which are associated with sign(CFL.numbers[i,j]) &lt; 0</span></pre>
<pre class='cython line score-0'>&#xA0;093: </pre>
<pre class='cython line score-0'>&#xA0;094: </pre>
<pre class='cython line score-0'>&#xA0;095: <span class="sd">    NOTE:</span></pre>
<pre class='cython line score-0'>&#xA0;096: </pre>
<pre class='cython line score-0'>&#xA0;097: <span class="sd">    This routine is of limited applicability. It presumes that the sign of</span></pre>
<pre class='cython line score-0'>&#xA0;098: <span class="sd">    the normalized velocity (CFL number) only varies in the column direction,</span></pre>
<pre class='cython line score-0'>&#xA0;099: <span class="sd">    i.e. that each row within a column is described by the same CFL number</span></pre>
<pre class='cython line score-0'>&#xA0;100: <span class="sd">    which is the physical velocity normalized by the grid velocity:</span></pre>
<pre class='cython line score-0'>&#xA0;101: </pre>
<pre class='cython line score-0'>&#xA0;102: <span class="sd">       CFL number = v / v_grid = v / (x.width / t.width) = v * t.width / x.width</span></pre>
<pre class='cython line score-0'>&#xA0;103: </pre>
<pre class='cython line score-0'>&#xA0;104: <span class="sd">    This will be true for all cases EXCEPT a symmetric/reflection boundary condition</span></pre>
<pre class='cython line score-0'>&#xA0;105: <span class="sd">    which reverses the direction of any such density packet which reaches the</span></pre>
<pre class='cython line score-0'>&#xA0;106: <span class="sd">    so-described boundary in a time step. Since not all rows i in the</span></pre>
<pre class='cython line score-0'>&#xA0;107: <span class="sd">    prepoint set {(i,j)} at a given j will reach the boundary (where</span></pre>
<pre class='cython line score-0'>&#xA0;108: <span class="sd">    (i,j) refer to configuration and velocity prepoints, respectively), only</span></pre>
<pre class='cython line score-0'>&#xA0;109: <span class="sd">    some rows i, in CFL[i,j] will have their direction reversed. Hence, such a</span></pre>
<pre class='cython line score-0'>&#xA0;110: <span class="sd">    boundary condition breaks the constancy among rows for a given column.</span></pre>
<pre class='cython line score-0'>&#xA0;111: </pre>
<pre class='cython line score-0'>&#xA0;112: <span class="sd">    This routine exploits the constancy of CFL sign among the rows for each column</span></pre>
<pre class='cython line score-0'>&#xA0;113: <span class="sd">    to gain efficiency. We only check the sign of the first CFL value in the column</span></pre>
<pre class='cython line score-0'>&#xA0;114: <span class="sd">    and presume all rows share the same sign as the first row. Again, this will</span></pre>
<pre class='cython line score-0'>&#xA0;115: <span class="sd">    be true for all BCs except a symmetry/reflecting condition. If used, it reduces</span></pre>
<pre class='cython line score-0'>&#xA0;116: <span class="sd">    the number of conditional checks on the sign of every (i,j) (requiring Nx*Nvx</span></pre>
<pre class='cython line score-0'>&#xA0;117: <span class="sd">    checks) to conditional checks on the sign of one j for all such i (requires only</span></pre>
<pre class='cython line score-0'>&#xA0;118: <span class="sd">    Nvx checks).</span></pre>
<pre class='cython line score-0'>&#xA0;119: </pre>
<pre class='cython line score-0'>&#xA0;120: <span class="sd">    The above routine (remap.sift) checks every (i,j) and hence is general.</span></pre>
<pre class='cython line score-0'>&#xA0;121: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;122:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+123:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim1 = (__pyx_v_f-&gt;dimensions[0]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+124:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dim2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_dim2 = (__pyx_v_f-&gt;dimensions[1]);
</pre><pre class='cython line score-0'>&#xA0;125: </pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+126:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f_nonneg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f_nonneg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_f_nonneg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_f_nonneg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_f_nonneg.diminfo[0].strides = __pyx_pybuffernd_f_nonneg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f_nonneg.diminfo[0].shape = __pyx_pybuffernd_f_nonneg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f_nonneg.diminfo[1].strides = __pyx_pybuffernd_f_nonneg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f_nonneg.diminfo[1].shape = __pyx_pybuffernd_f_nonneg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_f_nonneg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-45' onclick='toggleDiv(this)'>+127:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">DTYPE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">f_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span></pre>
<pre class='cython code score-45'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_dim2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_f_neg.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_6DECSKS_3lib_5remap_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_f_neg = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_f_neg.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_f_neg.diminfo[0].strides = __pyx_pybuffernd_f_neg.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_f_neg.diminfo[0].shape = __pyx_pybuffernd_f_neg.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_f_neg.diminfo[1].strides = __pyx_pybuffernd_f_neg.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_f_neg.diminfo[1].shape = __pyx_pybuffernd_f_neg.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_f_neg = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;128: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+129:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_8 = __pyx_v_dim2;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_j = __pyx_t_9;
</pre><pre class='cython line score-0'>&#xA0;130:         <span class="c"># CFL[0,j] = CFL[1,j] = ... = const, we choose to examine (0,j) arbitrarily</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+131:         <span class="k">if</span> <span class="n">CFL</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-2'>    __pyx_t_10 = 0;
    __pyx_t_11 = __pyx_v_j;
    __pyx_t_12 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_pybuffernd_CFL.diminfo[0].shape;
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_pybuffernd_CFL.diminfo[0].shape)) __pyx_t_12 = 0;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_pybuffernd_CFL.diminfo[1].shape;
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_pybuffernd_CFL.diminfo[1].shape)) __pyx_t_12 = 1;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_13 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_CFL.rcbuffer-&gt;pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_CFL.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_CFL.diminfo[1].strides)) &gt;= 0.0) != 0);
    if (__pyx_t_13) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+132:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = __pyx_v_dim1;
      for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_12; __pyx_t_14+=1) {
        __pyx_v_i = __pyx_t_14;
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+133:                 <span class="n">f_nonneg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_15 = __pyx_v_i;
        __pyx_t_16 = __pyx_v_j;
        __pyx_t_17 = -1;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_pybuffernd_f.diminfo[0].shape;
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_17 = 0;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_pybuffernd_f.diminfo[0].shape)) __pyx_t_17 = 0;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_pybuffernd_f.diminfo[1].shape;
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_17 = 1;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_pybuffernd_f.diminfo[1].shape)) __pyx_t_17 = 1;
        if (unlikely(__pyx_t_17 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_17 = __pyx_v_i;
        __pyx_t_18 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_pybuffernd_f_nonneg.diminfo[0].shape;
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_f_nonneg.diminfo[0].shape)) __pyx_t_19 = 0;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_pybuffernd_f_nonneg.diminfo[1].shape;
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_f_nonneg.diminfo[1].shape)) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_f_nonneg.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_f_nonneg.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_f_nonneg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_f.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_f.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_f.diminfo[1].strides));
      }
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;134:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+135:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = __pyx_v_dim1;
      for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_12; __pyx_t_14+=1) {
        __pyx_v_i = __pyx_t_14;
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+136:                 <span class="n">f_neg</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4'>        __pyx_t_19 = __pyx_v_i;
        __pyx_t_20 = __pyx_v_j;
        __pyx_t_21 = -1;
        if (__pyx_t_19 &lt; 0) {
          __pyx_t_19 += __pyx_pybuffernd_f.diminfo[0].shape;
          if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_21 = 0;
        } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_f.diminfo[0].shape)) __pyx_t_21 = 0;
        if (__pyx_t_20 &lt; 0) {
          __pyx_t_20 += __pyx_pybuffernd_f.diminfo[1].shape;
          if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_21 = 1;
        } else if (unlikely(__pyx_t_20 &gt;= __pyx_pybuffernd_f.diminfo[1].shape)) __pyx_t_21 = 1;
        if (unlikely(__pyx_t_21 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_23 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_pybuffernd_f_neg.diminfo[0].shape;
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_23 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_pybuffernd_f_neg.diminfo[0].shape)) __pyx_t_23 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_pybuffernd_f_neg.diminfo[1].shape;
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_23 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_pybuffernd_f_neg.diminfo[1].shape)) __pyx_t_23 = 1;
        if (unlikely(__pyx_t_23 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_f_neg.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_f_neg.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_f_neg.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6DECSKS_3lib_5remap_DTYPE_t *, __pyx_pybuffernd_f.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_f.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_f.diminfo[1].strides));
      }
    }
    __pyx_L5:;
  }
</pre><pre class='cython line score-0'>&#xA0;137: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+138:     <span class="k">return</span> <span class="n">f_nonneg</span><span class="p">,</span> <span class="n">f_neg</span></pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_f_nonneg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_f_nonneg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_f_nonneg));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_f_neg));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_f_neg));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_f_neg));
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre></div></body></html>
